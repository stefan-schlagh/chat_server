(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{106:function(e,t,a){e.exports=a.p+"static/media/placeholder.99b71231.png"},111:function(e,t,a){e.exports=a(215)},135:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){},167:function(e,t){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},175:function(e,t,a){},176:function(e,t,a){},177:function(e,t,a){},179:function(e,t,a){},205:function(e,t,a){},206:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),c=a.n(s),i=a(1),o=a.n(i),u=a(9),l=a(13),h=a(5),d=a.n(h),p=a(8),m=a(33),f=a(3),g=a(4),v=a(6),b=a(7),y=a(51),E=a.n(y),k=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("small",{className:"alert alert-danger p-1 message d-block"},this.props.children)}}]),a}(n.Component),C=a(24),w=a.n(C);function j(){w.a.fn.extend({pwToggle:function(){this.prepend(w()("<i>").addClass("fas fa-eye-slash psw-toggle-icon").css({position:"absolute",right:"20px",top:"11px",color:"#666",cursor:"pointer",width:"16px",height:"16px"}).hover((function(){w()(this).css("color","#666")}),(function(){w()(this).css("color","#000")}))),this.css({position:"relative"});var e=this.get(0).children[0],t=this.get(0).children[1];e.addEventListener("click",(function(){"password"===t.type?(e.classList.remove("fa-eye-slash"),e.classList.add("fa-eye"),t.type="text"):(e.classList.remove("fa-eye"),e.classList.add("fa-eye-slash"),t.type="password")}))}})}var O=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(m.a)({},t,a))},n.submitHandler=function(e){e.preventDefault();var t,a,r={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},s=E()({username:n.state.username,password:n.state.password},r);"undefined"!=typeof s?(t="undefined"!=typeof s.username?s.username[0]:"",a="undefined"!=typeof s.password?s.password[0]:"",n.setState({valid:!1,uNameErr:t,pwErr:a})):(n.setState({valid:!0,uNameErr:"",pwErr:""}),n.login(n.state.username,n.state.password).then((function(e){e.success||(void 0!==e.username&&n.setState({valid:!1,uNameErr:e.username}),void 0!==e.password&&n.setState({valid:!1,pwErr:e.password}))})))},n.uNameErr=function(){if(""!==n.state.uNameErr)return o.a.createElement(k,null,n.state.uNameErr)},n.pwErr=function(){if(""!==n.state.pwErr)return o.a.createElement(k,null,n.state.pwErr)},n.login=function(){var e=Object(p.a)(d.a.mark((function e(t,a){var r,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})},e.next=4,fetch("/auth/login",r);case 4:if(!(s=e.sent).ok){e.next=13;break}return e.next=8,s.json();case 8:return(c=e.sent).success&&(n.dispatch.setUserSelf(c.uid,t),n.dispatch.setAuthTokens(c.tokens),n.props.history.push("/chat")),e.abrupt("return",c);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),n.state={uNameErr:"",username:"",pwErr:"",password:"",valid:!1,redirect:!1},j(),n}return Object(g.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"h-100",style:{display:"flex"}},o.a.createElement("div",{className:"col-sm-12 my-auto"},o.a.createElement("div",{className:"container border rounded p-3",style:{maxWidth:"800px"}},o.a.createElement("h1",null,"Login"),o.a.createElement("form",{onSubmit:this.submitHandler},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"username"},"Benutzername:"),this.uNameErr(),o.a.createElement("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort:"),this.pwErr(),o.a.createElement("div",{id:"psw-group"},o.a.createElement("input",{type:"password",name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler}))),o.a.createElement("div",{className:"form-group"},"haben Sie noch keinen Account? ",o.a.createElement(u.b,{to:"/register"},"Jetzt registrieren")),o.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Login"})))))}},{key:"componentDidMount",value:function(){w()("#psw-group").pwToggle()}}]),a}(i.Component),N=Object(l.j)(O),S=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(m.a)({},t,a))},n.submitHandler=function(e){e.preventDefault();var t,a,r,s={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}},passwordRepeat:{presence:!0,equality:"password",length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},c=E()({username:n.state.username,password:n.state.password,passwordRepeat:n.state.pwRepeat},s);"undefined"!=typeof c?(t="undefined"!=typeof c.username?c.username[0]:"",a="undefined"!=typeof c.password?c.password[0]:"",r="undefined"!=typeof c.passwordRepeat?c.passwordRepeat[0]:"",n.setState({valid:!1,uNameErr:t,pwErr:a,pwRepeatErr:r})):(n.setState({valid:!0,uNameErr:"",pwErr:"",pwRepeatErr:""}),n.register(n.state.username,n.state.password).then((function(e){e.success||void 0!==e.username&&n.setState({valid:!1,uNameErr:e.username})})))},n.uNameErr=function(){if(""!==n.state.uNameErr)return o.a.createElement(k,null,n.state.uNameErr)},n.pwErr=function(){if(""!==n.state.pwErr)return o.a.createElement(k,null,n.state.pwErr)},n.pwRepeatErr=function(){if(""!==n.state.pwRepeatErr)return o.a.createElement(k,null,n.state.pwRepeatErr)},n.register=function(){var e=Object(p.a)(d.a.mark((function e(t,a){var r,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})},e.next=4,fetch("/auth/register",r);case 4:if(!(s=e.sent).ok){e.next=13;break}return e.next=8,s.json();case 8:return(c=e.sent).success&&(n.dispatch.setUserSelf(c.uid,t),n.dispatch.setAuthTokens(c.tokens),n.props.history.push("/chat")),e.abrupt("return",c);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),n.state={uNameErr:"",username:"",pwErr:"",password:"",pwRepeatErr:"",pwRepeat:"",valid:!1,redirect:!1},j(),n}return Object(g.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"h-100",style:{display:"flex"}},o.a.createElement("div",{className:"col-sm-12 my-auto"},o.a.createElement("div",{className:"container border rounded p-3",style:{maxWidth:"800px"}},o.a.createElement("h1",null,"Registrieren"),o.a.createElement("form",{onSubmit:this.submitHandler},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"username"},"Benutzername:"),this.uNameErr(),o.a.createElement("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort:"),this.pwErr(),o.a.createElement("div",{id:"psw-group"},o.a.createElement("input",{type:"password",name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler}))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort wiederholen:"),this.pwRepeatErr(),o.a.createElement("div",{id:"psw-group-repeat"},o.a.createElement("input",{type:"password",name:"pwRepeat",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler}))),o.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Registrieren"})))))}},{key:"componentDidMount",value:function(){w()("#psw-group-repeat, #psw-group").pwToggle()}}]),a}(i.Component),T=Object(l.j)(S),x=a(54),M=a(110);var U=function(e){var t=e.component,a=Object(M.a)(e,["component"]),n=Object(i.useGlobal)(),s=Object(x.a)(n,2),c=s[0];return s[1],r.a.createElement(l.b,Object.assign({},a,{render:function(e){return c.loaded?c.authTokens?r.a.createElement(t,e):r.a.createElement(l.a,{to:{pathname:"/login",state:{referer:e.location}}}):null}}))},D=992,_=768,I=991,A=767,R=320,L=425,G=function(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},B=G(),P={width:B.width,height:B.height},F=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state=P,e.render=function(){var t=e.props,a=t.children,n=t.displayIn,s=e.state,c=s.width,i=s.height,o=e.shouldRender(n,c,i);return r.a.createElement(r.a.Fragment,null,o?a:null)},e.handleResize=function(){var t=G(),a=t.width,n=t.height;e.setState({width:a,height:n})},e.shouldRender=function(e,t,a){return-1!==e.indexOf("Laptop")&&t>=D||(-1!==e.indexOf("Tablet")&&t<=I&&t>=_||(-1!==e.indexOf("Mobile")&&t<=A||(-1!==e.indexOf("MobilePortrait")&&t<=A&&a>=L||!!(-1!==e.indexOf("MobileLandScape")&&t<=A&&a<=R))))},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize,!1)}}]),a}(r.a.PureComponent),z=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){"function"===typeof this.props.didMount&&this.props.didMount()}},{key:"componentDidUpdate",value:function(e,t,a){"function"===typeof this.props.didUpdate&&this.props.didUpdate()}},{key:"render",value:function(){return this.props.children?this.props.children:null}}]),a}(n.Component),H=(a(135),0),V=1,W=2,J=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){var e=this,t=this.props.location.pathname;return o.a.createElement(z,null,o.a.createElement(F,{displayIn:["Mobile"]},o.a.createElement("div",{className:"float-left left"},o.a.createElement("i",{id:"btnBackToChatList",className:"fas fa-arrow-left fa-2x d-block d-md-none",onClick:function(){e.props.history.goBack()}}),e.global.newMessages>0?o.a.createElement("div",{className:"btnBack-number"},e.global.newMessages):null)),function(){switch(e.global.infoHeaderCenter){case V:return o.a.createElement(q,null,o.a.createElement("h3",{id:"chat-info-name"},e.global.ihcData.name),o.a.createElement(u.b,{to:t+"/userInfo/"+e.global.ihcData.uid},o.a.createElement("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})));case W:return o.a.createElement(q,null,o.a.createElement("h3",{id:"chat-info-name"},e.global.ihcData.name),o.a.createElement(u.b,{to:"/chat/groupInfo/"+e.global.ihcData.gcid},o.a.createElement("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})));default:return o.a.createElement(F,{displayIn:["Laptop","Tablet"]},o.a.createElement("h3",{className:"pt-2 pl-2"},"chat"))}}())}}]),a}(i.Component),Y=Object(l.j)(J);function q(e){return o.a.createElement("div",{id:"chat-info",className:"center pt-2"},e.children)}a(136);var $=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).clickCheckBox=function(e){n.state.checkBoxClicked?e.stopPropagation():setTimeout((function(){n.setState((function(e){return{checkBoxClicked:!0}}))}),20)},n.clickDocument=function(e){n.state.checkBoxClicked&&n.changeChecked(e)},n.changeChecked=function(e){n.setState((function(e){return{checkBoxClicked:!e.checkBoxClicked}}))},n.logout=function(){n.dispatch.deleteAuthTokens()},n.state={checkBoxClicked:!1},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return o.a.createElement("div",{className:"c-header"},o.a.createElement(Y,null),o.a.createElement("div",{id:"top-right",className:"right",onClick:this.clickCheckBox},o.a.createElement("div",{className:"right-l"}),o.a.createElement("input",{type:"checkbox",id:"btnControlTopRight",className:"btnControl",checked:this.state.checkBoxClicked,onChange:this.changeChecked}),o.a.createElement("label",{htmlFor:"btnControlTopRight"},o.a.createElement("div",{className:"right-c"},o.a.createElement("div",{className:"d-only-when-small"},o.a.createElement("i",{id:"user-info",className:"fas fa-user fa-2x user-icon","data-toggle":"tooltip",title:"Benutzer-Info"})),o.a.createElement("div",{className:"d-only-when-big top-2right"},o.a.createElement(u.b,{to:e+"/userInfo/"+this.global.userSelf.uid},o.a.createElement("h4",{id:"username",className:"p-2 username","data-toggle":"tooltip",title:"Benutzer-Info"},this.global.userSelf.username)),o.a.createElement("div",{className:"float-right"},o.a.createElement(u.b,{to:e+"/settings"},o.a.createElement("i",{className:"fas fa-user-cog fa-2x","data-toggle":"tooltip",title:"Einstellungen"})),"\xa0",o.a.createElement("i",{id:"user-logout",className:"fas fa-sign-out-alt fa-2x logout","data-toggle":"tooltip",title:"logout",onClick:this.logout})))))))}},{key:"componentDidMount",value:function(){w()('[data-toggle="tooltip"]').tooltip(),document.addEventListener("click",this.clickDocument,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.clickDocument,!1)}}]),a}(i.Component),K=Object(l.j)($),Q=(a(137),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).searchChanged=function(t){e.props.onSearch(t.target.value)},e}return Object(g.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return r.a.createElement("div",{className:"chatSearchBox"},r.a.createElement("div",{className:"chat-select-form"},r.a.createElement("input",{type:"text",name:"chat-search",className:"chat-search",placeholder:"Chat suchen",onChange:this.searchChanged}),r.a.createElement(u.b,{to:e+"/newChat"},r.a.createElement("button",{id:"btn-newChat",className:"btn-newChat"},r.a.createElement("i",{className:"fas fa-plus fa-lg"})))))}}]),a}(n.Component)),X=Object(l.j)(Q),Z=a(100),ee=a.n(Z),te={names:{aqua:"#00ffff",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0"},random:function(){var e,t=0;for(var a in this.names)Math.random()<1/++t&&(e=a);return e}},ae=te,ne=a(109),re=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"getIndex",value:function(e){for(var t=0,a=this.length-1;t<=a;){var n=Math.floor((t+a)/2);if(this[n].key===e)return n;this[n].key<e?t=n+1:a=n-1}return-1}},{key:"getNearestKey",value:function(e){var t;for(++e;-1===(t=this.getIndex(--e));)if(0===e)return-1;return t}},{key:"get",value:function(e){var t=this.getIndex(e);if(-1!==t)return this[t].value}},{key:"add",value:function(e,t){-1===this.getIndex(e)&&this.splice(this.getNearestKey(e)+1,0,{key:e,value:t})}},{key:"remove",value:function(e){var t=this.getIndex(e);-1!==t&&this.splice(t,1)}}]),a}(Object(ne.a)(Array)),se=a(23);function ce(e,t,a){return ie.apply(this,arguments)}function ie(){return(ie=Object(p.a)(d.a.mark((function e(t,a,n){var r,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||Object(i.getGlobal)().authTokens,s=Object(se.a)(Object(se.a)({},a),{},{method:a.method,headers:Object(se.a)(Object(se.a)({},a.headers),{},{Authorization:r})}),e.next=4,fetch(t,s);case 4:if(401!==(c=e.sent).status){e.next=8;break}throw Object(i.getDispatch)().deleteAuthTokens(),new Error("jwt expired");case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=0,ue=1,le=2,he=3,de=4,pe=5,me=6;function fe(){return(fe=Object(p.a)(d.a.mark((function e(t){var a,n,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===Le.users.getIndex(t)){e.next=10;break}if(0===Le.users.get(t).normalChat){e.next=5;break}return e.abrupt("return",oe);case 5:return a=Le.users.get(t),Le.temporaryChat.createNew(t,a.username),e.abrupt("return",le);case 8:e.next=41;break;case 10:if(!Le.temporaryChat.doesExist(t)){e.next=14;break}return e.abrupt("return",le);case 14:return e.prev=14,n={method:"GET",headers:{Accept:"application/json"}},e.next=18,ce("/user/"+t,n);case 18:if(!(r=e.sent).ok){e.next=35;break}return e.next=22,r.json();case 22:if(!(s=e.sent).userExists||s.blocked){e.next=28;break}return Le.temporaryChat.createNew(t,s.username),e.abrupt("return",le);case 28:if(s.userExists){e.next=32;break}return e.abrupt("return",he);case 32:return e.abrupt("return",de);case 33:e.next=36;break;case 35:return e.abrupt("return",me);case 36:e.next=41;break;case 38:return e.prev=38,e.t0=e.catch(14),e.abrupt("return",me);case 41:case"end":return e.stop()}}),e,null,[[14,38]])})))).apply(this,arguments)}var ge=function(){function e(t,a){Object(f.a)(this,e),this._normalChat=0,this._groupChats=new re,this.uid=t,this.username=a,this.color=ae.random()}return Object(g.a)(e,[{key:"addGroupChat",value:function(e){this.groupChats.add(e,e)}},{key:"removeGroupChat",value:function(e){this.groupChats.remove(e)}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"normalChat",get:function(){return this._normalChat},set:function(e){this._normalChat=e}},{key:"groupChats",get:function(){return this._groupChats},set:function(e){this._groupChats=e}}]),e}(),ve={};function be(){return ye.apply(this,arguments)}function ye(){return(ye=Object(p.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/data.json",t);case 3:if(!(a=e.sent).ok){e.next=10;break}return e.next=7,a.json();case 7:ve=e.sent,e.next=11;break;case 10:throw new Error;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e){var t=e.msg;return r.a.createElement("div",{className:(t.bySelf?"self ":"other ")+"msg-container"},t.userTop?r.a.createElement("div",{className:"w-100"},r.a.createElement("strong",{className:"header"},r.a.createElement(je,{user:t.userTop}))):null,r.a.createElement("div",{className:"content"},r.a.createElement("p",null,t.content.text)),r.a.createElement("div",{className:"date-outer"},r.a.createElement("div",{className:"date"},t.mDateString)))}function ke(e){var t=e.msg;return r.a.createElement("div",{className:(t.bySelf?"self ":"other ")+"msg-container"},r.a.createElement(Ce,{msg:t}),r.a.createElement("div",{className:"date-outer"},r.a.createElement("div",{className:"date"},t.mDateString)))}function Ce(e){var t=e.msg;return r.a.createElement(z,null,Te(t,!0))}a(170);function we(e){var t=e.msg;switch(t.type){case ve.messageTypes.normalMessage:return r.a.createElement(Ee,{msg:t});case ve.messageTypes.statusMessage:return r.a.createElement(ke,{msg:t});default:return r.a.createElement("span",null)}}function je(e){return r.a.createElement("span",{style:{color:ae.names[e.user.color]}},e.user.username)}var Oe=0,Ne=1,Se=["den chat erstellt","hinzugef\xfcgt","entfernt","dem chat beigetreten","den chat verlassen","zum Admin gemacht","nicht mehr Admin"];function Te(e,t){return function(){var t=e.userTop,n=e.content.passiveUsers;switch(e.content.type){case ve.statusMessageTypes.chatCreated:return a(t,Oe,n,ve.statusMessageTypes.chatCreated);case ve.statusMessageTypes.usersAdded:return a(t,Oe,n,ve.statusMessageTypes.usersAdded);case ve.statusMessageTypes.usersRemoved:return a(t,Oe,n,ve.statusMessageTypes.usersRemoved);case ve.statusMessageTypes.usersJoined:return a(t,Ne,[],ve.statusMessageTypes.usersJoined);case ve.statusMessageTypes.usersLeft:return a(t,Oe,[],ve.statusMessageTypes.usersLeft);case ve.statusMessageTypes.usersMadeAdmin:return a(t,Oe,n,ve.statusMessageTypes.usersMadeAdmin);case ve.statusMessageTypes.usersRemovedAdmin:return a(t,Ne,[],ve.statusMessageTypes.usersRemovedAdmin)}}();function a(a,n,s,c){function i(){switch(n){case Oe:return e.bySelf?" hast ":" hat ";case Ne:return" ist"}}function o(){if(s.length<1)return"";if(1===s.length){var e=Le.users.get(s[0]);return e?t?r.a.createElement(je,{user:e}):e.username:"1 Benutzer"}return s.length+" Benutzer"}function u(){return" "+Se[c]}return t?r.a.createElement("span",null,r.a.createElement(je,{user:e.userTop}),i(),o(),u()):e.userTop.username+i()+o()+u()}}var xe=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date(Date.now()),s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;Object(f.a)(this,e),this.mid=t,this.uid=a,this.date=r,this.chat=n,this.type=s,this.content=c}return Object(g.a)(e,[{key:"getMessageObject",value:function(e){var t={mDateString:this.getMessageViewDateString(),dateString:this.getDateString(),date:this.date,bySelf:this.uid===Le.userSelf.uid,type:this.type,content:this.content};return e&&(t.userTop=this.getUserTop()),t}},{key:"getUserTop",value:function(){if(this.isBySelf())return{uid:this.uid,username:"Du",color:Le.userSelf.color};var e=Le.users.get(this.uid);return{uid:this.uid,username:e.username,color:e.color}}},{key:"isBySelf",value:function(){return this.uid===Le.userSelf.uid}},{key:"getChatViewDateString",value:function(){return this.isDateToday()?"heute "+this.getTimeString():this.isDateYesterday()?"gestern":this.getDateString()}},{key:"getChatViewMsgString",value:function(){switch(this.type){case ve.messageTypes.normalMessage:var e=this.content.text;return e.length>18&&(e=e.substr(0,18)+"..."),this.uid===Le.userSelf.uid?"Du: ".concat(e):"normalchat"===this.chat.type?this.content.text:"".concat(Le.users.get(this.uid).username,": ").concat(e);case ve.messageTypes.statusMessage:return Te(this.getMessageObject(!0),!1)}}},{key:"getMessageViewDateString",value:function(){return this.isDateToday()?this.getTimeString():this.isDateYesterday()?"gestern "+this.getTimeString():this.getDateString()+" "+this.getTimeString()}},{key:"isDateToday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"isDateYesterday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()-1&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"getDateString",value:function(){var e,t=this.date.getDate();e=t<10?"0"+t:t;var a,n=this.date.getMonth();a=n+1<10?"0"+(n+1):n+1;var r=this.date.getFullYear();return"".concat(e,".").concat(a,".").concat(r)}},{key:"getTimeString",value:function(){var e,t=this.date.getHours();e=t<10?"0"+t:t;var a,n=this.date.getMinutes();return a=n<10?"0"+n:n,"".concat(e,":").concat(a)}},{key:"isDifferentDay",value:function(e){return this.date.getDay()!==e.getDay()||this.date.getMonth()!==e.getMonth()||this.date.getFullYear()!==e.getFullYear()}},{key:"mid",get:function(){return this._mid},set:function(e){this._mid=e}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"date",get:function(){return this._date},set:function(e){this._date=e}},{key:"chat",get:function(){return this._chat},set:function(e){this._chat=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"content",get:function(){return this._content},set:function(e){this._content=e}}]),e}(),Me=function(){function e(){Object(f.a)(this,e),this.events=new Map}return Object(g.a)(e,[{key:"on",value:function(e,t){this.events.has(e)?this.events.get(e).push(t):this.events.set(e,[t])}},{key:"rm",value:function(e,t){if(this.events.has(e))for(var a=this.events.get(e),n=0;n<a.length;n++)a[n]===t&&a.splice(n,1)}},{key:"trigger",value:function(e){if(this.events.has(e)){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];for(var r=0;r<this.events.get(e).length;r++){var s;(s=this.events.get(e))[r].apply(s,a)}}}},{key:"events",get:function(){return this._events},set:function(e){this._events=e}}]),e}(),Ue=function(){function e(t,a,n){Object(f.a)(this,e),this._messages=new re,this._event=new Me,this._unreadMessages=0,this._reachedTopMessages=!1,this.type=t,this.id=a,this.chatName=n}return Object(g.a)(e,[{key:"initFirstMessage",value:function(e){e.empty||this.messages.add(e.mid,new xe(e.mid,e.uid,this,new Date(e.date),e.type,e.content))}},{key:"loadMessages",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r,s,c,i,o,u,l,h,p=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reachedTopMessages){e.next=17;break}return a=function(){var e=p.getLastMessage();return null!==e?e.mid:-1},n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatType:this.type,chatId:this.id,lastMsgId:a(),num:t})},e.next=5,ce("/message/load",n);case 5:if(!(r=e.sent).ok){e.next=16;break}return e.next=9,r.json();case 9:for(s=e.sent,this.reachedTopMessages="reached top"===s.status,c=s.messages,i=new Array(c.length),o=this.showUserInfoMessage(),u=c.length-1;u>=0;u--)l=c[u],h=new xe(l.mid,l.uid,this,new Date(l.date),l.type,l.content),this.messages.add(l.mid,h),i[u]=h.getMessageObject(o);return e.abrupt("return",i);case 16:throw new Error;case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLastMessage",value:function(){return 0!==this.messages.length?this.messages[0].value:null}},{key:"getFirstMessage",value:function(){return 0!==this.messages.length?this.messages[this.messages.length-1].value:null}},{key:"getMessages",value:function(){for(var e=this.showUserInfoMessage(),t=new Array(this.messages.length),a=0;a<this.messages.length;a++){var n=this.messages[a].value;t[a]=n.getMessageObject(e)}return t}},{key:"addMessage",value:function(e,t,a,n){var r=new xe(t,e,this,new Date(Date.now()),a,n);this.messages.add(t,r),Object(i.getDispatch)().newMsg(this,this.unreadMessages,r.getMessageObject(this.showUserInfoMessage()))}},{key:"showUserInfoMessage",value:function(){return"groupChat"===this.type}},{key:"getChatObject",value:function(){return{type:this.type,id:this.id,chatName:this.chatName,latestMessage:this.getLatestMessageObject(),unreadMessages:this.unreadMessages}}},{key:"getLatestMessageObject",value:function(){if(0===this.messages.length)return null;var e=this.getFirstMessage();return{msgString:e.getChatViewMsgString(),dateString:e.getChatViewDateString(),date:e.date}}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"chatName",get:function(){return this._chatName},set:function(e){this._chatName=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"unreadMessages",get:function(){return this._unreadMessages},set:function(e){this._unreadMessages=e}},{key:"reachedTopMessages",get:function(){return this._reachedTopMessages},set:function(e){this._reachedTopMessages=e}}]),e}(),De=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e,n,r){var s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(f.a)(this,a),(s=t.call(this,"normalChat",e,n))._isTyping=!1,s.otherUser=r,s.unreadMessages=c,s}return Object(g.a)(a,[{key:"getUsersTyping",value:function(){if(this.isTyping){var e=Le.users.get(this.otherUser);return[{uid:e.uid,username:e.username}]}return[]}},{key:"getLatestUserTyping",value:function(){if(this.isTyping){var e=Le.users.get(this.otherUser);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!0,this.event.trigger("typeState changed"))}},{key:"stoppedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!1,this.event.trigger("typeState changed"))}},{key:"otherUser",get:function(){return this._otherUser},set:function(e){this._otherUser=e}},{key:"isTyping",get:function(){return this._isTyping},set:function(e){this._isTyping=e}}]),a}(Ue),_e=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e,n,r){var s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(f.a)(this,a),(s=t.call(this,"groupChat",e,n))._users=[],s._usersTyping=[],s.users=r,s.unreadMessages=c,s}return Object(g.a)(a,[{key:"getUsersTyping",value:function(){if(this.usersTyping.length>0){for(var e=[],t=0;t<this.usersTyping.length;t++){var a=Le.users.get(this.usersTyping[t]);e.push({uid:a.uid,username:a.username})}return e}return[]}},{key:"getLatestUserTyping",value:function(){if(this.usersTyping.length>0){var e=Le.users.get(this.usersTyping[this.usersTyping.length-1]);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){this.isMember(e)&&(this.isTyping(e)||(this.usersTyping.push(e),this.event.trigger("typeState changed")))}},{key:"stoppedTyping",value:function(e){this.isMember(e)&&this.isTyping(e)&&(this.usersTyping.splice(this.getIndexOfTyping(e),1),this.event.trigger("typeState changed"))}},{key:"isMember",value:function(e){return e!==Le.userSelf.uid&&this.users.find((function(t){return t===e}))}},{key:"isTyping",value:function(e){return this.usersTyping.find((function(t){return t===e}))}},{key:"getIndexOfTyping",value:function(e){return this.usersTyping.findIndex((function(t){return t===e}))}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"usersTyping",get:function(){return this._usersTyping},set:function(e){this._usersTyping=e}}]),a}(Ue),Ie=function(){function e(){Object(f.a)(this,e),this._isShown=!1}return Object(g.a)(e,[{key:"createNew",value:function(e,t){this.chatNow=new De(0,t,e)}},{key:"doesExist",value:function(e){return void 0!==this.chatNow&&this.chatNow.otherUser===e}},{key:"show",value:function(){this.isShown=!0,Object(i.getDispatch)().showTempChat(this.chatNow)}},{key:"update",value:function(){Object(i.getDispatch)().updateTempChat(this.chatNow)}},{key:"hide",value:function(){this.isShown=!1,Object(i.getDispatch)().hideTempChat()}},{key:"createNewNormalChat",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r,s,c,o,u,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.chatNow.otherUser,n=this.chatNow.chatName,r={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({uid:a,username:n,message:{type:ve.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}}})},e.next=5,ce("/user/chat",r);case 5:if(!(s=e.sent).ok){e.next=21;break}return e.next=9,s.json();case 9:return c=e.sent,-1===Le.users.getIndex(a)&&Le.users.add(a,new ge(a,n)),o=Le.users.get(a),u=new De(c.ncid,n,a),o.normalChat=u.id,Le.chats.normal.add(c.ncid,u),l=new xe(c.mid,Le.userSelf.uid,u,new Date(Date.now()),ve.messageTypes.normalMessage,{text:t,mentions:[],media:[]}),u.messages.add(l.mid,l),Object(i.getDispatch)().addChat(u),Object(i.getDispatch)().selectChat(u),this.hide(),e.abrupt("return",!0);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isShown",get:function(){return this._isShown},set:function(e){this._isShown=e}},{key:"chatNow",get:function(){return this._chatNow},set:function(e){this._chatNow=e}}]),e}(),Ae=function(){function e(){Object(f.a)(this,e),this._userSelf={uid:0,username:""},this._users=new re,this._chats={normal:new re,group:new re},this._event=new Me,this._finishedLoading=!1,this._temporaryChat=new Ie,this._initCalled=!1}return Object(g.a)(e,[{key:"destruct",value:function(){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect()),this.initCalled=!1}},{key:"init",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,n,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(i.getGlobal)().userSelf,a=t.uid,n=t.username,this.userSelf=new ge(a,n),this.userInfo={uid:a,username:n},this.initCalled=!0,this.userSelf=new ge(a,n),this.userInfo={uid:a,username:n},this.socket=ee.a.connect("/",{secure:!0}),this.socket.emit("auth",Object(i.getGlobal)().authTokens),this.socket.on("initialized",(function(){r.initChats()})),this.socket.on("chat message",(function(e){var t=r.getChat(e.chat.type,e.chat.id);if(null!==t){var a=r.isCurrentChat(t.type,t.id);t.addMessage(e.uid,e.mid,e.type,e.content),t.hasNewMsg=!a,t.unreadMessages++,r.event.trigger("new message",e.chat.type,e.chat.id)}})),this.socket.on("started typing",(function(e){r.getChat(e.chat.type,e.chat.id).startedTyping(e.uid)})),this.socket.on("stopped typing",(function(e){r.getChat(e.chat.type,e.chat.id).stoppedTyping(e.uid)})),this.socket.on("users-noChat",(function(e){Re.event.trigger("users-noChat",e)})),this.socket.on("new chat",(function(e){r.addNewChat(e)})),this.socket.on("disconnect",(function(){setTimeout((function(){alert("Verbindung verloren! Seite wird neu geladen"),location.reload()}),1e3)}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initChats",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,ce("/chats",t);case 3:if(200!==(a=e.sent).status){e.next=9;break}return e.next=7,a.json();case 7:for(n=e.sent,r=0;r<n.length;r++)"normalChat"===n[r].type?this.addNewNormalChat(n[r]):"groupChat"===n[r].type&&this.addNewGroupChat(n[r]);case 9:this.finishedLoading=!0,this.event.trigger("chats loaded",this.getChatArraySortedByDate());case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChatArraySortedByDate",value:function(){function e(e){var t=e.latestMessage;return null!==t?t.date.getTime():new Date(0).getTime()}function t(t,a){for(var n=a,r=a+1;r<t.length;r++)e(t[n])<e(t[r])&&(n=r);return n}function a(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function n(e){for(var n=function(e){for(var t=new Array(e.length),a=0;a<e.length;a++){var n=e[a].value;t[a]=n.getChatObject()}return t}(e),r=0;r<n.length-1;r++){a(n,r,t(n,r))}return n}return function(t,a){for(var n=new Array(t.length+a.length),r=0,s=0,c=0;c<n.length;c++)s<a.length?r<t.length&&e(t[r])>e(a[s])?(n[c]=t[r],r++):(n[c]=a[s],s++):(n[c]=t[r],r++);return n}(n(this.chats.normal),n(this.chats.group))}},{key:"isCurrentChat",value:function(e,t){var a=Object(i.getGlobal)().currentChat;return a.type===e&&a.id===t}},{key:"getChat",value:function(e,t){return"normalChat"===e?this.chats.normal.get(t):"tempChat"===e?this.temporaryChat.chatNow:"groupChat"===e?this.chats.group.get(t):void 0}},{key:"addNewChat",value:function(e){var t;"normalChat"===e.type?t=this.addNewNormalChat(e):"groupChat"===e.type&&(t=this.addNewGroupChat(e)),t.unreadMessages=1,Object(i.getDispatch)().addChat(t)}},{key:"addNewNormalChat",value:function(e){var t;-1===this.users.getIndex(e.members[0].uid)?(t=new ge(e.members[0].uid,e.members[0].username),this.users.add(t.uid,t)):t=this.users.get(e.members[0].uid);var a=new De(e.id,e.chatName,t.uid,e.unreadMessages);return t.normalChat=a.id,a.initFirstMessage(e.firstMessage),this.chats.normal.add(e.id,a),a}},{key:"addNewGroupChat",value:function(e){for(var t=[],a=0;a<e.members.length;a++){var n=e.members[a],r=void 0;-1===this.users.getIndex(n.uid)?(r=new ge(n.uid,n.username),this.users.add(r.uid,r)):r=this.users.get(n.uid),t.push(r.uid),r.addGroupChat(e.id)}var s=new _e(e.id,e.chatName,t,e.unreadMessages);return s.initFirstMessage(e.firstMessage),this.chats.group.add(e.id,s),s}},{key:"socket",get:function(){return this._socket},set:function(e){this._socket=e}},{key:"userSelf",get:function(){return this._userSelf},set:function(e){this._userSelf=e}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"chats",get:function(){return this._chats},set:function(e){this._chats=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"finishedLoading",get:function(){return this._finishedLoading},set:function(e){this._finishedLoading=e}},{key:"temporaryChat",get:function(){return this._temporaryChat},set:function(e){this._temporaryChat=e}},{key:"initCalled",get:function(){return this._initCalled},set:function(e){this._initCalled=e}}]),e}(),Re=new Ae;var Le=Re,Ge=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).isSelected=function(){return n.props.id===n.global.currentChat.id&&n.props.type===n.global.currentChat.type},n.typeStateChanged=function(){var e="",t=Le.getChat(n.props.type,n.props.id).getLatestUserTyping();null!==t&&(e=t.username+" schreibt..."),n.setState({typeMsg:e})},n.state={lastMsg:void 0,typeMsg:""},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this,t=function(){return e.props.latestMessage?o.a.createElement("span",null,e.props.latestMessage.msgString):o.a.createElement("span",null,"Noch keine Nachrichten vorhanden")},a=function(){return e.props.latestMessage?o.a.createElement("div",{className:"lastMsg-date"},e.props.latestMessage.dateString):null};return o.a.createElement("li",{className:this.isSelected()?"selected ":""},o.a.createElement(u.b,{to:"normalChat"===e.props.type?"/chat/user/"+Le.getChat("normalChat",e.props.id).otherUser:"groupChat"===e.props.type?"/chat/group/"+e.props.id:"tempChat"===e.props.type?"/chat/user/"+Le.temporaryChat.chatNow.otherUser:void 0},o.a.createElement("div",{className:"w-100"},o.a.createElement("strong",null,this.props.name),0===e.props.unreadMessages?null:o.a.createElement("div",{className:"newMsg-number"},e.props.unreadMessages)),""===e.state.typeMsg?o.a.createElement("div",{className:"w-100 lastMsg"},t(),a()):o.a.createElement("div",{className:"w-100 typeMsg"},e.state.typeMsg)))}},{key:"componentDidMount",value:function(){Le.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,a){e.type===this.props.type&&e.id===this.props.id||(Le.getChat(e.type,e.id).event.rm("typeState changed",this.typeStateChanged),Le.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged),this.setState({typeMsg:""}))}},{key:"componentWillUnmount",value:function(){Le.getChat(this.props.type,this.props.id).event.rm("typeState changed",this.typeStateChanged)}}]),a}(i.Component),Be=(a(171),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={searchValue:""},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this,t=this.props.paddingTop||"1rem",a=0;return o.a.createElement("div",{style:{paddingTop:t,height:"100%"}},o.a.createElement("div",{className:"chat-c-list"},o.a.createElement(X,{onSearch:function(t){e.setState({searchValue:t})}}),o.a.createElement("ul",{className:"chat-list"},e.global.tempChat?o.a.createElement(Ge,{key:-1,id:0,type:"tempChat",name:e.global.tempChat.chatName,unreadMessages:0,latestMessage:null}):null,this.global.chats.map((function(t,n){return t.chatName.includes(e.state.searchValue)?(a++,o.a.createElement(Ge,{key:n,id:t.id,type:t.type,name:t.chatName,unreadMessages:t.unreadMessages,latestMessage:t.latestMessage})):null}))),0===a?o.a.createElement("span",null,"Nichts gefunden"):null))}}]),a}(i.Component));a(172);function Pe(e){return r.a.createElement("div",{className:"loader-init"},r.a.createElement("div",{className:"col-sm-12 my-auto"},r.a.createElement("div",{className:"init-container border rounded"},r.a.createElement("div",{className:"spinner-border text-secondary",style:{width:"15rem",height:"15rem",borderWidth:"0.5rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("div",{className:"loader-text"},e.msg))))}var Fe=a(50),ze=(a(173),a(107)),He=(a(175),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e))._userTyping=!1,n._typeEventEmitted=!1,n.onTyping=function(e){n.setState({message:e.target.value}),n.handleTypeMessage()},n.handleTypeMessage=function(){n.isTempChat||(n.userTyping&&clearTimeout(n.typeTimeout),n.userTyping=!0,n.typeEventEmitted||(n.typeEventEmitted=!0,Le.socket.emit("started typing")),n.typeTimeout=setTimeout((function(){n.userTyping=!1,n.typeEventEmitted&&(n.typeEventEmitted=!1,Le.socket.emit("stopped typing"))}),1e3))},n.onSubmit=function(e){if(e.preventDefault(),""!==n.state.message){var t=n.state.message;if(n.setState({message:""}),n.isTempChat){var a=n.props.location.pathname;Le.temporaryChat.createNewNormalChat(t).then((function(e){e&&(n.props.history.replace("/chat"),n.props.history.replace(a))}))}else n.sendMessage(t).then((function(e){Le.getChat(n.props.chatType,n.props.chatId).addMessage(Le.userSelf.uid,e,ve.messageTypes.normalMessage,{text:t,mentions:[],media:[]})})).catch((function(e){}))}},n.sendMessage=function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({type:ve.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}})},e.next=3,ce("/message",a);case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r.mid);case 9:return e.abrupt("return",new Error);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onEmojiInput=function(e){n.setState({message:n.state.message+e.native}),n.handleTypeMessage()},n.toggleEmoji=function(e){n.setState((function(e){return{showEmoji:!e.showEmoji}}))},n.state={message:"",showEmoji:!1},n}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement(z,null,r.a.createElement("form",{onSubmit:this.onSubmit,className:"msg-form"},r.a.createElement("div",{className:"message-input"},r.a.createElement("input",{autoComplete:"off",placeholder:"Nachricht:",value:this.state.message,onChange:this.onTyping}),r.a.createElement("i",{className:"far fa-smile fa-2x emoji-toggle",onClick:this.toggleEmoji})),r.a.createElement("button",{className:"btn-submit",type:"submit"},r.a.createElement("i",{className:"far fa-paper-plane fa-2x","data-toggle":"tooltip",title:"send message"}))),this.state.showEmoji?r.a.createElement("div",{style:{position:"absolute",bottom:"60px",right:"50px",width:"350px",height:"425px"}},r.a.createElement(ze.a,{onSelect:this.onEmojiInput})):null)}},{key:"componentDidMount",value:function(){this.isTempChat="tempChat"===this.props.chatType}},{key:"componentDidUpdate",value:function(e,t,a){this.isTempChat="tempChat"===this.props.chatType}},{key:"userTyping",get:function(){return this._userTyping},set:function(e){this._userTyping=e}},{key:"typeEventEmitted",get:function(){return this._typeEventEmitted},set:function(e){this._typeEventEmitted=e}},{key:"typeTimeout",get:function(){return this._typeTimeout},set:function(e){this._typeTimeout=e}},{key:"isTempChat",get:function(){return this._isTempChat},set:function(e){this._isTempChat=e}}]),a}(n.Component)),Ve=Object(l.j)(He),We=(a(176),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.scrollHandler=function(e){n.setState({scrollToBottom:n.getScrollToBottom()}),0===n.messagesNode.scrollTop&&n.loadMessages()},n.setScrollToBottom=function(e){n.messagesNode.scrollTop=n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-e},n.getScrollToBottom=function(){return n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-n.messagesNode.scrollTop},n.assignMessagesRef=function(e){n.messages=e},n.loadMessages=function(){var e=Le.getChat(n.global.currentChat.type,n.global.currentChat.id);e.reachedTopMessages||n.setState({msgLoading:!0}),e.loadMessages(10).then((function(e){n.dispatch.addLoadedMessages(e),n.setState((function(e){return{msgLoading:!1}})),n.setScrollToBottom(n.state.scrollToBottom)})).catch((function(e){return n.setState({msgLoading:!1})}))},n.chatChanged=function(){0===n.messagesNode.scrollTop&&n.loadMessages()},n.assignMessagesRef=n.assignMessagesRef.bind(Object(Fe.a)(n)),n.state={msgLoading:!1,scrollToBottom:0,messages:[],typeMessages:[]},n}return Object(g.a)(a,[{key:"componentDidMount",value:function(){this.messagesNode=c.a.findDOMNode(this.messages),this.chatChanged(),this.isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,a){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(this.setScrollToBottom(0),this.chatChanged()),0===this.state.scrollToBottom&&(this.setScrollToBottom(0),this.global.currentChat.newMessages>0&&this.setGlobal((function(e){return{currentChat:Object(se.a)(Object(se.a)({},e.currentChat),{},{newMessages:0})}})))}},{key:"render",value:function(){var e=this,t=new Date(0);return o.a.createElement("div",{className:"chat-container"},o.a.createElement("div",{className:"messages",onScroll:this.scrollHandler,ref:this.assignMessagesRef},e.state.msgLoading?o.a.createElement("div",{className:"messageLoader-top"},o.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading..."))):null,this.global.currentChat.messages.map((function(e,a){return o.a.createElement("div",{key:a},function(e){return a=e.date,n=t,a.getDay()!==n.getDay()||a.getMonth()!==n.getMonth()||a.getFullYear()!==n.getFullYear()?(t=e.date,o.a.createElement("div",{className:"date-container"},o.a.createElement("div",null,e.dateString))):(t=e.date,null);var a,n}(e),o.a.createElement(we,{msg:e}))})),0===e.global.currentChat.messages.length?o.a.createElement("div",{className:"alert alert-primary",role:"alert"},"Noch keine Nachrichten vorhanden"):null,e.isMounted&&e.getScrollToBottom()>10?o.a.createElement("div",{id:"messages-bottom",className:"messages-bottom",onClick:function(){e.setState({scrollToBottom:0})}},o.a.createElement("div",{id:"btnToBottom",className:"chevron-down"},o.a.createElement("i",{className:"fas fa-chevron-down fa-2x"})),e.global.currentChat.newMessages>0?o.a.createElement("div",{id:"scroll-down-number",className:"number"},e.global.currentChat.newMessages):null):null),o.a.createElement(Ve,{chatType:this.props.chatType,chatId:this.props.chatId}))}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"isMounted",get:function(){return this._isMounted},set:function(e){this._isMounted=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"messagesNode",get:function(){return this._messagesNode},set:function(e){this._messagesNode=e}}]),a}(i.Component)),Je=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"chat-container"},r.a.createElement("div",{className:"messages"},r.a.createElement("div",{className:"alert alert-primary",role:"alert"},"Noch keine Nachrichten vorhanden")),r.a.createElement(Ve,{chatType:"tempChat",chatId:0}))}},{key:"componentDidMount",value:function(){Le.temporaryChat.show()}},{key:"componentDidUpdate",value:function(e,t,a){e.uid!==this.props.uid&&Le.temporaryChat.update()}},{key:"componentWillUnmount",value:function(){Le.temporaryChat.hide()}}]),a}(n.Component);function Ye(){return r.a.createElement("div",null,r.a.createElement("h2",null,"ung\xfcltige Addresse"))}function qe(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du kannst dir selbst nicht schreiben"))}function $e(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser User hat dich blockiert"))}function Ke(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser User existiert nicht"))}function Qe(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du bist nicht Mitglied in diesem chat jetzt beitreten"))}function Xe(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du bist nicht dazu berechtigt diesen chat anzusehen"))}function Ze(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser Chat existiert nicht"))}function et(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Fehler"))}var tt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).userChanged=function(){var e=parseInt(n.props.uid);if(n.global.userSelf.uid===e)n.setState({error:pe,loaded:!0});else{var t=function(){(function(e){return fe.apply(this,arguments)})(e).then((function(t){t===oe?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:V,ihcData:{name:Le.users.get(e).username,uid:e}}).then(),n.selectNormalChat(e)):t===le?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:V,ihcData:{name:Le.temporaryChat.chatNow.chatName,uid:e}}).then(),n.selectTempChat()):n.setState({error:me}),n.setState({loaded:!0})})).catch((function(e){return n.setState({error:me})}))};Le.finishedLoading?t():Le.event.on("chats loaded",(function(){t()})),n.setState({uid:parseInt(n.props.uid)})}},n.state={uid:0,loaded:!1,error:oe},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"h-100"},function(){if(!e.state.loaded)return o.a.createElement(Pe,{msg:"Chat wird geladen"})}(),e.state.error===ue?o.a.createElement(Ye,null):e.state.error===pe?o.a.createElement(qe,null):e.state.loaded?e.state.error===oe?o.a.createElement(We,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id}):e.state.error===le?o.a.createElement(Je,{uid:e.state.uid}):e.state.error===de?o.a.createElement($e,null):o.a.createElement(Ke,null):void 0)}},{key:"componentDidMount",value:function(){this.userChanged()}},{key:"componentDidUpdate",value:function(e,t,a){e.uid!==this.props.uid&&(isNaN(this.props.uid)?this.setState({error:ue}):this.userChanged())}},{key:"selectTempChat",value:function(){this.dispatch.showTempChat()}},{key:"selectNormalChat",value:function(e){if(-1===Le.users.getIndex(e))this.setState({error:he});else{var t=Le.users.get(e).normalChat,a=Le.getChat("normalChat",t);this.dispatch.selectChat(a)}}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:H,ihcData:null}).then()}}]),a}(i.Component),at=(a(177),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"modal-outer",onClick:function(){e.props.history.goBack()}},r.a.createElement("div",{className:"h-100",style:{display:"flex"}},r.a.createElement("div",{className:"modal-inner",onClick:function(e){e.stopPropagation()}},r.a.createElement("div",{className:"btn-close",onClick:function(){e.props.history.goBack()}},"\xd7"),this.props.children)))}}]),a}(n.Component)),nt=Object(l.j)(at);function rt(e){return r.a.createElement("div",{className:"m-header"},e.children)}function st(e){return r.a.createElement("div",{className:"m-main"},e.children)}var ct=a(108),it=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).clicked=function(t){e.props.isSelected?e.props.deselectUser(e.props.index):e.props.selectUser(e.props.index)},e}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("li",{key:this.props.index,onClick:this.clicked},r.a.createElement("div",{className:"username"},this.props.username),r.a.createElement("div",{className:"user-select fa-lg"+(this.props.isSelected?" selected":"")},r.a.createElement("i",{className:"fas fa-check"})))}}]),a}(n.Component),ot=a(53),ut=a.n(ot),lt=0,ht=1,dt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e.target.value,searchResult:[],hasMore:!0})},n.loadUsers=Object(p.a)(d.a.mark((function e(){var t,a,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,a=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===a){e.next=22;break}return n.lastRequest={searchValue:t,length:a},e.prev=4,e.next=7,n.props.loadUsers(t,a);case 7:if(!(r=e.sent).ok){e.next=16;break}return e.next=11,r.json();case 11:0===(s=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(s)}})),n.setState({error:lt}),e.next=17;break;case 16:n.setState({error:ht});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:ht});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.selectUser=function(e){var t=n.state.searchResult[e];n.props.selectUser(t.uid,t.username)},n.deselectUser=function(e){var t=n.state.searchResult[e];n.props.deselectUser(t.uid)},n.state={searchValue:"",searchResult:[],error:lt,hasMore:!0},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(z,null,r.a.createElement("form",{className:"form-group",style:{width:"90%",maxWidth:"650px"}},r.a.createElement("input",{type:"text",className:"form-control p-2 m-2",placeholder:"Benutzer suchen",value:this.state.searchValue,onChange:this.searchChanged})),r.a.createElement("div",{className:"selectUsers",ref:function(t){return e.scrollParentRef=t}},r.a.createElement(ut.a,{pageStart:0,loadMore:this.loadUsers,hasMore:this.state.hasMore,loader:r.a.createElement("div",{className:"loader",key:-1},r.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),useWindow:!1,getScrollParent:function(){return e.scrollParentRef}},r.a.createElement("ul",{className:"selectUsers"},this.state.searchResult.map((function(t,a){return r.a.createElement(it,{key:a,index:a,uid:t.uid,username:t.username,selectUser:e.selectUser,deselectUser:e.deselectUser,isSelected:e.props.isUserSelected(t.uid)})})),0===this.state.searchResult.length?r.a.createElement("div",{key:-1,className:"nothingFound"},"Nichts gefunden!"):null))))}}]),a}(n.Component),pt=(a(179),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).selectUser=function(e,t){n.setState((function(a){return{selectedUsers:a.selectedUsers.concat({uid:e,username:t})}}))},n.deselectUser=function(e){n.setState((function(t){var a=Object(ct.a)(t.selectedUsers),n=a.findIndex((function(t){return t.uid===e}));return a.splice(n,1),{selectedUsers:a}}))},n.deselectIndex=function(e){n.deselectUser(n.state.selectedUsers[e].uid)},n.isUserSelected=function(e){return n.state.selectedUsers.find((function(t){return t.uid===e}))},n.btnNextClicked=function(e){n.props.onNext(n.state.selectedUsers)},n.state={selectedUsers:[],showOnlySelected:!1},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return 0===this.state.selectedUsers.length&&this.state.showOnlySelected&&this.setState({showOnlySelected:!1}),r.a.createElement(z,null,r.a.createElement("div",{className:"select-users"},0===e.state.selectedUsers.length?r.a.createElement("h4",null,"Noch niemand ausgew\xe4hlt"):r.a.createElement("h4",{className:"w-100"},r.a.createElement("span",{className:"selected-num"+(e.state.showOnlySelected?" selected":""),onClick:function(t){e.setState((function(e){return{showOnlySelected:!e.showOnlySelected}}))}},e.state.selectedUsers.length,"\xa0Benutzer"),"\xa0ausgew\xe4hlt",r.a.createElement("i",{className:"fas fa-arrow-right fa-lg float-right btn-next",onClick:e.btnNextClicked}))),this.state.showOnlySelected?r.a.createElement("div",{className:"selectUsers"},r.a.createElement("ul",{className:"selectUsers only-selected"},this.state.selectedUsers.map((function(t,a){return r.a.createElement(it,{key:a,index:a,uid:t.uid,username:t.username,selectUser:function(){},deselectUser:e.deselectIndex,isSelected:!0})})))):r.a.createElement(dt,{selectUser:this.selectUser,deselectUser:this.deselectUser,isUserSelected:this.isUserSelected,loadUsers:this.props.loadUsers}))}}]),a}(n.Component));function mt(e){var t=Object(l.g)(),a=function(){var a=Object(p.a)(d.a.mark((function a(n){var r;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:n})},a.next=3,ce("/group/"+e.gcid+"/members",r);case 3:a.sent.ok&&t.goBack();case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),n=function(){var t=Object(p.a)(d.a.mark((function t(a,n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:a,limit:10,start:n})},t.next=3,ce("/user/notInGroup/"+e.gcid,r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(z,null,r.a.createElement(rt,null,r.a.createElement("h2",null,"Benutzer hinzuf\xfcgen")),r.a.createElement(st,null,r.a.createElement(pt,{onNext:a,loadUsers:n})))}var ft=a(43),gt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.removeMemberFromChat=Object(p.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"DELETE",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid,a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.makeMemberAdmin=Object(p.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"POST",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/giveAdmin",a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.removeMemberAdmin=Object(p.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"POST",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/removeAdmin",a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e}return Object(g.a)(a,[{key:"isMemberSelf",value:function(){return this.props.member.uid===this.global.userSelf.uid}},{key:"render",value:function(){var e=this.props.location.pathname;return o.a.createElement("ul",{className:"userOptions"},o.a.createElement("li",{key:0},o.a.createElement(u.b,{to:e+"/userInfo/"+this.props.member.uid},"zeige ",this.props.member.username," an")),o.a.createElement("li",{key:1},o.a.createElement(u.b,{to:"/chat/user/"+this.props.member.uid},"Nachricht an ",this.props.member.username)),this.isSelfAdmin()&&!this.isMemberSelf()?o.a.createElement(z,null,o.a.createElement("li",{key:2,className:"noLink",onClick:this.removeMemberFromChat},"aus chat entfernen"),this.props.member.isAdmin?o.a.createElement("li",{key:3,className:"noLink",onClick:this.removeMemberAdmin},"admin status entfernen"):o.a.createElement("li",{key:4,className:"noLink",onClick:this.makeMemberAdmin},"zu admin machen")):null)}}]),a}(i.Component),vt=Object(l.j)(gt),bt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.leaveChat=Object(p.a)(d.a.mark((function t(){var a,n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",headers:{Accept:"application/json"}},t.next=3,ce("/group/"+e.props.gcid+"/leave",a);case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:(r=t.sent).error&&console.log(r.error);case 9:case"end":return t.stop()}}),t)}))),e.removeSelfAdmin=Object(p.a)(d.a.mark((function t(){var a,n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",headers:{Accept:"application/json"}},t.next=3,ce("/group/"+e.props.gcid+"/removeAdmin",a);case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:(r=t.sent).error&&console.log(r.error);case 9:case"end":return t.stop()}}),t)}))),e}return Object(g.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return r.a.createElement("ul",{className:"chatOptions"},this.isSelfAdmin()?r.a.createElement(z,null,r.a.createElement("li",{key:0},r.a.createElement(u.b,{to:e+"/addUsers"},"Benutzer hinzuf\xfcgen")),r.a.createElement("li",{key:1,className:"noLink",onClick:this.removeSelfAdmin},"admin status entfernen")):null,r.a.createElement("li",{key:2,className:"noLink",onClick:this.leaveChat},"Chat verlassen"))}}]),a}(n.Component),yt=Object(l.j)(bt),Et=a(102),kt=a.n(Et),Ct=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleEdit=function(){var e=Object(p.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,n.setState({isEditing:!1,value:a}),e.next=4,n.props.onSubmit(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.editPressed=function(){n.setState({isEditing:!0})},n.state={isEditing:!1,value:n.props.value},n}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:this.props.class},r.a.createElement(kt.a,{name:this.props.name,value:this.state.value,isEditing:this.state.isEditing,changeCallback:this.handleEdit,optClass:"input"}),r.a.createElement("i",{className:"fas fa-edit edit",onClick:this.editPressed}))}}]),a}(n.Component),wt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(p.a)(d.a.mark((function t(a){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({description:a})},t.next=3,ce("/group/"+e.props.gcid+"/description",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement(Ct,{class:"description",name:"editDescription",value:this.props.description,onSubmit:this.onSubmit})}}]),a}(n.Component),jt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(p.a)(d.a.mark((function t(a){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatName:a})},t.next=3,ce("/group/"+e.props.gcid+"/chatName",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement(Ct,{class:"chatName",name:"editChatName",value:this.props.chatName,onSubmit:this.onSubmit})}}]),a}(n.Component),Ot=(a(205),function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={error:!1,data:null},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this;if(this.state.error)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Ein Fehler ist aufgetreten!");var t=Le.userSelf.uid;return r.a.createElement("div",{className:"groupChatInfo"},this.props.data.memberSelf.isAdmin?r.a.createElement("h1",null,r.a.createElement(jt,{gcid:this.props.gcid,chatName:this.props.data.chatName})):r.a.createElement("div",{className:"chatName"},r.a.createElement("h1",null,this.props.data.chatName)),this.props.data.memberSelf.isAdmin?r.a.createElement(wt,{gcid:this.props.gcid,description:this.props.data.description}):r.a.createElement("div",{className:"description"},this.props.data.description),r.a.createElement(ft.a,{trigger:["click"],overlay:r.a.createElement(yt,{gcid:this.props.gcid,memberSelf:this.props.data.memberSelf})},r.a.createElement("i",{className:"fas fa-ellipsis-v fa-lg chat-options-btn fa-2x",role:"button"})),r.a.createElement("h4",null,this.props.data.members.length,"\xa0Mitglieder:"),r.a.createElement("ul",{className:"userList"},this.props.data.members.map((function(a,n){return r.a.createElement("li",{key:n},r.a.createElement("div",{className:"userItem"},t===a.uid?r.a.createElement("span",null,"Du"):a.username,r.a.createElement("div",{className:"right"},a.isAdmin?r.a.createElement("span",{className:"user-admin"},"Admin\xa0\xa0"):null,r.a.createElement(ft.a,{trigger:["click"],overlay:r.a.createElement(vt,{gcid:e.props.gcid,memberSelf:e.props.data.memberSelf,member:a}),animation:"slide-up",alignPoint:!0},r.a.createElement("i",{className:"fas fa-ellipsis-v fa-lg",role:"button"})))))}))))}}]),a}(n.Component)),Nt=Object(l.j)(Ot);function St(e){var t=Object(l.i)().path,a=r.a.createElement(Nt,{gcid:e.gcid,data:e.data});return r.a.createElement(z,null,r.a.createElement(F,{displayIn:["Mobile"]},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/addUsers")},r.a.createElement(mt,{gcid:e.gcid})),r.a.createElement(l.b,{path:"*"},a))),r.a.createElement(F,{displayIn:["Laptop","Tablet"]},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/addUsers")},r.a.createElement(nt,null,r.a.createElement(mt,{gcid:e.gcid})))),a))}var Tt=0,xt=1,Mt=2,Ut=3,Dt=4,_t=5,It=0,At=1,Rt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).loadGroupChatInfo=function(){var e=Object(p.a)(d.a.mark((function e(t){var a,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={method:"GET",headers:{Accept:"application/json"}},e.next=4,ce("/group/"+n.props.gcid+"/",a);case 4:if(403!==(r=e.sent).status){e.next=9;break}return e.abrupt("return",Dt);case 9:if(404!==r.status){e.next=13;break}return e.abrupt("return",Mt);case 13:if(!r.ok){e.next=30;break}return e.next=16,r.json();case 16:if(s=e.sent,n.setState({chatData:s}),!s.error){e.next=26;break}if("not part of chat"!==s.error){e.next=23;break}return e.abrupt("return",Ut);case 23:return e.abrupt("return",_t);case 24:e.next=28;break;case 26:if(-1===Le.chats.group.getIndex(t)){e.next=28;break}return e.abrupt("return",Tt);case 28:e.next=31;break;case 30:return e.abrupt("return",_t);case 31:e.next=36;break;case 33:return e.prev=33,e.t0=e.catch(0),e.abrupt("return",_t);case 36:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t){return e.apply(this,arguments)}}(),n.chatChanged=function(){if(isNaN(n.props.gcid))n.setState({error:xt,loaded:!0});else{var e=function(){var e=parseInt(n.props.gcid);n.loadGroupChatInfo(e).then((function(t){t===Tt?(n.selectGroupChat(e),n.setState({loaded:!0,error:Tt,gcid:e}),n.setGlobal({infoHeaderCenter:W,ihcData:{name:Le.chats.group.get(e).chatName,gcid:e}}).then()):n.setState({loaded:!0,error:t})})).catch()};Le.finishedLoading?e():Le.event.on("chats loaded",(function(){e()}))}},n.state={gcid:0,loaded:!1,chatData:null,error:Tt},n}return Object(g.a)(a,[{key:"selectGroupChat",value:function(e){if(-1===Le.chats.group.getIndex(e))this.setState({error:Mt});else{var t=Le.chats.group.get(e);this.dispatch.selectChat(t)}}},{key:"componentDidMount",value:function(){this.chatChanged()}},{key:"componentDidUpdate",value:function(e,t,a){e.gcid!==this.props.gcid&&this.chatChanged()}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:H,ihcData:null}).then()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"h-100"},function(){if(!e.state.loaded)return o.a.createElement(Pe,{msg:"Chat wird geladen"})}(),function(){if(e.state.error===xt)return o.a.createElement(Ye,null);if(e.state.loaded)switch(e.state.error){case Tt:switch(e.props.tab){case It:return o.a.createElement(We,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id});case At:return o.a.createElement(St,{gcid:e.state.gcid,data:e.state.chatData});default:return null}case Ut:return o.a.createElement(Qe,null);case Dt:return o.a.createElement(Xe,null);case Mt:return o.a.createElement(Ze,null);case _t:return o.a.createElement(et,null);default:return null}}())}}]),a}(i.Component),Lt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).elementClicked=function(t){Le.temporaryChat.createNew(e.props.uid,e.props.username)},e}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("li",null,r.a.createElement(u.b,{to:"/chat/user/"+this.props.uid,onClick:this.elementClicked,replace:!0},this.props.username))}}]),a}(n.Component),Gt=Object(l.j)(Lt),Bt=(a(206),0),Pt=1,Ft=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e,searchResult:[],hasMore:!0})},n.loadChats=Object(p.a)(d.a.mark((function e(){var t,a,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,a=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===a){e.next=22;break}return n.lastRequest={searchValue:t,length:a},e.prev=4,e.next=7,n.props.loadChats(t,a);case 7:if(!(r=e.sent).ok){e.next=16;break}return e.next=11,r.json();case 11:0===(s=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(s)}})),n.setState({error:Bt}),e.next=17;break;case 16:n.setState({error:Pt});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:Pt});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.state={error:Bt,showOptions:!1,searchValue:"",searchResult:[],hasMore:!0},n}return Object(g.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.showSearchBar||this.props.searchValue!==e.searchValue&&this.searchChanged(this.props.searchValue)}},{key:"render",value:function(){var e=this;return this.state.error===Pt?r.a.createElement("div",{className:"alert alert-danger",role:"alert",key:0},"Ein Fehler ist aufgetreten!"):r.a.createElement(z,null,this.props.showSearchBar?r.a.createElement("div",{className:"user-top"},r.a.createElement("div",{className:"searchUser"},r.a.createElement("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:function(t){e.searchChanged()}}))):null,r.a.createElement("div",{className:"selectChat",ref:function(t){return e.scrollParentRef=t}},r.a.createElement(ut.a,{pageStart:0,loadMore:this.loadChats,hasMore:this.state.hasMore,loader:r.a.createElement("div",{className:"loader",key:-1},r.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),useWindow:!1,getScrollParent:function(){return e.scrollParentRef}},r.a.createElement("ul",{className:"selectChat"},this.state.searchResult.map((function(t,a){return r.a.createElement(Gt,{key:a,uid:t.uid,username:t.username,hide:e.props.hide})})),0===this.state.searchResult.length?r.a.createElement("div",{key:-1,className:"nothingFound"},"Nichts gefunden!"):null))))}}]),a}(n.Component),zt=(a(207),a(208),0),Ht=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).newGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Qt.newGroup)},n.joinGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Qt.chooseGroup)},n.searchChanged=function(e){var t=e.target.value;n.setState({searchValue:t,searchValid:!0})},n.loadChats=function(){var e=Object(p.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:t,limit:10,start:a})},e.next=3,ce("/user/noChat",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={error:zt,searchValue:""},n}return Object(g.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{className:"options"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:this.newGroupClick},"neue Gruppe"),r.a.createElement("li",{onClick:this.joinGroupClick},"einer Gruppe beitreten")));return r.a.createElement(z,null,r.a.createElement("div",{className:"user-top"},r.a.createElement("div",{className:"searchUser"},r.a.createElement("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:this.searchChanged})),r.a.createElement("div",{className:"user-more"},r.a.createElement(ft.a,{trigger:["click"],overlay:e,animation:"slide-up",alignPoint:!0},r.a.createElement("i",{className:"fas fa-ellipsis-h fa-2x",role:"button"})))),r.a.createElement(Ft,{showSearchBar:!1,searchValue:this.state.searchValue,loadChats:this.loadChats}))}}]),a}(n.Component),Vt=(a(209),a(106)),Wt=a.n(Vt),Jt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).groupNameChanged=function(e){n.setState({groupName:e.target.value})},n.descriptionChanged=function(e){n.setState({description:e.target.value})},n.isPublicChanged=function(){n.setState((function(e){return{isPublic:!e.isPublic}}))},n.formSubmitted=function(e){e.preventDefault(),""!==n.state.groupName&&n.props.submitGroup({name:n.state.groupName,description:n.state.description,isPublic:n.state.isPublic})},n.state={groupName:"",description:"",isPublic:!1},n}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"groupInfoForm"},r.a.createElement("form",{onSubmit:this.formSubmitted},r.a.createElement("img",{style:{display:"none"},id:"groupImgInput1",src:Wt.a,alt:"Placeholder"}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleFormControlInput1"},"Gruppenname"),r.a.createElement("input",{type:"text",name:"groupName",className:"form-control",id:"input-groupName",placeholder:"Gruppenname",value:this.state.name,onChange:this.groupNameChanged,minLength:1})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description1"},"Beschreibung"),r.a.createElement("textarea",{className:"form-control",id:"description1",rows:"3",value:this.state.description,onChange:this.descriptionChanged})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"check-container"},"\xf6ffentlicher chat",r.a.createElement("input",{type:"checkbox",checked:this.state.isPublic,onChange:this.isPublicChanged}),r.a.createElement("span",{className:"checkmark"},r.a.createElement("i",{className:"fas fa-check"})))),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"float-right btn btn-primary m-3"},"Gruppe erstellen"))))}}]),a}(n.Component),Yt=0,qt=1,$t=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).showEnterChatInfo=function(e){n.setState({currentTab:qt,selectedUsers:e})},n.submitGroup=function(e){for(var t=new Array(n.state.selectedUsers.length),a=0;a<n.state.selectedUsers.length;a++)t[a]={uid:n.state.selectedUsers[a].uid,username:n.state.selectedUsers[a].username,isAdmin:!1};n.createGroupChat(e,t).then((function(e){}))},n.createGroupChat=function(){var e=Object(p.a)(d.a.mark((function e(t,a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:t,users:a})},e.next=4,ce("/group/",r);case 4:e.sent.ok&&n.props.history.goBack(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),n.loadUsers=function(){var e=Object(p.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:t,limit:10,start:a})},e.next=3,ce("/user/",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={currentTab:Yt,selectedUsers:[]},n}return Object(g.a)(a,[{key:"render",value:function(){switch(this.state.currentTab){case Yt:return r.a.createElement(pt,{onNext:this.showEnterChatInfo,loadUsers:this.loadUsers});case qt:return r.a.createElement(Jt,{submitGroup:this.submitGroup});default:return null}}}]),a}(n.Component),Kt=Object(l.j)($t),Qt=(a(210),{chooseUser:0,newGroup:1,chooseGroup:2}),Xt=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).setCurrentTab=function(e){n.setState({currentTab:e})},n.state={currentTab:Qt.chooseUser},n}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(z,null,r.a.createElement(rt,null,r.a.createElement("h1",null,function(){switch(e.state.currentTab){case Qt.chooseUser:return"Neuer Chat";case Qt.newGroup:return"Neue Gruppe";case Qt.chooseGroup:return"Gruppe ausw\xe4hlen";default:return"Neuer Chat"}}())),r.a.createElement(st,null,r.a.createElement("div",{className:"newChat"},function(){switch(e.state.currentTab){case Qt.chooseUser:return r.a.createElement(Ht,{setCurrentTab:e.setCurrentTab,hide:e.props.hide});case Qt.newGroup:return r.a.createElement(Kt,null);case Qt.chooseGroup:return r.a.createElement("div",null,r.a.createElement("h4",null,"chooseGroup"));default:return r.a.createElement(Ht,{setCurrentTab:e.setCurrentTab,hide:e.props.hide})}}())))}}]),a}(n.Component),Zt=0,ea=1,ta=2,aa=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).setUser=function(){if(isNaN(n.props.uid))n.setState({error:ta});else if(Le.userSelf.uid===parseInt(n.props.uid))n.setState({error:ea,loaded:!0});else{var e=parseInt(n.props.uid);n.setState({uid:e,error:Zt,loaded:!1}),n.fetchUser(e).then().catch()}},n.state={uid:0,loaded:!1,error:Zt,userInfo:null},n}return Object(g.a)(a,[{key:"render",value:function(){return this.state.loaded?this.state.error===ea?r.a.createElement(z,null,r.a.createElement(rt,null,r.a.createElement("h1",null,"Du")),r.a.createElement(st,null,"xx")):r.a.createElement(z,null,r.a.createElement(rt,null,r.a.createElement("h1",null,this.state.userInfo.username,"\xa0",r.a.createElement(u.b,{to:"/chat/user/"+this.state.uid},r.a.createElement("i",{className:"far fa-comment-alt"})))),r.a.createElement(st,null,r.a.createElement("h2",null,"Gruppen"))):null}},{key:"fetchUser",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{Accept:"application/json"}},e.next=3,ce("/user/"+t,a);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:return r=e.sent,this.setState({userInfo:r,loaded:!0}),e.abrupt("return",r);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.setUser()}},{key:"componentDidUpdate",value:function(e,t,a){e.uid!==this.props.uid&&this.setUser()}},{key:"componentWillUnmount",value:function(){}}]),a}(n.Component);function na(e){var t=Object(l.i)().path;return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/newChat")},e.children,r.a.createElement(nt,null,r.a.createElement(Xt,null))),r.a.createElement(l.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(t){return r.a.createElement(z,null,e.children,r.a.createElement(nt,null,r.a.createElement(aa,{uid:t.match.params.uidInfo})))}}),r.a.createElement(l.b,{path:"".concat(t,"/settings")},e.children,r.a.createElement(nt,null,r.a.createElement("h3",null,"settings"))),r.a.createElement(l.b,{path:"*"},e.children))}function ra(e){var t=Object(l.i)().path;return r.a.createElement("div",{className:"row justify-content-end main-container"},r.a.createElement("div",{className:"col-md-5 col-lg-4 col-xl-3 d-none d-md-block pr-3 pl-0 h-100"},r.a.createElement(Be,null)),r.a.createElement("div",{className:"col-md-7 col-lg-8 col-xl-9 col-overflow",style:{padding:"0"}},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/user/:uid"),render:function(e){return r.a.createElement(na,null,r.a.createElement(tt,{uid:e.match.params.uid}))}}),r.a.createElement(l.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return r.a.createElement(na,null,r.a.createElement(Rt,{gcid:e.match.params.gcid,tab:It}))}}),r.a.createElement(l.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return r.a.createElement(na,null,r.a.createElement(Rt,{gcid:e.match.params.gcid,tab:At}))}}),r.a.createElement(l.b,{path:t},r.a.createElement(na,null,r.a.createElement("h1",null,"noch kein chat ausgew\xe4hlt"))))))}a(211);var sa=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).typeStateChanged=function(){var e=Le.getChat(n.props.chatType,n.props.chatId);n.setState({usersTyping:e.getUsersTyping()})},n.state={usersTyping:[]},n}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"typeMsg-container"},this.state.usersTyping.map((function(e,t){return r.a.createElement("div",{key:t,className:"typeMsg"},e.username+" schreibt...")})))}},{key:"componentDidMount",value:function(){Le.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,a){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(Le.getChat(e.chatType,e.chatId).event.rm("typeState changed",this.typeStateChanged),Le.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged))}},{key:"componentWillUnmount",value:function(){Le.getChat(this.props.chatType,this.props.chatId).event.rm("typeState changed",this.typeStateChanged)}}]),a}(n.Component);function ca(e){var t=Object(l.i)().path;return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/newChat")},r.a.createElement(Xt,null)),r.a.createElement(l.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(e){return r.a.createElement(aa,{uid:e.match.params.uidInfo})}}),r.a.createElement(l.b,{path:"".concat(t,"/settings")},r.a.createElement("h3",null,"settings")),r.a.createElement(l.b,{path:"*"},e.children))}function ia(e){var t=Object(l.i)().path,a=Object(i.useGlobal)(),n=Object(x.a)(a,2),r=n[0],s=(n[1],function(){return""!==r.currentChat.type&&0!==r.currentChat.id?o.a.createElement(sa,{chatType:r.currentChat.type,chatId:r.currentChat.id}):null});return o.a.createElement("div",{className:"main-container"},o.a.createElement(l.d,null,o.a.createElement(l.b,{path:"".concat(t,"/user/:uid"),render:function(e){return o.a.createElement(ca,null,o.a.createElement(tt,{uid:e.match.params.uid}),s())}}),o.a.createElement(l.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return o.a.createElement(ca,null,o.a.createElement(Rt,{gcid:e.match.params.gcid,tab:It}),s())}}),o.a.createElement(l.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return o.a.createElement(ca,null,o.a.createElement(Rt,{gcid:e.match.params.gcid,tab:At}))}}),o.a.createElement(l.b,{path:t},o.a.createElement(ca,null,o.a.createElement(Be,{paddingTop:"20px"}))),o.a.createElement(l.b,{path:"*"},o.a.createElement("h3",null,"Not found!"))))}var oa=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={modal:0,modalInfo:null,notifications:0},n}return Object(g.a)(a,[{key:"componentDidMount",value:function(){Le.initCalled||Le.init().then((function(e){}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"h-100"},r.a.createElement(K,null),r.a.createElement(F,{displayIn:["Mobile"]},r.a.createElement(ia,null)),r.a.createElement(F,{displayIn:["Laptop","Tablet"]},r.a.createElement(ra,null)))}}]),a}(n.Component);a(212),a(213),a(214);function ua(){Object(i.addReducer)("deleteAuthTokens",(function(e,t){return localStorage.removeItem("authTokens"),location.reload(),t.deleteUserSelf(),t.resetGlobal(),Re.destruct(),Re=new Ae,{loaded:!0,authTokens:void 0}})),Object(i.addReducer)("initAuthTokens",function(){var e=Object(p.a)(d.a.mark((function e(t,a,n){var r,s,c,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be();case 3:return r={method:"GET",headers:{Accept:"application/json"}},e.next=6,ce("/user/self",r,n);case 6:if(403!==(s=e.sent).status){e.next=12;break}return localStorage.removeItem("authTokens"),e.abrupt("return",{loaded:!0,authTokens:void 0});case 12:return e.next=14,s.json();case 14:return c=e.sent,i=c.uid,o=c.username,a.setUserSelf(i,o),e.abrupt("return",{loaded:!0,authTokens:n});case 18:e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{loaded:!1});case 24:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,a,n){return e.apply(this,arguments)}}()),Object(i.addReducer)("setAuthTokens",(function(e,t,a){return localStorage.setItem("authTokens",JSON.stringify(a)),{loaded:!0,authTokens:a}}))}function la(){var e=Object(i.useDispatch)();return Object(i.useEffect)((function(){var t=JSON.parse(localStorage.getItem("authTokens"));e.initAuthTokens(t)}),[]),o.a.createElement(u.a,null,o.a.createElement(l.d,null,o.a.createElement(U,{path:"/chat",component:oa}),o.a.createElement(l.b,{exact:!0,path:"/login",component:N}),o.a.createElement(l.b,{exact:!0,path:"/register",component:T}),o.a.createElement(l.b,{path:"/about"},o.a.createElement("h1",null,"about")),o.a.createElement(l.b,{exact:!0,path:"/"},o.a.createElement(l.a,{to:"/chat"})),o.a.createElement(l.b,{path:"*"},o.a.createElement(ha,null))))}function ha(){var e=Object(l.h)();return o.a.createElement("div",null,o.a.createElement("h3",null,"No match for ",o.a.createElement("code",null,e.pathname)))}Object(i.setGlobal)({loaded:!1,authTokens:void 0,userSelf:{},infoHeaderCenter:H,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}),function(){function e(e){Object(i.setGlobal)({chats:e})}Le.finishedLoading?e(Le.getChatArraySortedByDate()):Le.event.on("chats loaded",e)}(),Object(i.addReducer)("setUserSelf",(function(e,t,a,n){return{userSelf:{uid:a,username:n}}})),Object(i.addReducer)("deleteUserSelf",(function(e,t){return{userSelf:{}}})),Object(i.addReducer)("resetGlobal",(function(e,t){return{infoHeaderCenter:H,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}})),function(){var e=this;function t(e,t){return e.chats.findIndex((function(e){return e.id===t.id&&e.type===t.type}))}Object(i.addReducer)("newMsg",(function(e,a,n,r,s){var c=t(e,n);if(-1!==c){if(function(e,t){var a=e.currentChat;return a.type===t.type&&a.id===t.id}(e,n)){var i=e.chats.splice(0),o=i[c];return o.latestMessage=n.getLatestMessageObject(),o.unreadMessages=0,i.splice(c,1),i.unshift(o),{chats:i,currentChat:Object(se.a)(Object(se.a)({},e.currentChat),{},{messages:e.currentChat.messages.concat(s),newMessages:e.currentChat.newMessages+1})}}var u=e.chats.splice(0),l=u[c];l.latestMessage=n.getLatestMessageObject();var h=e.newMessages;return 0===l.unreadMessages&&h++,l.unreadMessages=r+1,u.splice(c,1),u.unshift(l),{chats:u,newMessages:h}}})),Object(i.addReducer)("selectChat",(function(e,a,n){var r=t(e,n);if(-1!==r){var s=e.chats.splice(0),c=s[r],i=e.newMessages;return c.unreadMessages>0&&i--,c.unreadMessages=0,s[r]=c,Le.socket.emit("change chat",{type:n.type,id:n.id}),{currentChat:{type:n.type,id:n.id,messages:n.getMessages(),newMessages:0},chats:s,tempChat:null,newMessages:i}}})),Object(i.addReducer)("selectNoChat",(function(e,t){return Le.socket.emit("change chat",null),{currentChat:{type:"",id:0,messages:[]}}})),Object(i.addReducer)("addLoadedMessages",(function(e,t,a){return{currentChat:Object(se.a)(Object(se.a)({},e.currentChat),{},{messages:a?a.concat(e.currentChat.messages):e.currentChat.messages})}})),Object(i.addReducer)("addChat",(function(e,t,a){var n,r,s=e.chats.splice(0),c=a.getChatObject();if(0===s.length)return{chats:[c]};for(var i=0;i<s.length;i++)if(n=s[i],r=c,!n.latestMessage||r.latestMessage&&n.latestMessage.date.getTime()<r.latestMessage.date.getTime()){s.splice(i,0,c);break}return{chats:s}})),Object(i.addReducer)("removeChat",(function(a,n,r){var s=t(a,r),c=e.state.chats.splice(0);return c.splice(s,1),{chats:c}})),Object(i.addReducer)("showTempChat",(function(e,t){var a=Le.temporaryChat.chatNow;return Le.socket.emit("change chat",null),{tempChat:a.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("updateTempChat",(function(e,t,a){return{tempChat:a.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("hideTempChat",(function(e,t){return{tempChat:null}}))}(),ua();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(la,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[111,1,2]]]);
//# sourceMappingURL=main.e67e3024.chunk.js.map