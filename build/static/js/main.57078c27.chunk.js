(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{115:function(e,t,a){e.exports=a.p+"static/media/placeholder.99b71231.png"},121:function(e,t,a){e.exports=a(225)},140:function(e,t,a){},145:function(e,t,a){},147:function(e,t,a){},148:function(e,t,a){},179:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){},184:function(e,t,a){},185:function(e,t,a){},186:function(e,t,a){},188:function(e,t,a){},213:function(e,t,a){},214:function(e,t,a){},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},219:function(e,t,a){},220:function(e,t,a){},221:function(e,t,a){},222:function(e,t,a){},224:function(e,t,a){},225:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(11),c=a.n(s),i=a(1),o=a.n(i),u=a(9),l=a(14),h=a(38),p=a(4),m=a(5),d=a(6),f=a(7),g=a(56),v=a.n(g),b=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("small",{className:"alert alert-danger p-1 message d-block"},this.props.children)}}]),a}(n.Component),y=(a(140),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={showPassword:!1},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"psw-group"},r.a.createElement("i",{className:(this.state.showPassword?"fa-eye-slash":"fa-eye")+" fas psw-toggle-icon",onClick:function(){return e.setState((function(e){return{showPassword:!e.showPassword}}))}}),r.a.createElement("input",Object.assign({type:this.state.showPassword?"text":"password"},this.props)))}}]),a}(n.Component)),E=a(3),k=a.n(E),w=a(8),C=function(){var e=Object(w.a)(k.a.mark((function e(t,a){var n,r,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})},e.next=4,fetch("/auth/login",n);case 4:if(!(r=e.sent).ok){e.next=13;break}return e.next=8,r.json();case 8:return(s=e.sent).success&&(Object(i.getDispatch)().setUserSelf(s.uid,t),Object(i.getDispatch)().setAuthTokens(s.tokens)),e.abrupt("return",s);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),j=function(){var e=Object(w.a)(k.a.mark((function e(t,a){var n,r,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})},e.next=4,fetch("/auth/register",n);case 4:if(!(r=e.sent).ok){e.next=13;break}return e.next=8,r.json();case 8:return(s=e.sent).success&&(Object(i.getDispatch)().setUserSelf(s.uid,t),Object(i.getDispatch)().setAuthTokens(s.tokens)),e.abrupt("return",s);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),O=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(h.a)({},t,a))},n.submitHandler=function(e){e.preventDefault();var t,a,r={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},s=v()({username:n.state.username,password:n.state.password},r);"undefined"!=typeof s?(t="undefined"!=typeof s.username?s.username[0]:"",a="undefined"!=typeof s.password?s.password[0]:"",n.setState({valid:!1,uNameErr:t,pwErr:a})):(n.setState({valid:!0,uNameErr:"",pwErr:""}),C(n.state.username,n.state.password).then((function(e){e.success?n.props.history.push("/chat"):(void 0!==e.username&&n.setState({valid:!1,uNameErr:e.username}),void 0!==e.password&&n.setState({valid:!1,pwErr:e.password}))})))},n.uNameErr=function(){if(""!==n.state.uNameErr)return o.a.createElement(b,null,n.state.uNameErr)},n.pwErr=function(){if(""!==n.state.pwErr)return o.a.createElement(b,null,n.state.pwErr)},n.state={uNameErr:"",username:"",pwErr:"",password:"",valid:!1,redirect:!1},n}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"h-100",style:{display:"flex"}},o.a.createElement("div",{className:"col-sm-12 my-auto"},o.a.createElement("div",{className:"container border rounded p-3",style:{maxWidth:"800px"}},o.a.createElement("h1",null,"Login"),o.a.createElement("form",{onSubmit:this.submitHandler},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"username"},"Benutzername:"),this.uNameErr(),o.a.createElement("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort:"),this.pwErr(),o.a.createElement(y,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},"haben Sie noch keinen Account? ",o.a.createElement(u.b,{to:"/register"},"Jetzt registrieren")),o.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Login"})))))}}]),a}(i.Component),N=Object(l.j)(O),x=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(h.a)({},t,a))},n.submitHandler=function(e){e.preventDefault();var t,a,r,s={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}},passwordRepeat:{presence:!0,equality:"password",length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},c=v()({username:n.state.username,password:n.state.password,passwordRepeat:n.state.pwRepeat},s);"undefined"!=typeof c?(t="undefined"!=typeof c.username?c.username[0]:"",a="undefined"!=typeof c.password?c.password[0]:"",r="undefined"!=typeof c.passwordRepeat?c.passwordRepeat[0]:"",n.setState({valid:!1,uNameErr:t,pwErr:a,pwRepeatErr:r})):(n.setState({valid:!0,uNameErr:"",pwErr:"",pwRepeatErr:""}),j(n.state.username,n.state.password).then((function(e){e.success?n.props.history.push("/chat"):void 0!==e.username&&n.setState({valid:!1,uNameErr:e.username})})))},n.uNameErr=function(){if(""!==n.state.uNameErr)return o.a.createElement(b,null,n.state.uNameErr)},n.pwErr=function(){if(""!==n.state.pwErr)return o.a.createElement(b,null,n.state.pwErr)},n.pwRepeatErr=function(){if(""!==n.state.pwRepeatErr)return o.a.createElement(b,null,n.state.pwRepeatErr)},n.state={uNameErr:"",username:"",pwErr:"",password:"",pwRepeatErr:"",pwRepeat:"",valid:!1,redirect:!1},n}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"h-100",style:{display:"flex"}},o.a.createElement("div",{className:"col-sm-12 my-auto"},o.a.createElement("div",{className:"container border rounded p-3",style:{maxWidth:"800px"}},o.a.createElement("h1",null,"Registrieren"),o.a.createElement("form",{onSubmit:this.submitHandler},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"username"},"Benutzername:"),this.uNameErr(),o.a.createElement("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort:"),this.pwErr(),o.a.createElement(y,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"password"},"Passwort wiederholen:"),this.pwRepeatErr(),o.a.createElement(y,{name:"pwRepeat",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})),o.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Registrieren"})))))}}]),a}(i.Component),S=Object(l.j)(x),T=a(60),M=a(120);var U=function(e){var t=e.component,a=Object(M.a)(e,["component"]),n=Object(i.useGlobal)(),s=Object(T.a)(n,2),c=s[0];return s[1],r.a.createElement(l.b,Object.assign({},a,{render:function(e){return c.loaded?c.authTokens?r.a.createElement(t,e):r.a.createElement(l.a,{to:{pathname:"/login",state:{referer:e.location}}}):null}}))},D=992,_=768,I=991,A=767,R=320,G=425,L=function(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},B=L(),P={width:B.width,height:B.height},F=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state=P,e.render=function(){var t=e.props,a=t.children,n=t.displayIn,s=e.state,c=s.width,i=s.height,o=e.shouldRender(n,c,i);return r.a.createElement(r.a.Fragment,null,o?a:null)},e.handleResize=function(){var t=L(),a=t.width,n=t.height;e.setState({width:a,height:n})},e.shouldRender=function(e,t,a){return-1!==e.indexOf("Laptop")&&t>=D||(-1!==e.indexOf("Tablet")&&t<=I&&t>=_||(-1!==e.indexOf("Mobile")&&t<=A||(-1!==e.indexOf("MobilePortrait")&&t<=A&&a>=G||!!(-1!==e.indexOf("MobileLandScape")&&t<=A&&a<=R))))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize,!1)}}]),a}(r.a.PureComponent),z=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){"function"===typeof this.props.didMount&&this.props.didMount()}},{key:"componentDidUpdate",value:function(e,t,a){"function"===typeof this.props.didUpdate&&this.props.didUpdate()}},{key:"render",value:function(){return this.props.children?this.props.children:null}}]),a}(n.Component),H=(a(145),0),V=1,J=2,W=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.props.location.pathname;return o.a.createElement(z,null,o.a.createElement(F,{displayIn:["Mobile"]},o.a.createElement("div",{className:"float-left left"},o.a.createElement("i",{id:"btnBackToChatList",className:"fas fa-arrow-left fa-2x d-block d-md-none",onClick:function(){e.props.history.goBack()}}),e.global.newMessages>0?o.a.createElement("div",{className:"btnBack-number"},e.global.newMessages):null)),function(){switch(e.global.infoHeaderCenter){case V:return o.a.createElement(q,null,o.a.createElement("h3",{id:"chat-info-name"},e.global.ihcData.name),o.a.createElement(u.b,{to:t+"/userInfo/"+e.global.ihcData.uid},o.a.createElement("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})));case J:return o.a.createElement(q,null,o.a.createElement("h3",{id:"chat-info-name"},e.global.ihcData.name),o.a.createElement(u.b,{to:"/chat/groupInfo/"+e.global.ihcData.gcid},o.a.createElement("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})));default:return o.a.createElement(F,{displayIn:["Laptop","Tablet"]},o.a.createElement("h3",{className:"pt-2 pl-2"},"chat"))}}())}}]),a}(i.Component),Y=Object(l.j)(W);function q(e){return o.a.createElement("div",{id:"chat-info",className:"center pt-2"},e.children)}var $=a(116),K=(a(146),a(147),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).clickCheckBox=function(e){n.state.checkBoxClicked?e.stopPropagation():setTimeout((function(){n.setState((function(e){return{checkBoxClicked:!0}}))}),20)},n.clickDocument=function(e){n.state.checkBoxClicked&&n.changeChecked(e)},n.changeChecked=function(e){n.setState((function(e){return{checkBoxClicked:!e.checkBoxClicked}}))},n.logout=function(){n.dispatch.deleteAuthTokens()},n.state={checkBoxClicked:!1},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return o.a.createElement("div",{className:"c-header"},o.a.createElement(Y,null),o.a.createElement("div",{id:"top-right",className:"right",onClick:this.clickCheckBox},o.a.createElement("div",{className:"right-l"}),o.a.createElement("input",{type:"checkbox",id:"btnControlTopRight",className:"btnControl",checked:this.state.checkBoxClicked,onChange:this.changeChecked}),o.a.createElement("label",{htmlFor:"btnControlTopRight"},o.a.createElement("div",{className:"right-c"},o.a.createElement("div",{className:"d-only-when-small"},o.a.createElement("i",{id:"user-info",className:"fas fa-user fa-2x user-icon","data-toggle":"tooltip",title:"Benutzer-Info"})),o.a.createElement("div",{className:"d-only-when-big top-2right"},o.a.createElement(u.b,{to:e+"/userInfo/"+this.global.userSelf.uid},o.a.createElement(Q,{text:"Benutzer-Info"},o.a.createElement("h4",{id:"username",className:"p-2 username"},this.global.userSelf.username))),o.a.createElement("div",{className:"float-right"},o.a.createElement(u.b,{to:e+"/settings"},o.a.createElement(Q,{text:"Einstellungen"},o.a.createElement("i",{className:"fas fa-user-cog fa-2x"}))),"\xa0",o.a.createElement(Q,{text:"logout"},o.a.createElement("i",{id:"user-logout",className:"fas fa-sign-out-alt fa-2x logout",onClick:this.logout}))))))))}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.clickDocument,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.clickDocument,!1)}}]),a}(i.Component));function Q(e){return o.a.createElement($.a,{placement:"bottom",trigger:["hover"],overlay:o.a.createElement("span",null,e.text)},e.children)}var X=Object(l.j)(K),Z=(a(148),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).searchChanged=function(t){e.props.onSearch(t.target.value)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return r.a.createElement("div",{className:"chatSearchBox"},r.a.createElement("div",{className:"chat-select-form"},r.a.createElement("input",{type:"text",name:"chat-search",className:"chat-search",placeholder:"Chat suchen",onChange:this.searchChanged}),r.a.createElement(u.b,{to:e+"/newChat"},r.a.createElement("button",{id:"btn-newChat",className:"btn-newChat"},r.a.createElement("i",{className:"fas fa-plus fa-lg"})))))}}]),a}(n.Component)),ee=Object(l.j)(Z),te=a(110),ae=a.n(te),ne={names:{aqua:"#00ffff",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0"},random:function(){var e,t=0;for(var a in this.names)Math.random()<1/++t&&(e=a);return e}},re=ne,se=a(119),ce=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"getIndex",value:function(e){for(var t=0,a=this.length-1;t<=a;){var n=Math.floor((t+a)/2);if(this[n].key===e)return n;this[n].key<e?t=n+1:a=n-1}return-1}},{key:"getNearestKey",value:function(e){var t;for(++e;-1===(t=this.getIndex(--e));)if(0===e)return-1;return t}},{key:"get",value:function(e){var t=this.getIndex(e);if(-1!==t)return this[t].value}},{key:"add",value:function(e,t){-1===this.getIndex(e)&&this.splice(this.getNearestKey(e)+1,0,{key:e,value:t})}},{key:"remove",value:function(e){var t=this.getIndex(e);-1!==t&&this.splice(t,1)}}]),a}(Object(se.a)(Array)),ie=a(22);function oe(e,t,a){return ue.apply(this,arguments)}function ue(){return(ue=Object(w.a)(k.a.mark((function e(t,a,n){var r,s,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||Object(i.getGlobal)().authTokens,s=Object(ie.a)(Object(ie.a)({},a),{},{method:a.method,headers:Object(ie.a)(Object(ie.a)({},a.headers),{},{Authorization:r})}),e.next=4,fetch(t,s);case 4:if(401!==(c=e.sent).status){e.next=8;break}throw Object(i.getDispatch)().deleteAuthTokens(),new Error("jwt expired");case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return he.apply(this,arguments)}function he(){return(he=Object(w.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,oe("/chats",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){return me.apply(this,arguments)}function me(){return(me=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/user/chat",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{Accept:"application/json"}},e.next=3,oe("/user/"+t,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/message/load",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var be=0,ye=1,Ee=2,ke=3,we=4,Ce=5,je=6;function Oe(){return(Oe=Object(w.a)(k.a.mark((function e(t){var a,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===Ye.users.getIndex(t)){e.next=10;break}if(0===Ye.users.get(t).normalChat){e.next=5;break}return e.abrupt("return",be);case 5:return a=Ye.users.get(t),Ye.temporaryChat.createNew(t,a.username),e.abrupt("return",Ee);case 8:e.next=40;break;case 10:if(!Ye.temporaryChat.doesExist(t)){e.next=14;break}return e.abrupt("return",Ee);case 14:return e.prev=14,e.next=17,de(t);case 17:if(!(n=e.sent).ok){e.next=34;break}return e.next=21,n.json();case 21:if(!(r=e.sent).userExists||r.blocked){e.next=27;break}return Ye.temporaryChat.createNew(t,r.username),e.abrupt("return",Ee);case 27:if(r.userExists){e.next=31;break}return e.abrupt("return",ke);case 31:return e.abrupt("return",we);case 32:e.next=35;break;case 34:return e.abrupt("return",je);case 35:e.next=40;break;case 37:return e.prev=37,e.t0=e.catch(14),e.abrupt("return",je);case 40:case"end":return e.stop()}}),e,null,[[14,37]])})))).apply(this,arguments)}var Ne=function(){function e(t,a){Object(p.a)(this,e),this._normalChat=0,this._groupChats=new ce,this.uid=t,this.username=a,this.color=re.random()}return Object(m.a)(e,[{key:"addGroupChat",value:function(e){this.groupChats.add(e,e)}},{key:"removeGroupChat",value:function(e){this.groupChats.remove(e)}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"normalChat",get:function(){return this._normalChat},set:function(e){this._normalChat=e}},{key:"groupChats",get:function(){return this._groupChats},set:function(e){this._groupChats=e}}]),e}(),xe={};function Se(){return Te.apply(this,arguments)}function Te(){return(Te=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/data.json",t);case 3:if(!(a=e.sent).ok){e.next=10;break}return e.next=7,a.json();case 7:xe=e.sent,e.next=11;break;case 10:throw new Error;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e){var t=e.msg;return r.a.createElement("div",{className:(t.bySelf?"self ":"other ")+"msg-container"},t.userTop?r.a.createElement("div",{className:"w-100"},r.a.createElement("strong",{className:"header"},r.a.createElement(Ie,{user:t.userTop}))):null,r.a.createElement("div",{className:"content"},r.a.createElement("p",null,t.content.text)),r.a.createElement("div",{className:"date-outer"},r.a.createElement("div",{className:"date"},t.mDateString)))}function Ue(e){var t=e.msg;return r.a.createElement("div",{className:(t.bySelf?"self ":"other ")+"msg-container"},r.a.createElement(De,{msg:t}),r.a.createElement("div",{className:"date-outer"},r.a.createElement("div",{className:"date"},t.mDateString)))}function De(e){var t=e.msg;return r.a.createElement(z,null,Le(t,!0))}a(179);function _e(e){var t=e.msg;switch(t.type){case xe.messageTypes.normalMessage:return r.a.createElement(Me,{msg:t});case xe.messageTypes.statusMessage:return r.a.createElement(Ue,{msg:t});default:return r.a.createElement("span",null)}}function Ie(e){return r.a.createElement("span",{style:{color:re.names[e.user.color]}},e.user.username)}var Ae=0,Re=1,Ge=["den chat erstellt","hinzugef\xfcgt","entfernt","dem chat beigetreten","den chat verlassen","zum Admin gemacht","nicht mehr Admin"];function Le(e,t){return function(){var t=e.userTop,n=e.content.passiveUsers;switch(e.content.type){case xe.statusMessageTypes.chatCreated:return a(t,Ae,n,xe.statusMessageTypes.chatCreated);case xe.statusMessageTypes.usersAdded:return a(t,Ae,n,xe.statusMessageTypes.usersAdded);case xe.statusMessageTypes.usersRemoved:return a(t,Ae,n,xe.statusMessageTypes.usersRemoved);case xe.statusMessageTypes.usersJoined:return a(t,Re,[],xe.statusMessageTypes.usersJoined);case xe.statusMessageTypes.usersLeft:return a(t,Ae,[],xe.statusMessageTypes.usersLeft);case xe.statusMessageTypes.usersMadeAdmin:return a(t,Ae,n,xe.statusMessageTypes.usersMadeAdmin);case xe.statusMessageTypes.usersRemovedAdmin:return a(t,Re,[],xe.statusMessageTypes.usersRemovedAdmin)}}();function a(a,n,s,c){function i(){switch(n){case Ae:return e.bySelf?" hast ":" hat ";case Re:return" ist"}}function o(){if(s.length<1)return"";if(1===s.length){var e=Ye.users.get(s[0]);return e?t?r.a.createElement(Ie,{user:e}):e.username:"1 Benutzer"}return s.length+" Benutzer"}function u(){return" "+Ge[c]}return t?r.a.createElement("span",null,r.a.createElement(Ie,{user:e.userTop}),i(),o(),u()):e.userTop.username+i()+o()+u()}}var Be=function(){function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date(Date.now()),s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;Object(p.a)(this,e),this.mid=t,this.uid=a,this.date=r,this.chat=n,this.type=s,this.content=c}return Object(m.a)(e,[{key:"getMessageObject",value:function(e){var t={mDateString:this.getMessageViewDateString(),dateString:this.getDateString(),date:this.date,bySelf:this.uid===Ye.userSelf.uid,type:this.type,content:this.content};return e&&(t.userTop=this.getUserTop()),t}},{key:"getUserTop",value:function(){if(this.isBySelf())return{uid:this.uid,username:"Du",color:Ye.userSelf.color};var e=Ye.users.get(this.uid);return{uid:this.uid,username:e.username,color:e.color}}},{key:"isBySelf",value:function(){return this.uid===Ye.userSelf.uid}},{key:"getChatViewDateString",value:function(){return this.isDateToday()?"heute "+this.getTimeString():this.isDateYesterday()?"gestern":this.getDateString()}},{key:"getChatViewMsgString",value:function(){switch(this.type){case xe.messageTypes.normalMessage:var e=this.content.text;return e.length>18&&(e=e.substr(0,18)+"..."),this.uid===Ye.userSelf.uid?"Du: ".concat(e):"normalchat"===this.chat.type?this.content.text:"".concat(Ye.users.get(this.uid).username,": ").concat(e);case xe.messageTypes.statusMessage:return Le(this.getMessageObject(!0),!1)}}},{key:"getMessageViewDateString",value:function(){return this.isDateToday()?this.getTimeString():this.isDateYesterday()?"gestern "+this.getTimeString():this.getDateString()+" "+this.getTimeString()}},{key:"isDateToday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"isDateYesterday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()-1&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"getDateString",value:function(){var e,t=this.date.getDate();e=t<10?"0"+t:t;var a,n=this.date.getMonth();a=n+1<10?"0"+(n+1):n+1;var r=this.date.getFullYear();return"".concat(e,".").concat(a,".").concat(r)}},{key:"getTimeString",value:function(){var e,t=this.date.getHours();e=t<10?"0"+t:t;var a,n=this.date.getMinutes();return a=n<10?"0"+n:n,"".concat(e,":").concat(a)}},{key:"isDifferentDay",value:function(e){return this.date.getDay()!==e.getDay()||this.date.getMonth()!==e.getMonth()||this.date.getFullYear()!==e.getFullYear()}},{key:"mid",get:function(){return this._mid},set:function(e){this._mid=e}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"date",get:function(){return this._date},set:function(e){this._date=e}},{key:"chat",get:function(){return this._chat},set:function(e){this._chat=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"content",get:function(){return this._content},set:function(e){this._content=e}}]),e}(),Pe=function(){function e(){Object(p.a)(this,e),this.events=new Map}return Object(m.a)(e,[{key:"on",value:function(e,t){this.events.has(e)?this.events.get(e).push(t):this.events.set(e,[t])}},{key:"rm",value:function(e,t){if(this.events.has(e))for(var a=this.events.get(e),n=0;n<a.length;n++)a[n]===t&&a.splice(n,1)}},{key:"trigger",value:function(e){if(this.events.has(e)){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];for(var r=0;r<this.events.get(e).length;r++){var s;(s=this.events.get(e))[r].apply(s,a)}}}},{key:"events",get:function(){return this._events},set:function(e){this._events=e}}]),e}(),Fe=function(){function e(t,a,n){Object(p.a)(this,e),this._messages=new ce,this._event=new Pe,this._unreadMessages=0,this._reachedTopMessages=!1,this.type=t,this.id=a,this.chatName=n}return Object(m.a)(e,[{key:"initFirstMessage",value:function(e){e.empty||this.messages.add(e.mid,new Be(e.mid,e.uid,this,new Date(e.date),e.type,e.content))}},{key:"loadMessages",value:function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n,r,s,c,i,o,u,l,h=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reachedTopMessages){e.next=16;break}return a=function(){var e=h.getLastMessage();return null!==e?e.mid:-1},e.next=4,ge({chatType:this.type,chatId:this.id,lastMsgId:a(),num:t});case 4:if(!(n=e.sent).ok){e.next=15;break}return e.next=8,n.json();case 8:for(r=e.sent,this.reachedTopMessages="reached top"===r.status,s=r.messages,c=new Array(s.length),i=this.showUserInfoMessage(),o=s.length-1;o>=0;o--)u=s[o],l=new Be(u.mid,u.uid,this,new Date(u.date),u.type,u.content),this.messages.add(u.mid,l),c[o]=l.getMessageObject(i);return e.abrupt("return",c);case 15:throw new Error;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLastMessage",value:function(){return 0!==this.messages.length?this.messages[0].value:null}},{key:"getFirstMessage",value:function(){return 0!==this.messages.length?this.messages[this.messages.length-1].value:null}},{key:"getMessages",value:function(){for(var e=this.showUserInfoMessage(),t=new Array(this.messages.length),a=0;a<this.messages.length;a++){var n=this.messages[a].value;t[a]=n.getMessageObject(e)}return t}},{key:"addMessage",value:function(e,t,a,n){var r=new Be(t,e,this,new Date(Date.now()),a,n);this.messages.add(t,r),Object(i.getDispatch)().newMsg(this,this.unreadMessages,r.getMessageObject(this.showUserInfoMessage()))}},{key:"showUserInfoMessage",value:function(){return"groupChat"===this.type}},{key:"getChatObject",value:function(){return{type:this.type,id:this.id,chatName:this.chatName,latestMessage:this.getLatestMessageObject(),unreadMessages:this.unreadMessages}}},{key:"getLatestMessageObject",value:function(){if(0===this.messages.length)return null;var e=this.getFirstMessage();return{msgString:e.getChatViewMsgString(),dateString:e.getChatViewDateString(),date:e.date}}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"chatName",get:function(){return this._chatName},set:function(e){this._chatName=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"unreadMessages",get:function(){return this._unreadMessages},set:function(e){this._unreadMessages=e}},{key:"reachedTopMessages",get:function(){return this._reachedTopMessages},set:function(e){this._reachedTopMessages=e}}]),e}(),ze=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e,n,r){var s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(p.a)(this,a),(s=t.call(this,"normalChat",e,n))._isTyping=!1,s.otherUser=r,s.unreadMessages=c,s}return Object(m.a)(a,[{key:"getUsersTyping",value:function(){if(this.isTyping){var e=Ye.users.get(this.otherUser);return[{uid:e.uid,username:e.username}]}return[]}},{key:"getLatestUserTyping",value:function(){if(this.isTyping){var e=Ye.users.get(this.otherUser);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!0,this.event.trigger("typeState changed"))}},{key:"stoppedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!1,this.event.trigger("typeState changed"))}},{key:"otherUser",get:function(){return this._otherUser},set:function(e){this._otherUser=e}},{key:"isTyping",get:function(){return this._isTyping},set:function(e){this._isTyping=e}}]),a}(Fe),He=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e,n,r){var s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(p.a)(this,a),(s=t.call(this,"groupChat",e,n))._users=[],s._usersTyping=[],s.users=r,s.unreadMessages=c,s}return Object(m.a)(a,[{key:"getUsersTyping",value:function(){if(this.usersTyping.length>0){for(var e=[],t=0;t<this.usersTyping.length;t++){var a=Ye.users.get(this.usersTyping[t]);e.push({uid:a.uid,username:a.username})}return e}return[]}},{key:"getLatestUserTyping",value:function(){if(this.usersTyping.length>0){var e=Ye.users.get(this.usersTyping[this.usersTyping.length-1]);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){this.isMember(e)&&(this.isTyping(e)||(this.usersTyping.push(e),this.event.trigger("typeState changed")))}},{key:"stoppedTyping",value:function(e){this.isMember(e)&&this.isTyping(e)&&(this.usersTyping.splice(this.getIndexOfTyping(e),1),this.event.trigger("typeState changed"))}},{key:"isMember",value:function(e){return e!==Ye.userSelf.uid&&this.users.find((function(t){return t===e}))}},{key:"isTyping",value:function(e){return this.usersTyping.find((function(t){return t===e}))}},{key:"getIndexOfTyping",value:function(e){return this.usersTyping.findIndex((function(t){return t===e}))}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"usersTyping",get:function(){return this._usersTyping},set:function(e){this._usersTyping=e}}]),a}(Fe),Ve=function(){function e(){Object(p.a)(this,e),this._isShown=!1}return Object(m.a)(e,[{key:"createNew",value:function(e,t){this.chatNow=new ze(0,t,e)}},{key:"doesExist",value:function(e){return void 0!==this.chatNow&&this.chatNow.otherUser===e}},{key:"show",value:function(){this.isShown=!0,Object(i.getDispatch)().showTempChat(this.chatNow)}},{key:"update",value:function(){Object(i.getDispatch)().updateTempChat(this.chatNow)}},{key:"hide",value:function(){this.isShown=!1,Object(i.getDispatch)().hideTempChat()}},{key:"createNewNormalChat",value:function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n,r,s,c,o,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.chatNow.otherUser,n=this.chatNow.chatName,e.next=4,pe({uid:a,username:n,message:{type:xe.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}}});case 4:if(!(r=e.sent).ok){e.next=20;break}return e.next=8,r.json();case 8:return s=e.sent,-1===Ye.users.getIndex(a)&&Ye.users.add(a,new Ne(a,n)),c=Ye.users.get(a),o=new ze(s.ncid,n,a),c.normalChat=o.id,Ye.chats.normal.add(s.ncid,o),u=new Be(s.mid,Ye.userSelf.uid,o,new Date(Date.now()),xe.messageTypes.normalMessage,{text:t,mentions:[],media:[]}),o.messages.add(u.mid,u),Object(i.getDispatch)().addChat(o),Object(i.getDispatch)().selectChat(o),this.hide(),e.abrupt("return",!0);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isShown",get:function(){return this._isShown},set:function(e){this._isShown=e}},{key:"chatNow",get:function(){return this._chatNow},set:function(e){this._chatNow=e}}]),e}(),Je=function(){function e(){Object(p.a)(this,e),this._userSelf={uid:0,username:""},this._users=new ce,this._chats={normal:new ce,group:new ce},this._event=new Pe,this._finishedLoading=!1,this._temporaryChat=new Ve,this._initCalled=!1}return Object(m.a)(e,[{key:"destruct",value:function(){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect()),this.initCalled=!1}},{key:"init",value:function(){var e=Object(w.a)(k.a.mark((function e(){var t,a,n,r=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(i.getGlobal)().userSelf,a=t.uid,n=t.username,this.userSelf=new Ne(a,n),this.userInfo={uid:a,username:n},this.initCalled=!0,this.userSelf=new Ne(a,n),this.userInfo={uid:a,username:n},this.socket=ae.a.connect("/",{secure:!0}),this.socket.emit("auth",Object(i.getGlobal)().authTokens),this.socket.on("initialized",(function(){r.initChats()})),this.socket.on("chat message",(function(e){var t=r.getChat(e.chat.type,e.chat.id);if(null!==t){var a=r.isCurrentChat(t.type,t.id);t.addMessage(e.uid,e.mid,e.type,e.content),t.hasNewMsg=!a,t.unreadMessages++,r.event.trigger("new message",e.chat.type,e.chat.id)}})),this.socket.on("started typing",(function(e){r.getChat(e.chat.type,e.chat.id).startedTyping(e.uid)})),this.socket.on("stopped typing",(function(e){r.getChat(e.chat.type,e.chat.id).stoppedTyping(e.uid)})),this.socket.on("users-noChat",(function(e){We.event.trigger("users-noChat",e)})),this.socket.on("new chat",(function(e){r.addNewChat(e)})),this.socket.on("disconnect",(function(){setTimeout((function(){alert("Verbindung verloren! Seite wird neu geladen"),location.reload()}),1e3)}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initChats",value:function(){var e=Object(w.a)(k.a.mark((function e(){var t,a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le();case 2:if(200!==(t=e.sent).status){e.next=8;break}return e.next=6,t.json();case 6:for(a=e.sent,n=0;n<a.length;n++)"normalChat"===a[n].type?this.addNewNormalChat(a[n]):"groupChat"===a[n].type&&this.addNewGroupChat(a[n]);case 8:this.finishedLoading=!0,this.event.trigger("chats loaded",this.getChatArraySortedByDate());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChatArraySortedByDate",value:function(){function e(e){var t=e.latestMessage;return null!==t?t.date.getTime():new Date(0).getTime()}function t(t,a){for(var n=a,r=a+1;r<t.length;r++)e(t[n])<e(t[r])&&(n=r);return n}function a(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function n(e){for(var n=function(e){for(var t=new Array(e.length),a=0;a<e.length;a++){var n=e[a].value;t[a]=n.getChatObject()}return t}(e),r=0;r<n.length-1;r++){a(n,r,t(n,r))}return n}return function(t,a){for(var n=new Array(t.length+a.length),r=0,s=0,c=0;c<n.length;c++)s<a.length?r<t.length&&e(t[r])>e(a[s])?(n[c]=t[r],r++):(n[c]=a[s],s++):(n[c]=t[r],r++);return n}(n(this.chats.normal),n(this.chats.group))}},{key:"isCurrentChat",value:function(e,t){var a=Object(i.getGlobal)().currentChat;return a.type===e&&a.id===t}},{key:"getChat",value:function(e,t){return"normalChat"===e?this.chats.normal.get(t):"tempChat"===e?this.temporaryChat.chatNow:"groupChat"===e?this.chats.group.get(t):void 0}},{key:"addNewChat",value:function(e){var t;"normalChat"===e.type?t=this.addNewNormalChat(e):"groupChat"===e.type&&(t=this.addNewGroupChat(e)),t.unreadMessages=1,Object(i.getDispatch)().addChat(t)}},{key:"addNewNormalChat",value:function(e){var t;-1===this.users.getIndex(e.members[0].uid)?(t=new Ne(e.members[0].uid,e.members[0].username),this.users.add(t.uid,t)):t=this.users.get(e.members[0].uid);var a=new ze(e.id,e.chatName,t.uid,e.unreadMessages);return t.normalChat=a.id,a.initFirstMessage(e.firstMessage),this.chats.normal.add(e.id,a),a}},{key:"addNewGroupChat",value:function(e){for(var t=[],a=0;a<e.members.length;a++){var n=e.members[a],r=void 0;-1===this.users.getIndex(n.uid)?(r=new Ne(n.uid,n.username),this.users.add(r.uid,r)):r=this.users.get(n.uid),t.push(r.uid),r.addGroupChat(e.id)}var s=new He(e.id,e.chatName,t,e.unreadMessages);return s.initFirstMessage(e.firstMessage),this.chats.group.add(e.id,s),s}},{key:"socket",get:function(){return this._socket},set:function(e){this._socket=e}},{key:"userSelf",get:function(){return this._userSelf},set:function(e){this._userSelf=e}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"chats",get:function(){return this._chats},set:function(e){this._chats=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"finishedLoading",get:function(){return this._finishedLoading},set:function(e){this._finishedLoading=e}},{key:"temporaryChat",get:function(){return this._temporaryChat},set:function(e){this._temporaryChat=e}},{key:"initCalled",get:function(){return this._initCalled},set:function(e){this._initCalled=e}}]),e}(),We=new Je;var Ye=We,qe=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).isSelected=function(){return n.props.id===n.global.currentChat.id&&n.props.type===n.global.currentChat.type},n.typeStateChanged=function(){var e="",t=Ye.getChat(n.props.type,n.props.id).getLatestUserTyping();null!==t&&(e=t.username+" schreibt..."),n.setState({typeMsg:e})},n.state={lastMsg:void 0,typeMsg:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=function(){return e.props.latestMessage?o.a.createElement("span",null,e.props.latestMessage.msgString):o.a.createElement("span",null,"Noch keine Nachrichten vorhanden")},a=function(){return e.props.latestMessage?o.a.createElement("div",{className:"lastMsg-date"},e.props.latestMessage.dateString):null};return o.a.createElement("li",{className:"chat-item"+(this.isSelected()?"selected ":"")},o.a.createElement(u.b,{to:"normalChat"===e.props.type?"/chat/user/"+Ye.getChat("normalChat",e.props.id).otherUser:"groupChat"===e.props.type?"/chat/group/"+e.props.id:"tempChat"===e.props.type?"/chat/user/"+Ye.temporaryChat.chatNow.otherUser:void 0},o.a.createElement("div",{className:"w-100"},o.a.createElement("strong",null,this.props.name),0===e.props.unreadMessages?null:o.a.createElement("div",{className:"newMsg-number"},e.props.unreadMessages)),""===e.state.typeMsg?o.a.createElement("div",{className:"w-100 lastMsg"},t(),a()):o.a.createElement("div",{className:"w-100 typeMsg"},e.state.typeMsg)))}},{key:"componentDidMount",value:function(){Ye.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,a){e.type===this.props.type&&e.id===this.props.id||(Ye.getChat(e.type,e.id).event.rm("typeState changed",this.typeStateChanged),Ye.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged),this.setState({typeMsg:""}))}},{key:"componentWillUnmount",value:function(){Ye.getChat(this.props.type,this.props.id).event.rm("typeState changed",this.typeStateChanged)}}]),a}(i.Component),$e=(a(180),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={searchValue:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=0;return o.a.createElement(z,null,o.a.createElement(ee,{onSearch:function(t){e.setState({searchValue:t})}}),o.a.createElement("ul",{className:"chat-list"},e.global.tempChat?o.a.createElement(qe,{key:-1,id:0,type:"tempChat",name:e.global.tempChat.chatName,unreadMessages:0,latestMessage:null}):null,this.global.chats.map((function(a,n){return a.chatName.includes(e.state.searchValue)?(t++,o.a.createElement(qe,{key:n,id:a.id,type:a.type,name:a.chatName,unreadMessages:a.unreadMessages,latestMessage:a.latestMessage})):null}))),0===t?o.a.createElement("span",null,"Nichts gefunden"):null)}}]),a}(i.Component));a(181);function Ke(e){return r.a.createElement("div",{className:"loader-init"},r.a.createElement("div",{className:"col-sm-12 my-auto"},r.a.createElement("div",{className:"init-container border rounded"},r.a.createElement("div",{className:"spinner-border text-secondary",style:{width:"15rem",height:"15rem",borderWidth:"0.5rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("div",{className:"loader-text"},e.msg))))}var Qe=a(55),Xe=(a(182),a(117));function Ze(e){return et.apply(this,arguments)}function et(){return(et=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{Accept:"application/json"}},e.next=3,oe("/group/"+t+"/",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(e){return at.apply(this,arguments)}function at(){return(at=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/message",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(184);var nt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e))._userTyping=!1,n._typeEventEmitted=!1,n.onTyping=function(e){n.setState({message:e.target.value}),n.handleTypeMessage()},n.handleTypeMessage=function(){n.isTempChat||(n.userTyping&&clearTimeout(n.typeTimeout),n.userTyping=!0,n.typeEventEmitted||(n.typeEventEmitted=!0,Ye.socket.emit("started typing")),n.typeTimeout=setTimeout((function(){n.userTyping=!1,n.typeEventEmitted&&(n.typeEventEmitted=!1,Ye.socket.emit("stopped typing"))}),1e3))},n.onSubmit=function(e){if(e.preventDefault(),""!==n.state.message){var t=n.state.message;if(n.setState({message:""}),n.isTempChat){var a=n.props.location.pathname;Ye.temporaryChat.createNewNormalChat(t).then((function(e){e&&(n.props.history.replace("/chat"),n.props.history.replace(a))}))}else n.sendMessage(t).then((function(e){Ye.getChat(n.props.chatType,n.props.chatId).addMessage(Ye.userSelf.uid,e,xe.messageTypes.normalMessage,{text:t,mentions:[],media:[]})})).catch((function(e){}))}},n.sendMessage=function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt({type:xe.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}});case 2:if(!(a=e.sent).ok){e.next=8;break}return e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.mid);case 8:return e.abrupt("return",new Error);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onEmojiInput=function(e){n.setState({message:n.state.message+e.native}),n.handleTypeMessage()},n.toggleEmoji=function(e){n.setState((function(e){return{showEmoji:!e.showEmoji}}))},n.state={message:"",showEmoji:!1},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(z,null,r.a.createElement("form",{onSubmit:this.onSubmit,className:"msg-form"},r.a.createElement("div",{className:"message-input"},r.a.createElement("input",{autoComplete:"off",placeholder:"Nachricht:",value:this.state.message,onChange:this.onTyping}),r.a.createElement("i",{className:"far fa-smile fa-2x emoji-toggle",onClick:this.toggleEmoji})),r.a.createElement("button",{className:"btn-submit",type:"submit"},r.a.createElement("i",{className:"far fa-paper-plane fa-2x","data-toggle":"tooltip",title:"send message"}))),this.state.showEmoji?r.a.createElement("div",{style:{position:"absolute",bottom:"60px",right:"50px",width:"350px",height:"425px"}},r.a.createElement(Xe.a,{onSelect:this.onEmojiInput})):null)}},{key:"componentDidMount",value:function(){this.isTempChat="tempChat"===this.props.chatType}},{key:"componentDidUpdate",value:function(e,t,a){this.isTempChat="tempChat"===this.props.chatType}},{key:"userTyping",get:function(){return this._userTyping},set:function(e){this._userTyping=e}},{key:"typeEventEmitted",get:function(){return this._typeEventEmitted},set:function(e){this._typeEventEmitted=e}},{key:"typeTimeout",get:function(){return this._typeTimeout},set:function(e){this._typeTimeout=e}},{key:"isTempChat",get:function(){return this._isTempChat},set:function(e){this._isTempChat=e}}]),a}(n.Component),rt=Object(l.j)(nt),st=(a(185),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.scrollHandler=function(e){n.setState({scrollToBottom:n.getScrollToBottom()}),0===n.messagesNode.scrollTop&&n.loadMessages()},n.setScrollToBottom=function(e){n.messagesNode.scrollTop=n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-e},n.getScrollToBottom=function(){return n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-n.messagesNode.scrollTop},n.assignMessagesRef=function(e){n.messages=e},n.loadMessages=function(){var e=Ye.getChat(n.global.currentChat.type,n.global.currentChat.id);e.reachedTopMessages||n.setState({msgLoading:!0}),e.loadMessages(10).then((function(e){n.dispatch.addLoadedMessages(e),n.setState((function(e){return{msgLoading:!1}})),n.setScrollToBottom(n.state.scrollToBottom)})).catch((function(e){return n.setState({msgLoading:!1})}))},n.chatChanged=function(){0===n.messagesNode.scrollTop&&n.loadMessages()},n.assignMessagesRef=n.assignMessagesRef.bind(Object(Qe.a)(n)),n.state={msgLoading:!1,scrollToBottom:0,messages:[],typeMessages:[]},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.messagesNode=c.a.findDOMNode(this.messages),this.chatChanged(),this.isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,a){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(this.setScrollToBottom(0),this.chatChanged()),0===this.state.scrollToBottom&&(this.setScrollToBottom(0),this.global.currentChat.newMessages>0&&this.setGlobal((function(e){return{currentChat:Object(ie.a)(Object(ie.a)({},e.currentChat),{},{newMessages:0})}})))}},{key:"render",value:function(){var e=this,t=new Date(0);return o.a.createElement("div",{className:"chat-container"},o.a.createElement("div",{className:"messages",onScroll:this.scrollHandler,ref:this.assignMessagesRef},e.state.msgLoading?o.a.createElement("div",{className:"messageLoader-top"},o.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading..."))):null,this.global.currentChat.messages.map((function(e,a){return o.a.createElement("div",{key:a},function(e){return a=e.date,n=t,a.getDay()!==n.getDay()||a.getMonth()!==n.getMonth()||a.getFullYear()!==n.getFullYear()?(t=e.date,o.a.createElement("div",{className:"date-container"},o.a.createElement("div",null,e.dateString))):(t=e.date,null);var a,n}(e),o.a.createElement(_e,{msg:e}))})),0===e.global.currentChat.messages.length?o.a.createElement("div",{className:"alert alert-primary",role:"alert"},"Noch keine Nachrichten vorhanden"):null,e.isMounted&&e.getScrollToBottom()>10?o.a.createElement("div",{id:"messages-bottom",className:"messages-bottom",onClick:function(){e.setState({scrollToBottom:0})}},o.a.createElement("div",{id:"btnToBottom",className:"chevron-down"},o.a.createElement("i",{className:"fas fa-chevron-down fa-2x"})),e.global.currentChat.newMessages>0?o.a.createElement("div",{id:"scroll-down-number",className:"number"},e.global.currentChat.newMessages):null):null),o.a.createElement(rt,{chatType:this.props.chatType,chatId:this.props.chatId}))}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"isMounted",get:function(){return this._isMounted},set:function(e){this._isMounted=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"messagesNode",get:function(){return this._messagesNode},set:function(e){this._messagesNode=e}}]),a}(i.Component)),ct=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"chat-container"},r.a.createElement("div",{className:"messages"},r.a.createElement("div",{className:"alert alert-primary",role:"alert"},"Noch keine Nachrichten vorhanden")),r.a.createElement(rt,{chatType:"tempChat",chatId:0}))}},{key:"componentDidMount",value:function(){Ye.temporaryChat.show()}},{key:"componentDidUpdate",value:function(e,t,a){e.uid!==this.props.uid&&Ye.temporaryChat.update()}},{key:"componentWillUnmount",value:function(){Ye.temporaryChat.hide()}}]),a}(n.Component);function it(){return r.a.createElement("div",null,r.a.createElement("h2",null,"ung\xfcltige Addresse"))}function ot(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du kannst dir selbst nicht schreiben"))}function ut(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser User hat dich blockiert"))}function lt(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser User existiert nicht"))}function ht(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du bist nicht Mitglied in diesem chat jetzt beitreten"))}function pt(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Du bist nicht dazu berechtigt diesen chat anzusehen"))}function mt(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Dieser Chat existiert nicht"))}function dt(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Fehler"))}var ft=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).userChanged=function(){var e=parseInt(n.props.uid);if(n.global.userSelf.uid===e)n.setState({error:Ce,loaded:!0});else{var t=function(){(function(e){return Oe.apply(this,arguments)})(e).then((function(t){t===be?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:V,ihcData:{name:Ye.users.get(e).username,uid:e}}).then(),n.selectNormalChat(e)):t===Ee?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:V,ihcData:{name:Ye.temporaryChat.chatNow.chatName,uid:e}}).then(),n.selectTempChat()):n.setState({error:je}),n.setState({loaded:!0})})).catch((function(e){return n.setState({error:je})}))};Ye.finishedLoading?t():Ye.event.on("chats loaded",(function(){t()})),n.setState({uid:parseInt(n.props.uid)})}},n.state={uid:0,loaded:!1,error:be},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"h-100"},function(){if(!e.state.loaded)return o.a.createElement(Ke,{msg:"Chat wird geladen"})}(),e.state.error===ye?o.a.createElement(it,null):e.state.error===Ce?o.a.createElement(ot,null):e.state.loaded?e.state.error===be?o.a.createElement(st,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id}):e.state.error===Ee?o.a.createElement(ct,{uid:e.state.uid}):e.state.error===we?o.a.createElement(ut,null):o.a.createElement(lt,null):void 0)}},{key:"componentDidMount",value:function(){this.userChanged()}},{key:"componentDidUpdate",value:function(e,t,a){e.uid!==this.props.uid&&(isNaN(this.props.uid)?this.setState({error:ye}):this.userChanged())}},{key:"selectTempChat",value:function(){this.dispatch.showTempChat()}},{key:"selectNormalChat",value:function(e){if(-1===Ye.users.getIndex(e))this.setState({error:ke});else{var t=Ye.users.get(e).normalChat,a=Ye.getChat("normalChat",t);this.dispatch.selectChat(a)}}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:H,ihcData:null}).then()}}]),a}(i.Component),gt=(a(186),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"modal-outer",onClick:function(){e.props.history.goBack()}},r.a.createElement("div",{className:"h-100",style:{display:"flex"}},r.a.createElement("div",{className:"modal-inner",onClick:function(e){e.stopPropagation()}},r.a.createElement("div",{className:"btn-close",onClick:function(){e.props.history.goBack()}},"\xd7"),this.props.children)))}}]),a}(n.Component)),vt=Object(l.j)(gt);function bt(e){return r.a.createElement("div",{className:"m-header"},e.children)}function yt(e){return r.a.createElement("div",{className:"m-main"},e.children)}var Et=a(118),kt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).clicked=function(t){e.props.isSelected?e.props.deselectUser(e.props.index):e.props.selectUser(e.props.index)},e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("li",{key:this.props.index,onClick:this.clicked},r.a.createElement("div",{className:"username"},this.props.username),r.a.createElement("div",{className:"user-select fa-lg"+(this.props.isSelected?" selected":"")},r.a.createElement("i",{className:"fas fa-check"})))}}]),a}(n.Component),wt=a(58),Ct=a.n(wt),jt=0,Ot=1,Nt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e.target.value,searchResult:[],hasMore:!0})},n.loadUsers=Object(w.a)(k.a.mark((function e(){var t,a,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,a=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===a){e.next=14;break}return n.lastRequest={searchValue:t,length:a},e.prev=4,e.next=7,n.props.loadUsers(t,a);case 7:0===(r=e.sent).length?n.setState({hasMore:!1,error:jt}):n.setState((function(e){return{searchResult:e.searchResult.concat(r),error:jt}})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),n.setState({error:Ot});case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),n.selectUser=function(e){var t=n.state.searchResult[e];n.props.selectUser(t.uid,t.username)},n.deselectUser=function(e){var t=n.state.searchResult[e];n.props.deselectUser(t.uid)},n.state={searchValue:"",searchResult:[],error:jt,hasMore:!0},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(z,null,r.a.createElement("form",{className:"form-group",style:{width:"90%",maxWidth:"650px"}},r.a.createElement("input",{type:"text",className:"form-control p-2 m-2",placeholder:"Benutzer suchen",value:this.state.searchValue,onChange:this.searchChanged})),r.a.createElement("div",{className:"selectUsers",ref:function(t){return e.scrollParentRef=t}},r.a.createElement(Ct.a,{pageStart:0,loadMore:this.loadUsers,hasMore:this.state.hasMore,loader:r.a.createElement("div",{className:"loader",key:-1},r.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),useWindow:!1,getScrollParent:function(){return e.scrollParentRef}},r.a.createElement("ul",{className:"selectUsers"},this.state.searchResult.map((function(t,a){return r.a.createElement(kt,{key:a,index:a,uid:t.uid,username:t.username,selectUser:e.selectUser,deselectUser:e.deselectUser,isSelected:e.props.isUserSelected(t.uid)})})),0===this.state.searchResult.length?r.a.createElement("div",{key:-1,className:"nothingFound"},"Nichts gefunden!"):null))))}}]),a}(n.Component),xt=(a(188),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).selectUser=function(e,t){n.setState((function(a){return{selectedUsers:a.selectedUsers.concat({uid:e,username:t})}}))},n.deselectUser=function(e){n.setState((function(t){var a=Object(Et.a)(t.selectedUsers),n=a.findIndex((function(t){return t.uid===e}));return a.splice(n,1),{selectedUsers:a}}))},n.deselectIndex=function(e){n.deselectUser(n.state.selectedUsers[e].uid)},n.isUserSelected=function(e){return n.state.selectedUsers.find((function(t){return t.uid===e}))},n.btnNextClicked=function(e){n.props.onNext(n.state.selectedUsers)},n.state={selectedUsers:[],showOnlySelected:!1},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return 0===this.state.selectedUsers.length&&this.state.showOnlySelected&&this.setState({showOnlySelected:!1}),r.a.createElement(z,null,r.a.createElement("div",{className:"select-users"},0===e.state.selectedUsers.length?r.a.createElement("h4",null,"Noch niemand ausgew\xe4hlt"):r.a.createElement("h4",{className:"w-100"},r.a.createElement("span",{className:"selected-num"+(e.state.showOnlySelected?" selected":""),onClick:function(t){e.setState((function(e){return{showOnlySelected:!e.showOnlySelected}}))}},e.state.selectedUsers.length,"\xa0Benutzer"),"\xa0ausgew\xe4hlt",r.a.createElement("i",{className:"fas fa-arrow-right fa-lg float-right btn-next",onClick:e.btnNextClicked}))),this.state.showOnlySelected?r.a.createElement("div",{className:"selectUsers"},r.a.createElement("ul",{className:"selectUsers only-selected"},this.state.selectedUsers.map((function(t,a){return r.a.createElement(kt,{key:a,index:a,uid:t.uid,username:t.username,selectUser:function(){},deselectUser:e.deselectIndex,isSelected:!0})})))):r.a.createElement(Nt,{selectUser:this.selectUser,deselectUser:this.deselectUser,isUserSelected:this.isUserSelected,loadUsers:this.props.loadUsers}))}}]),a}(n.Component)),St=function(){var e=Object(w.a)(k.a.mark((function e(t,a){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:a})},e.next=3,oe("/group/"+t+"/members",n);case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error adding members");case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Tt=function(){var e=Object(w.a)(k.a.mark((function e(t,a){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)},e.next=3,oe("/user/notInGroup/"+t,n);case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching users");case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Mt=function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{Accept:"application/json"}},e.next=3,oe("/group/"+t+"/leave",a);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:if(!e.sent.error){e.next=10;break}throw new Error("Error leaving chat");case 10:e.next=13;break;case 12:throw new Error("Error leaving chat");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{Accept:"application/json"}},e.next=3,oe("/group/"+t+"/removeAdmin",a);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:if(!e.sent.error){e.next=10;break}throw new Error("Error removing admin");case 10:e.next=13;break;case 12:throw new Error("Error removing admin");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Dt(e){var t=Object(l.g)(),a=function(){var a=Object(w.a)(k.a.mark((function a(n){return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,St(e.gcid,n);case 3:t.goBack(),a.next=8;break;case 6:a.prev=6,a.t0=a.catch(0);case 8:case"end":return a.stop()}}),a,null,[[0,6]])})));return function(e){return a.apply(this,arguments)}}(),n=function(){var t=Object(w.a)(k.a.mark((function t(a,n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tt(e.gcid,{search:a,limit:10,start:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(z,null,r.a.createElement(bt,null,r.a.createElement("h2",null,"Benutzer hinzuf\xfcgen")),r.a.createElement(yt,null,r.a.createElement("div",{className:"addMembers"},r.a.createElement(xt,{onNext:a,loadUsers:n}))))}var _t=a(46),It=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.removeMemberFromChat=Object(w.a)(k.a.mark((function t(){var a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"DELETE",headers:{Accept:"application/json"}},t.next=4,oe("/group/"+e.props.gcid+"/member/"+e.props.member.uid,a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.makeMemberAdmin=Object(w.a)(k.a.mark((function t(){var a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"POST",headers:{Accept:"application/json"}},t.next=4,oe("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/giveAdmin",a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.removeMemberAdmin=Object(w.a)(k.a.mark((function t(){var a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return a={method:"POST",headers:{Accept:"application/json"}},t.next=4,oe("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/removeAdmin",a);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e}return Object(m.a)(a,[{key:"isMemberSelf",value:function(){return this.props.member.uid===this.global.userSelf.uid}},{key:"render",value:function(){var e=this.props.location.pathname;return o.a.createElement("ul",{className:"userOptions"},o.a.createElement("li",{key:0},o.a.createElement(u.b,{to:e+"/userInfo/"+this.props.member.uid},"zeige ",this.props.member.username," an")),o.a.createElement("li",{key:1},o.a.createElement(u.b,{to:"/chat/user/"+this.props.member.uid},"Nachricht an ",this.props.member.username)),this.isSelfAdmin()&&!this.isMemberSelf()?o.a.createElement(z,null,o.a.createElement("li",{key:2,className:"noLink",onClick:this.removeMemberFromChat},"aus chat entfernen"),this.props.member.isAdmin?o.a.createElement("li",{key:3,className:"noLink",onClick:this.removeMemberAdmin},"admin status entfernen"):o.a.createElement("li",{key:4,className:"noLink",onClick:this.makeMemberAdmin},"zu admin machen")):null)}}]),a}(i.Component),At=Object(l.j)(It);function Rt(e){var t=Object(l.h)().pathname;return r.a.createElement("ul",{className:"chatOptions"},e.memberSelf.isAdmin?r.a.createElement(z,null,r.a.createElement("li",{key:0,className:"addUsers"},r.a.createElement(u.b,{to:t+"/addUsers"},"Benutzer hinzuf\xfcgen")),r.a.createElement("li",{key:1,className:"removeSelfAdmin noLink",onClick:function(){Ut(e.gcid).then((function(){})).catch((function(e){console.log(e)}))}},"admin status entfernen")):null,r.a.createElement("li",{key:2,className:"leaveChat noLink",onClick:function(){Mt(e.gcid).then((function(){})).catch((function(e){console.log(e)}))}},"Chat verlassen"))}var Gt=a(111),Lt=a.n(Gt),Bt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).handleEdit=function(){var e=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,n.setState({isEditing:!1,value:a}),e.next=4,n.props.onSubmit(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.editPressed=function(){n.setState({isEditing:!0})},n.state={isEditing:!1,value:n.props.value},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:this.props.class},r.a.createElement(Lt.a,{name:this.props.name,value:this.state.value,isEditing:this.state.isEditing,changeCallback:this.handleEdit,optClass:"input"}),r.a.createElement("i",{className:"fas fa-edit edit",onClick:this.editPressed}))}}]),a}(n.Component),Pt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(w.a)(k.a.mark((function t(a){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({description:a})},t.next=3,oe("/group/"+e.props.gcid+"/description",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(Bt,{class:"description",name:"editDescription",value:this.props.description,onSubmit:this.onSubmit})}}]),a}(n.Component),Ft=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(w.a)(k.a.mark((function t(a){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatName:a})},t.next=3,oe("/group/"+e.props.gcid+"/chatName",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(Bt,{class:"chatName",name:"editChatName",value:this.props.chatName,onSubmit:this.onSubmit})}}]),a}(n.Component),zt=(a(213),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={error:!1,data:null},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;if(this.state.error)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Ein Fehler ist aufgetreten!");var t=Ye.userSelf.uid;return r.a.createElement("div",{className:"groupChatInfo"},this.props.data.memberSelf.isAdmin?r.a.createElement("h1",null,r.a.createElement(Ft,{gcid:this.props.gcid,chatName:this.props.data.chatName})):r.a.createElement("div",{className:"chatName"},r.a.createElement("h1",null,this.props.data.chatName)),this.props.data.memberSelf.isAdmin?r.a.createElement(Pt,{gcid:this.props.gcid,description:this.props.data.description}):r.a.createElement("div",{className:"description"},this.props.data.description),r.a.createElement(_t.a,{trigger:["click"],overlay:r.a.createElement(Rt,{gcid:this.props.gcid,memberSelf:this.props.data.memberSelf})},r.a.createElement("i",{className:"fas fa-ellipsis-v fa-lg chat-options-btn fa-2x",role:"button"})),r.a.createElement("h4",null,this.props.data.members.length,"\xa0Mitglieder:"),r.a.createElement("ul",{className:"userList"},this.props.data.members.map((function(a,n){return r.a.createElement("li",{key:n},r.a.createElement("div",{className:"userItem"},t===a.uid?r.a.createElement("span",null,"Du"):a.username,r.a.createElement("div",{className:"right"},a.isAdmin?r.a.createElement("span",{className:"user-admin"},"Admin\xa0\xa0"):null,r.a.createElement(_t.a,{trigger:["click"],overlay:r.a.createElement(At,{gcid:e.props.gcid,memberSelf:e.props.data.memberSelf,member:a}),animation:"slide-up",alignPoint:!0},r.a.createElement("i",{className:"fas fa-ellipsis-v fa-lg",role:"button"})))))}))))}}]),a}(n.Component)),Ht=Object(l.j)(zt);function Vt(e){var t=Object(l.i)().path,a=r.a.createElement(Ht,{gcid:e.gcid,data:e.data});return r.a.createElement(z,null,r.a.createElement(F,{displayIn:["Mobile"]},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/addUsers")},r.a.createElement(Dt,{gcid:e.gcid})),r.a.createElement(l.b,{path:"*"},a))),r.a.createElement(F,{displayIn:["Laptop","Tablet"]},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/addUsers")},r.a.createElement(vt,null,r.a.createElement(Dt,{gcid:e.gcid})))),a))}var Jt=0,Wt=1,Yt=2,qt=3,$t=4,Kt=5,Qt=0,Xt=1,Zt=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).loadGroupChatInfo=function(){var e=Object(w.a)(k.a.mark((function e(t){var a,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ze(n.props.gcid);case 3:if(403!==(a=e.sent).status){e.next=8;break}return e.abrupt("return",$t);case 8:if(404!==a.status){e.next=12;break}return e.abrupt("return",Yt);case 12:if(!a.ok){e.next=29;break}return e.next=15,a.json();case 15:if(r=e.sent,n.setState({chatData:r}),!r.error){e.next=25;break}if("not part of chat"!==r.error){e.next=22;break}return e.abrupt("return",qt);case 22:return e.abrupt("return",Kt);case 23:e.next=27;break;case 25:if(-1===Ye.chats.group.getIndex(t)){e.next=27;break}return e.abrupt("return",Jt);case 27:e.next=30;break;case 29:return e.abrupt("return",Kt);case 30:e.next=35;break;case 32:return e.prev=32,e.t0=e.catch(0),e.abrupt("return",Kt);case 35:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(t){return e.apply(this,arguments)}}(),n.chatChanged=function(){if(isNaN(n.props.gcid))n.setState({error:Wt,loaded:!0});else{var e=function(){var e=parseInt(n.props.gcid);n.loadGroupChatInfo(e).then((function(t){t===Jt?(n.selectGroupChat(e),n.setState({loaded:!0,error:Jt,gcid:e}),n.setGlobal({infoHeaderCenter:J,ihcData:{name:Ye.chats.group.get(e).chatName,gcid:e}}).then()):n.setState({loaded:!0,error:t})})).catch()};Ye.finishedLoading?e():Ye.event.on("chats loaded",(function(){e()}))}},n.state={gcid:0,loaded:!1,chatData:null,error:Jt},n}return Object(m.a)(a,[{key:"selectGroupChat",value:function(e){if(-1===Ye.chats.group.getIndex(e))this.setState({error:Yt});else{var t=Ye.chats.group.get(e);this.dispatch.selectChat(t)}}},{key:"componentDidMount",value:function(){this.chatChanged()}},{key:"componentDidUpdate",value:function(e,t,a){e.gcid!==this.props.gcid&&this.chatChanged()}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:H,ihcData:null}).then()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"h-100"},function(){if(!e.state.loaded)return o.a.createElement(Ke,{msg:"Chat wird geladen"})}(),function(){if(e.state.error===Wt)return o.a.createElement(it,null);if(e.state.loaded)switch(e.state.error){case Jt:switch(e.props.tab){case Qt:return o.a.createElement(st,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id});case Xt:return o.a.createElement(Vt,{gcid:e.state.gcid,data:e.state.chatData});default:return null}case qt:return o.a.createElement(ht,null);case $t:return o.a.createElement(pt,null);case Yt:return o.a.createElement(mt,null);case Kt:return o.a.createElement(dt,null);default:return null}}())}}]),a}(i.Component),ea=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).elementClicked=function(t){Ye.temporaryChat.createNew(e.props.uid,e.props.username)},e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("li",null,r.a.createElement(u.b,{to:"/chat/user/"+this.props.uid,onClick:this.elementClicked,replace:!0},this.props.username))}}]),a}(n.Component),ta=Object(l.j)(ea),aa=(a(214),0),na=1,ra=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e,searchResult:[],hasMore:!0})},n.loadChats=Object(w.a)(k.a.mark((function e(){var t,a,r,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,a=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===a){e.next=22;break}return n.lastRequest={searchValue:t,length:a},e.prev=4,e.next=7,n.props.loadChats(t,a);case 7:if(!(r=e.sent).ok){e.next=16;break}return e.next=11,r.json();case 11:0===(s=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(s)}})),n.setState({error:aa}),e.next=17;break;case 16:n.setState({error:na});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:na});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.state={error:aa,showOptions:!1,searchValue:"",searchResult:[],hasMore:!0},n}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.showSearchBar||this.props.searchValue!==e.searchValue&&this.searchChanged(this.props.searchValue)}},{key:"render",value:function(){var e=this;return this.state.error===na?r.a.createElement("div",{className:"alert alert-danger",role:"alert",key:0},"Ein Fehler ist aufgetreten!"):r.a.createElement(z,null,this.props.showSearchBar?r.a.createElement("div",{className:"user-top"},r.a.createElement("div",{className:"searchUser"},r.a.createElement("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:function(t){e.searchChanged()}}))):null,r.a.createElement("div",{className:"selectChat",ref:function(t){return e.scrollParentRef=t}},r.a.createElement(Ct.a,{pageStart:0,loadMore:this.loadChats,hasMore:this.state.hasMore,loader:r.a.createElement("div",{className:"loader",key:-1},r.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),useWindow:!1,getScrollParent:function(){return e.scrollParentRef}},r.a.createElement("ul",{className:"selectChat"},this.state.searchResult.map((function(t,a){return r.a.createElement(ta,{key:a,uid:t.uid,username:t.username,hide:e.props.hide})})),0===this.state.searchResult.length?r.a.createElement("div",{key:-1,className:"nothingFound"},"Nichts gefunden!"):null))))}}]),a}(n.Component);a(215),a(216);function sa(e){return ca.apply(this,arguments)}function ca(){return(ca=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/user/noChat",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ia(e){return oa.apply(this,arguments)}function oa(){return(oa=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/group/",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ua(e){return la.apply(this,arguments)}function la(){return(la=Object(w.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,oe("/user/",a);case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching users");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ha=0,pa=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).newGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Ea.newGroup)},n.joinGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Ea.chooseGroup)},n.searchChanged=function(e){var t=e.target.value;n.setState({searchValue:t,searchValid:!0})},n.loadChats=function(){var e=Object(w.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sa({search:t,limit:10,start:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={error:ha,searchValue:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=r.a.createElement("div",{className:"options"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:this.newGroupClick},"neue Gruppe"),r.a.createElement("li",{onClick:this.joinGroupClick},"einer Gruppe beitreten")));return r.a.createElement(z,null,r.a.createElement("div",{className:"user-top"},r.a.createElement("div",{className:"searchUser"},r.a.createElement("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:this.searchChanged})),r.a.createElement("div",{className:"user-more"},r.a.createElement(_t.a,{trigger:["click"],overlay:e,animation:"slide-up",alignPoint:!0},r.a.createElement("i",{className:"fas fa-ellipsis-h fa-2x",role:"button"})))),r.a.createElement(ra,{showSearchBar:!1,searchValue:this.state.searchValue,loadChats:this.loadChats}))}}]),a}(n.Component),ma=(a(217),a(115)),da=a.n(ma),fa=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).groupNameChanged=function(e){n.setState({groupName:e.target.value})},n.descriptionChanged=function(e){n.setState({description:e.target.value})},n.isPublicChanged=function(){n.setState((function(e){return{isPublic:!e.isPublic}}))},n.formSubmitted=function(e){e.preventDefault(),""!==n.state.groupName&&n.props.submitGroup({name:n.state.groupName,description:n.state.description,isPublic:n.state.isPublic})},n.state={groupName:"",description:"",isPublic:!1},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"groupInfoForm"},r.a.createElement("form",{onSubmit:this.formSubmitted},r.a.createElement("img",{style:{display:"none"},id:"groupImgInput1",src:da.a,alt:"Placeholder"}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleFormControlInput1"},"Gruppenname"),r.a.createElement("input",{type:"text",name:"groupName",className:"form-control",id:"input-groupName",placeholder:"Gruppenname",value:this.state.name,onChange:this.groupNameChanged,minLength:1})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description1"},"Beschreibung"),r.a.createElement("textarea",{className:"form-control",id:"description1",rows:"3",value:this.state.description,onChange:this.descriptionChanged})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"check-container"},"\xf6ffentlicher chat",r.a.createElement("input",{type:"checkbox",checked:this.state.isPublic,onChange:this.isPublicChanged}),r.a.createElement("span",{className:"checkmark"},r.a.createElement("i",{className:"fas fa-check"})))),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"float-right btn btn-primary m-3"},"Gruppe erstellen"))))}}]),a}(n.Component),ga=0,va=1,ba=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).showEnterChatInfo=function(e){n.setState({currentTab:va,selectedUsers:e})},n.submitGroup=function(e){for(var t=new Array(n.state.selectedUsers.length),a=0;a<n.state.selectedUsers.length;a++)t[a]={uid:n.state.selectedUsers[a].uid,username:n.state.selectedUsers[a].username,isAdmin:!1};n.createGroupChat(e,t).then((function(e){}))},n.createGroupChat=function(){var e=Object(w.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ia({data:t,users:a});case 3:e.sent.ok&&n.props.history.goBack(),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),n.loadUsers=function(){var e=Object(w.a)(k.a.mark((function e(t,a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ua({search:t,limit:10,start:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={currentTab:ga,selectedUsers:[]},n}return Object(m.a)(a,[{key:"render",value:function(){switch(this.state.currentTab){case ga:return r.a.createElement(xt,{onNext:this.showEnterChatInfo,loadUsers:this.loadUsers});case va:return r.a.createElement(fa,{submitGroup:this.submitGroup});default:return null}}}]),a}(n.Component),ya=Object(l.j)(ba),Ea=(a(218),{chooseUser:0,newGroup:1,chooseGroup:2}),ka=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).setCurrentTab=function(e){n.setState({currentTab:e})},n.state={currentTab:Ea.chooseUser},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(z,null,r.a.createElement(bt,null,r.a.createElement("h1",null,function(){switch(e.state.currentTab){case Ea.chooseUser:return"Neuer Chat";case Ea.newGroup:return"Neue Gruppe";case Ea.chooseGroup:return"Gruppe ausw\xe4hlen";default:return"Neuer Chat"}}())),r.a.createElement(yt,null,r.a.createElement("div",{className:"newChat"},function(){switch(e.state.currentTab){case Ea.chooseUser:return r.a.createElement(pa,{setCurrentTab:e.setCurrentTab,hide:e.props.hide});case Ea.newGroup:return r.a.createElement(ya,null);case Ea.chooseGroup:return r.a.createElement("div",null,r.a.createElement("h4",null,"chooseGroup"));default:return r.a.createElement(pa,{setCurrentTab:e.setCurrentTab,hide:e.props.hide})}}())))}}]),a}(n.Component),wa=function(){var e=Object(w.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{Accept:"application/json"}},e.next=3,oe("/user/"+t,a);case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching UserInfo");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ca=0,ja=1,Oa=2,Na=3,xa=4,Sa=5,Ta=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).setUser=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNaN(n.props.uid)){e.next=4;break}n.setState({error:Oa}),e.next=16;break;case 4:return t=parseInt(n.props.uid),n.setState({uid:t,error:Ca,loaded:!1}),e.prev=6,e.next=9,wa(t);case 9:(a=e.sent).uidSelf===t?n.setState({error:ja,loaded:!0}):a.userExists?a.blocked?n.setState({error:xa,loaded:!0}):n.setState({userInfo:a,loaded:!0}):n.setState({error:Na,loaded:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),n.setState({error:Sa,loaded:!0});case 16:case"end":return e.stop()}}),e,null,[[6,13]])}))),n.state={uid:0,loaded:!1,error:Ca,userInfo:null},n}return Object(m.a)(a,[{key:"render",value:function(){return this.state.loaded?this.state.error===ja?r.a.createElement(z,null,r.a.createElement(bt,null,r.a.createElement("h1",null,"Du")),r.a.createElement(yt,null,"xx")):this.state.error.none?r.a.createElement(z,null,r.a.createElement(bt,null,r.a.createElement("h1",null,this.state.userInfo.username,"\xa0",r.a.createElement(u.b,{to:"/chat/user/"+this.state.uid},r.a.createElement("i",{className:"far fa-comment-alt"})))),r.a.createElement(yt,null,r.a.createElement("h2",null,"Gruppen"))):r.a.createElement("div",null,"Error!"):null}},{key:"componentDidMount",value:function(){var e=Object(w.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setUser();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setState({error:4,loaded:!0});case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(w.a)(k.a.mark((function e(t,a,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.uid===this.props.uid){e.next=4;break}return e.next=4,this.setUser();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState({error:4,loaded:!0});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,a,n){return e.apply(this,arguments)}}()}]),a}(n.Component),Ma=(a(219),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(z,null,r.a.createElement(bt,null,r.a.createElement("h1",null,"Einstellungen")),r.a.createElement(yt,null,r.a.createElement("div",{className:"settings"},"to be implemented",r.a.createElement("div",{className:"about"},r.a.createElement(u.b,{to:"/about"},"\xfcber diese Seite")))))}}]),a}(n.Component));function Ua(e){var t=Object(l.i)().path;return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/newChat")},e.children,r.a.createElement(vt,null,r.a.createElement(ka,null))),r.a.createElement(l.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(t){return r.a.createElement(z,null,e.children,r.a.createElement(vt,null,r.a.createElement(Ta,{uid:t.match.params.uidInfo})))}}),r.a.createElement(l.b,{path:"".concat(t,"/settings")},e.children,r.a.createElement(vt,null,r.a.createElement(Ma,null))),r.a.createElement(l.b,{path:"*"},e.children))}function Da(e){var t=Object(l.i)().path;return r.a.createElement("div",{className:"main-container"},r.a.createElement("div",{className:"mc-left"},r.a.createElement($e,null)),r.a.createElement("div",{className:"mc-right"},r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/user/:uid"),render:function(e){return r.a.createElement(Ua,null,r.a.createElement(ft,{uid:e.match.params.uid}))}}),r.a.createElement(l.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return r.a.createElement(Ua,null,r.a.createElement(Zt,{gcid:e.match.params.gcid,tab:Qt}))}}),r.a.createElement(l.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return r.a.createElement(Ua,null,r.a.createElement(Zt,{gcid:e.match.params.gcid,tab:Xt}))}}),r.a.createElement(l.b,{path:t},r.a.createElement(Ua,null,r.a.createElement("h1",null,"noch kein chat ausgew\xe4hlt"))))))}a(220);var _a=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).typeStateChanged=function(){var e=Ye.getChat(n.props.chatType,n.props.chatId);n.setState({usersTyping:e.getUsersTyping()})},n.state={usersTyping:[]},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"typeMsg-container"},this.state.usersTyping.map((function(e,t){return r.a.createElement("div",{key:t,className:"typeMsg"},e.username+" schreibt...")})))}},{key:"componentDidMount",value:function(){Ye.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,a){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(Ye.getChat(e.chatType,e.chatId).event.rm("typeState changed",this.typeStateChanged),Ye.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged))}},{key:"componentWillUnmount",value:function(){Ye.getChat(this.props.chatType,this.props.chatId).event.rm("typeState changed",this.typeStateChanged)}}]),a}(n.Component);function Ia(e){var t=Object(l.i)().path;return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"".concat(t,"/newChat")},r.a.createElement(ka,null)),r.a.createElement(l.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(e){return r.a.createElement(Ta,{uid:e.match.params.uidInfo})}}),r.a.createElement(l.b,{path:"".concat(t,"/settings")},r.a.createElement(Ma,null)),r.a.createElement(l.b,{path:"*"},e.children))}function Aa(e){var t=Object(l.i)().path,a=Object(i.useGlobal)(),n=Object(T.a)(a,2),r=n[0],s=(n[1],function(){return""!==r.currentChat.type&&0!==r.currentChat.id?o.a.createElement(_a,{chatType:r.currentChat.type,chatId:r.currentChat.id}):null});return o.a.createElement("div",{className:"main-container"},o.a.createElement(l.d,null,o.a.createElement(l.b,{path:"".concat(t,"/user/:uid"),render:function(e){return o.a.createElement(Ia,null,o.a.createElement(ft,{uid:e.match.params.uid}),s())}}),o.a.createElement(l.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return o.a.createElement(Ia,null,o.a.createElement(Zt,{gcid:e.match.params.gcid,tab:Qt}),s())}}),o.a.createElement(l.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return o.a.createElement(Ia,null,o.a.createElement(Zt,{gcid:e.match.params.gcid,tab:Xt}))}}),o.a.createElement(l.b,{path:t},o.a.createElement(Ia,null,o.a.createElement("div",{className:"chat-list-outer-small"},o.a.createElement($e,null)))),o.a.createElement(l.b,{path:"*"},o.a.createElement("h3",null,"Not found!"))))}a(221);var Ra=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={modal:0,modalInfo:null,notifications:0},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){Ye.initCalled||Ye.init().then((function(e){}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"h-100"},r.a.createElement(X,null),r.a.createElement(F,{displayIn:["Mobile"]},r.a.createElement(Aa,null)),r.a.createElement(F,{displayIn:["Laptop","Tablet"]},r.a.createElement(Da,null)))}}]),a}(n.Component);a(222);function Ga(){return r.a.createElement("div",{className:"about"},r.a.createElement("h2",null,"\xdcber diese Seite"),r.a.createElement("h4",null,"Erstellt von:"),"Stefan Schlaghuber",r.a.createElement("br",null),"2002 Gro\xdfmugl",r.a.createElement("br",null),"stefan.schlaghuber@gmail.com",r.a.createElement("br",null))}a(223),a(224);function La(e){return Ba.apply(this,arguments)}function Ba(){return(Ba=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",headers:{Accept:"application/json"}},e.next=3,oe("/user/self",a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pa(){Object(i.addReducer)("deleteAuthTokens",(function(e,t){return localStorage.removeItem("authTokens"),location.reload(),t.deleteUserSelf(),t.resetGlobal(),We.destruct(),We=new Je,{loaded:!0,authTokens:void 0}})),Object(i.addReducer)("initAuthTokens",function(){var e=Object(w.a)(k.a.mark((function e(t,a,n){var r,s,c,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Se();case 3:return e.next=5,La(n);case 5:if(403!==(r=e.sent).status){e.next=11;break}return localStorage.removeItem("authTokens"),e.abrupt("return",{loaded:!0,authTokens:void 0});case 11:return e.next=13,r.json();case 13:return s=e.sent,c=s.uid,i=s.username,a.setUserSelf(c,i),e.abrupt("return",{loaded:!0,authTokens:n});case 17:e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{loaded:!1});case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,a,n){return e.apply(this,arguments)}}()),Object(i.addReducer)("setAuthTokens",(function(e,t,a){return localStorage.setItem("authTokens",JSON.stringify(a)),{loaded:!0,authTokens:a}}))}function Fa(){var e=Object(i.useDispatch)();return Object(i.useEffect)((function(){var t=JSON.parse(localStorage.getItem("authTokens"));e.initAuthTokens(t)}),[]),o.a.createElement(u.a,null,o.a.createElement(l.d,null,o.a.createElement(U,{path:"/chat",component:Ra}),o.a.createElement(l.b,{exact:!0,path:"/login",component:N}),o.a.createElement(l.b,{exact:!0,path:"/register",component:S}),o.a.createElement(l.b,{path:"/about"},o.a.createElement(Ga,null)),o.a.createElement(l.b,{exact:!0,path:"/"},o.a.createElement(l.a,{to:"/chat"})),o.a.createElement(l.b,{path:"*"},o.a.createElement(za,null))))}function za(){var e=Object(l.h)();return o.a.createElement("div",null,o.a.createElement("h3",null,"No match for ",o.a.createElement("code",null,e.pathname)))}Object(i.setGlobal)({loaded:!1,authTokens:void 0,userSelf:{},infoHeaderCenter:H,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}),function(){function e(e){Object(i.setGlobal)({chats:e})}Ye.finishedLoading?e(Ye.getChatArraySortedByDate()):Ye.event.on("chats loaded",e)}(),Object(i.addReducer)("setUserSelf",(function(e,t,a,n){return{userSelf:{uid:a,username:n}}})),Object(i.addReducer)("deleteUserSelf",(function(e,t){return{userSelf:{}}})),Object(i.addReducer)("resetGlobal",(function(e,t){return{infoHeaderCenter:H,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}})),function(){var e=this;function t(e,t){return e.chats.findIndex((function(e){return e.id===t.id&&e.type===t.type}))}Object(i.addReducer)("newMsg",(function(e,a,n,r,s){var c=t(e,n);if(-1!==c){if(function(e,t){var a=e.currentChat;return a.type===t.type&&a.id===t.id}(e,n)){var i=e.chats.splice(0),o=i[c];return o.latestMessage=n.getLatestMessageObject(),o.unreadMessages=0,i.splice(c,1),i.unshift(o),{chats:i,currentChat:Object(ie.a)(Object(ie.a)({},e.currentChat),{},{messages:e.currentChat.messages.concat(s),newMessages:e.currentChat.newMessages+1})}}var u=e.chats.splice(0),l=u[c];l.latestMessage=n.getLatestMessageObject();var h=e.newMessages;return 0===l.unreadMessages&&h++,l.unreadMessages=r+1,u.splice(c,1),u.unshift(l),{chats:u,newMessages:h}}})),Object(i.addReducer)("selectChat",(function(e,a,n){var r=t(e,n);if(-1!==r){var s=e.chats.splice(0),c=s[r],i=e.newMessages;return c.unreadMessages>0&&i--,c.unreadMessages=0,s[r]=c,Ye.socket.emit("change chat",{type:n.type,id:n.id}),{currentChat:{type:n.type,id:n.id,messages:n.getMessages(),newMessages:0},chats:s,tempChat:null,newMessages:i}}})),Object(i.addReducer)("selectNoChat",(function(e,t){return Ye.socket.emit("change chat",null),{currentChat:{type:"",id:0,messages:[]}}})),Object(i.addReducer)("addLoadedMessages",(function(e,t,a){return{currentChat:Object(ie.a)(Object(ie.a)({},e.currentChat),{},{messages:a?a.concat(e.currentChat.messages):e.currentChat.messages})}})),Object(i.addReducer)("addChat",(function(e,t,a){var n,r,s=e.chats.splice(0),c=a.getChatObject();if(0===s.length)return{chats:[c]};for(var i=0;i<s.length;i++)if(n=s[i],r=c,!n.latestMessage||r.latestMessage&&n.latestMessage.date.getTime()<r.latestMessage.date.getTime()){s.splice(i,0,c);break}return{chats:s}})),Object(i.addReducer)("removeChat",(function(a,n,r){var s=t(a,r),c=e.state.chats.splice(0);return c.splice(s,1),{chats:c}})),Object(i.addReducer)("showTempChat",(function(e,t){var a=Ye.temporaryChat.chatNow;return Ye.socket.emit("change chat",null),{tempChat:a.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("updateTempChat",(function(e,t,a){return{tempChat:a.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("hideTempChat",(function(e,t){return{tempChat:null}}))}(),Pa();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Fa,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[121,1,2]]]);
//# sourceMappingURL=main.57078c27.chunk.js.map