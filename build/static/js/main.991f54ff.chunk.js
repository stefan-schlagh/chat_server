(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{138:function(e,t,s){},143:function(e,t,s){},144:function(e,t,s){},145:function(e,t,s){},147:function(e,t,s){},148:function(e,t,s){},179:function(e,t,s){},180:function(e,t,s){},181:function(e,t,s){},184:function(e,t,s){},185:function(e,t,s){},186:function(e,t,s){},188:function(e,t,s){},213:function(e,t,s){},214:function(e,t,s){},216:function(e,t,s){},217:function(e,t,s){},218:function(e,t,s){},219:function(e,t,s){},220:function(e,t,s){},221:function(e,t,s){},222:function(e,t,s){},223:function(e,t,s){},225:function(e,t,s){},226:function(e,t,s){"use strict";s.r(t);var n=s(1),r=s.n(n),a=s(18),c=s.n(a),i=s(9),o=s(10),u=s(14),h=s(2),l=s.n(h),d=s(8),p=s(25),j=s(4),f=s(5),m=s(6),b=s(7),g=s(32),O=s.n(g),v=s(0),x=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("small",{className:"alert alert-danger p-1 message d-block",children:this.props.children})}}]),s}(n.Component),y=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("small",{className:"alert alert-success p-1 message d-block",children:this.props.children})}}]),s}(n.Component),k=s(19),w=(s(138),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).state={showPassword:!1},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"psw-group",children:[Object(v.jsx)("i",{className:(this.state.showPassword?"fa-eye-slash":"fa-eye")+" fas psw-toggle-icon",onClick:function(){return e.setState((function(e){return{showPassword:!e.showPassword}}))}}),Object(v.jsx)("input",Object(k.a)({type:this.state.showPassword?"text":"password"},this.props))]})}}]),s}(n.Component)),C=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})},e.next=3,fetch("/auth/login",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})},e.next=3,fetch("/auth/register",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),S=function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/user/verifyEmail/"+t,s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,email:s})},e.next=3,fetch("/pwReset/requestLink",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/pwReset/isValid/"+t,s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({code:t,password:s})},e.next=3,fetch("/pwReset/set",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),U=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;n.setState(Object(p.a)({},t,s))},n.submitHandler=function(e){e.preventDefault();var t,s={username:{presence:!0,length:{minimum:3,tooShort:"Benutzername zu kurz",maximum:30,tooLong:"Benutzername zu lang"},format:{pattern:new RegExp(/^\w[\w ]*$$/),message:"ung\xfcltiges Format"}},password:{presence:!0,length:{minimum:8,tooShort:"Passwort muss mindestens 8 Zeichen lang sein",maximum:50,tooLong:"Passwort darf h\xf6chstens 50 Zeichen lang sein"}}},r=O()({username:n.state.username,password:n.state.password},s);"undefined"!=typeof r?("undefined"!=typeof r.username?t=r.username[0]:"undefined"!=typeof r.password&&(t=r.password[0]),t=t.replace("Username ","").replace("Password ",""),n.setState({error:!0,errorMessage:t})):(n.setState({valid:!0,uNameErr:"",pwErr:""}),C(n.state.username,n.state.password).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=9;break}return e.next=3,t.json();case 3:s=e.sent,n.dispatch.setUserSelf(s.uid,n.state.username),n.dispatch.setAuthTokens(s.tokens),n.props.history.push("/chat"),e.next=10;break;case 9:403===t.status?n.setState({error:!0,errorMessage:"Falsches Passwort!"}):404===t.status?n.setState({error:!0,errorMessage:"Falscher Benutzername E-Mail Addresse"}):n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})})))},n.errorMessage=function(){if(n.state.error)return Object(v.jsx)(x,{children:n.state.errorMessage})},n.state={error:!1,errorMessage:"",username:"",password:"",redirect:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(v.jsx)("div",{className:"col-sm-12 my-auto",children:Object(v.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(v.jsx)("h1",{children:"Login"}),this.errorMessage(),Object(v.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"username",children:"Benutzername:"}),Object(v.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"password",children:"Passwort:"}),Object(v.jsx)(w,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:["haben Sie noch keinen Account? ",Object(v.jsx)(o.b,{to:"/register",children:"Jetzt registrieren"})]}),Object(v.jsxs)("div",{className:"form-group",children:["Passwort vergessen? ",Object(v.jsx)(o.b,{to:"/forgotPassword",children:"Jetzt zur\xfccksetzen"})]}),Object(v.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Login"})]})]})})})}}]),s}(i.Component),D=Object(u.j)(U);s(143);function _(){return Object(v.jsx)("h5",{className:"back-to-login",children:Object(v.jsxs)(o.b,{to:"/login",children:[Object(v.jsx)("i",{className:"fas fa-arrow-left"}),"\xa0 zur\xfcck zu login"]})})}var A=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;n.setState(Object(p.a)({},t,s))},n.submitHandler=function(e){e.preventDefault();var t,s={username:{presence:!0,length:{minimum:3,tooShort:"Benutzername zu kurz",maximum:30,tooLong:"Benutzername zu lang"},format:{pattern:new RegExp(/^\w[\w ]*$$/),message:"ung\xfcltiges Format"}},password:{presence:!0,length:{minimum:8,tooShort:"Passwort muss mindestens 8 Zeichen lang sein",maximum:50,tooLong:"Passwort darf h\xf6chstens 50 Zeichen lang sein"}},passwordRepeat:{presence:!0,equality:"password",length:{minimum:8,tooShort:"Passwort muss mindestens 8 Zeichen lang sein",maximum:50,tooLong:"Passwort darf h\xf6chstens 50 Zeichen lang sein"}}},r=O()({username:n.state.username,password:n.state.password,passwordRepeat:n.state.passwordRepeat},s);"undefined"!=typeof r?("undefined"!=typeof r.username?t=r.username[0]:"undefined"!=typeof r.password?t=r.password[0]:"undefined"!=typeof r.passwordRepeat&&(t="Passw\xf6rter stimmen nicht \xfcberein!"),t=t.replace("Username ","").replace("Password ",""),n.setState({error:!0,errorMessage:t})):(n.setState({error:!1,errorMessage:""}),N(n.state.username,n.state.password).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=7;break}return e.next=3,t.json();case 3:(s=e.sent).usernameTaken?n.setState({error:!0,errorMessage:"Benutzername bereits vergeben"}):(n.dispatch.setUserSelf(s.uid,n.state.username),n.dispatch.setAuthTokens(s.tokens),n.props.history.push("/chat")),e.next=8;break;case 7:n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})})))},n.errorMessage=function(){if(n.state.error)return Object(v.jsx)(x,{children:n.state.errorMessage})},n.state={error:!1,errorMessage:"",username:"",password:"",passwordRepeat:"",redirect:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(v.jsx)("div",{className:"col-sm-12 my-auto",children:Object(v.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(v.jsx)(_,{}),Object(v.jsx)("h1",{children:"Registrieren"}),this.errorMessage(),Object(v.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"username",children:"Benutzername:"}),Object(v.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"password",children:"Passwort:"}),Object(v.jsx)(w,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"passwordRepeat",children:"Passwort wiederholen:"}),Object(v.jsx)(w,{name:"passwordRepeat",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(v.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Registrieren"})]})]})})})}}]),s}(i.Component),I=Object(u.j)(A),R=(s(144),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).componentDidMount=function(){S(n.props.verificationCode).then((function(e){n.setState({loading:!1,success:200===e.status})})).catch((function(e){n.setState({loading:!1,error:!0})}))},n.state={loading:!0,error:!1,success:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return this.state.loading?null:this.state.error?Object(v.jsx)("div",{className:"h-100 verifyEmail error",children:Object(v.jsx)("h3",{children:"Fehler!"})}):this.state.success?Object(v.jsx)("div",{className:"h-100 verifyEmail",children:Object(v.jsx)("h3",{children:"E-Mail Addresse erfolgreich verifiziert!"})}):Object(v.jsx)("div",{className:"h-100 verifyEmail",children:Object(v.jsx)("h3",{children:"Ung\xfcltiger Verifizierungscode!"})})}}]),s}(i.Component)),P=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;n.setState(Object(p.a)({},t,s))},n.submitHandler=function(e){e.preventDefault();var t={username:{presence:!0,length:{minimum:3,tooShort:"Benutzername zu kurz",maximum:30,tooLong:"Benutzername zu lang"},format:{pattern:new RegExp(/^\w[\w ]*$$/),message:"ung\xfcltiges Format"}},email:{presence:!0,length:{minimum:1,tooShort:"E-Mail Addresse ben\xf6tigt"}}},s=O()({username:n.state.username,email:n.state.email},t);if("undefined"!=typeof s){var r;"undefined"!=typeof s.username?r=s.username[0]:"undefined"!=typeof s.email&&(r=s.email[0]),r=r.replace("Username ","").replace("Email ",""),n.setState({error:!0,errorMessage:r})}else{var a=n.state,c=a.username,i=a.email;M(c,i).then((function(e){200===e.status?n.setState({error:!1,sentMail:!0}):404===e.status?n.setState({error:!0,errorMessage:"Dieser Benutzer scheint nicht zu existieren"}):n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})})).catch((function(e){n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})}))}},n.errorMessage=function(){if(n.state.error)return Object(v.jsx)(x,{children:n.state.errorMessage})},n.successMessage=function(){if(n.state.sentMail)return Object(v.jsx)(y,{children:"E-Mail zum zur\xfccksetzen des Passwortes wurde versendet!"})},n.state={error:!1,errorMessage:"",username:"",email:"",sentMail:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(v.jsx)("div",{className:"col-sm-12 my-auto",children:Object(v.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(v.jsx)(_,{}),Object(v.jsx)("h1",{children:"Passwort zur\xfccksetzen"}),this.errorMessage(),Object(v.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"username",children:"Benutzername:"}),Object(v.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"email",children:"E-Mail Addresse:"}),Object(v.jsx)("input",{type:"email",name:"email",className:"form-control",placeholder:"E-Mail Addresse eingeben",onChange:this.changeHandler})]}),this.successMessage(),Object(v.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Passwort zur\xfccksetzen"})]})]})})})}}]),s}(i.Component),z=s(60),B=s(118);var G=function(e){var t=e.component,s=Object(B.a)(e,["component"]),n=Object(i.useGlobal)(),r=Object(z.a)(n,2),a=r[0];return r[1],Object(v.jsx)(u.b,Object(k.a)(Object(k.a)({},s),{},{render:function(e){return a.loaded?a.authTokens?Object(v.jsx)(t,Object(k.a)({},e)):Object(v.jsx)(u.a,{to:{pathname:"/login",state:{referer:e.location}}}):null}}))},L=992,F=768,H=991,V=767,J=320,W=425,q=function(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},Y=q(),Z={width:Y.width,height:Y.height},$=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state=Z,e.render=function(){var t=e.props,s=t.children,n=t.displayIn,a=e.state,c=a.width,i=a.height,o=e.shouldRender(n,c,i);return Object(v.jsx)(r.a.Fragment,{children:o?s:null})},e.handleResize=function(){var t=q(),s=t.width,n=t.height;e.setState({width:s,height:n})},e.shouldRender=function(e,t,s){return-1!==e.indexOf("Laptop")&&t>=L||(-1!==e.indexOf("Tablet")&&t<=H&&t>=F||(-1!==e.indexOf("Mobile")&&t<=V||(-1!==e.indexOf("MobilePortrait")&&t<=V&&s>=W||!!(-1!==e.indexOf("MobileLandScape")&&t<=V&&s<=J))))},e}return Object(f.a)(s,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize,!1)}}]),s}(r.a.PureComponent),K=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"componentDidMount",value:function(){"function"===typeof this.props.didMount&&this.props.didMount()}},{key:"componentDidUpdate",value:function(e,t,s){"function"===typeof this.props.didUpdate&&this.props.didUpdate()}},{key:"render",value:function(){return this.props.children?this.props.children:null}}]),s}(n.Component),Q=(s(145),0),X=1,ee=2,te=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=this.props.location.pathname;return Object(v.jsxs)(K,{children:[Object(v.jsx)($,{displayIn:["Mobile"],children:Object(v.jsxs)("div",{className:"float-left left",children:[Object(v.jsx)("i",{id:"btnBackToChatList",className:"fas fa-arrow-left fa-2x d-block d-md-none",onClick:function(){e.props.history.goBack()}}),e.global.newMessages>0?Object(v.jsx)("div",{className:"btnBack-number",children:e.global.newMessages}):null]})}),function(){switch(e.global.infoHeaderCenter){case X:return Object(v.jsxs)(ne,{children:[Object(v.jsx)("h3",{id:"chat-info-name",children:e.global.ihcData.name}),Object(v.jsx)(o.b,{to:t+"/userInfo/"+e.global.ihcData.uid,children:Object(v.jsx)("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})})]});case ee:return Object(v.jsxs)(ne,{children:[Object(v.jsx)("h3",{id:"chat-info-name",children:e.global.ihcData.name}),Object(v.jsx)(o.b,{to:"/chat/groupInfo/"+e.global.ihcData.gcid,children:Object(v.jsx)("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})})]});default:return Object(v.jsx)($,{displayIn:["Laptop","Tablet"],children:Object(v.jsx)("h3",{className:"pt-2 pl-2",children:"chat"})})}}()]})}}]),s}(i.Component),se=Object(u.j)(te);function ne(e){return Object(v.jsx)("div",{id:"chat-info",className:"center pt-2",children:e.children})}var re=s(115),ae=(s(146),s(147),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).clickCheckBox=function(e){n.state.checkBoxClicked?e.stopPropagation():setTimeout((function(){n.setState((function(e){return{checkBoxClicked:!0}}))}),20)},n.clickDocument=function(e){n.state.checkBoxClicked&&n.changeChecked(e)},n.changeChecked=function(e){n.setState((function(e){return{checkBoxClicked:!e.checkBoxClicked}}))},n.logout=function(){n.dispatch.deleteAuthTokens()},n.state={checkBoxClicked:!1},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this.props.location.pathname;return Object(v.jsxs)("div",{className:"c-header",children:[Object(v.jsx)(se,{}),Object(v.jsxs)("div",{id:"top-right",className:"right",onClick:this.clickCheckBox,children:[Object(v.jsx)("div",{className:"right-l"}),Object(v.jsx)("input",{type:"checkbox",id:"btnControlTopRight",className:"btnControl",checked:this.state.checkBoxClicked,onChange:this.changeChecked}),Object(v.jsx)("label",{htmlFor:"btnControlTopRight",children:Object(v.jsxs)("div",{className:"right-c",children:[Object(v.jsx)("div",{className:"d-only-when-small",children:Object(v.jsx)("i",{id:"user-info",className:"fas fa-user fa-2x user-icon","data-toggle":"tooltip",title:"Benutzer-Info"})}),Object(v.jsxs)("div",{className:"d-only-when-big top-2right",children:[Object(v.jsx)(o.b,{to:e+"/userInfo/"+this.global.userSelf.uid,children:Object(v.jsx)(ce,{text:"Benutzer-Info",children:Object(v.jsx)("h4",{id:"username",className:"p-2 username",children:this.global.userSelf.username})})}),Object(v.jsxs)("div",{className:"float-right",children:[Object(v.jsx)(o.b,{to:e+"/settings",children:Object(v.jsx)(ce,{text:"Einstellungen",children:Object(v.jsx)("i",{className:"fas fa-user-cog fa-2x"})})}),"\xa0",Object(v.jsx)(ce,{text:"logout",children:Object(v.jsx)("i",{id:"user-logout",className:"fas fa-sign-out-alt fa-2x logout",onClick:this.logout})})]})]})]})})]})]})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.clickDocument,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.clickDocument,!1)}}]),s}(i.Component));function ce(e){return Object(v.jsx)(re.a,{placement:"bottom",trigger:["hover"],overlay:Object(v.jsx)("span",{children:e.text}),children:e.children})}var ie=Object(u.j)(ae),oe=(s(148),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).searchChanged=function(t){e.props.onSearch(t.target.value)},e}return Object(f.a)(s,[{key:"render",value:function(){var e=this.props.location.pathname;return Object(v.jsx)("div",{className:"chatSearchBox",children:Object(v.jsxs)("div",{className:"chat-select-form",children:[Object(v.jsx)("input",{type:"text",name:"chat-search",className:"chat-search",placeholder:"Chat suchen",onChange:this.searchChanged}),Object(v.jsx)(o.b,{to:e+"/newChat",children:Object(v.jsx)("button",{id:"btn-newChat",className:"btn-newChat",children:Object(v.jsx)("i",{className:"fas fa-plus fa-lg"})})})]})})}}]),s}(n.Component)),ue=Object(u.j)(oe),he=s(109),le=s.n(he),de={names:{aqua:"#00ffff",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0"},random:function(){var e,t=0;for(var s in this.names)Math.random()<1/++t&&(e=s);return e}},pe=de,je=s(117),fe=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"getIndex",value:function(e){for(var t=0,s=this.length-1;t<=s;){var n=Math.floor((t+s)/2);if(this[n].key===e)return n;this[n].key<e?t=n+1:s=n-1}return-1}},{key:"getNearestKey",value:function(e){var t;for(++e;-1===(t=this.getIndex(--e));)if(0===e)return-1;return t}},{key:"get",value:function(e){var t=this.getIndex(e);if(-1!==t)return this[t].value}},{key:"add",value:function(e,t){-1===this.getIndex(e)&&this.splice(this.getNearestKey(e)+1,0,{key:e,value:t})}},{key:"remove",value:function(e){var t=this.getIndex(e);-1!==t&&this.splice(t,1)}}]),s}(Object(je.a)(Array));function me(e,t,s){return be.apply(this,arguments)}function be(){return(be=Object(d.a)(l.a.mark((function e(t,s,n){var r,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||Object(i.getGlobal)().authTokens,a=Object(k.a)(Object(k.a)({},s),{},{method:s.method,headers:Object(k.a)(Object(k.a)({},s.headers),{},{Authorization:r})}),e.next=4,fetch(t,a);case 4:if(401!==(c=e.sent).status){e.next=8;break}throw Object(i.getDispatch)().deleteAuthTokens(),new Error("jwt expired");case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/chats",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/user/chat",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/user/"+t,s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/message/load",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne=0,Se=1,Me=2,Te=3,Ee=4,Ue=5,De=6;function _e(){return(_e=Object(d.a)(l.a.mark((function e(t){var s,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===tt.users.getIndex(t)){e.next=10;break}if(0===tt.users.get(t).normalChat){e.next=5;break}return e.abrupt("return",Ne);case 5:return s=tt.users.get(t),tt.temporaryChat.createNew(t,s.username),e.abrupt("return",Me);case 8:e.next=40;break;case 10:if(!tt.temporaryChat.doesExist(t)){e.next=14;break}return e.abrupt("return",Me);case 14:return e.prev=14,e.next=17,ye(t);case 17:if(!(n=e.sent).ok){e.next=34;break}return e.next=21,n.json();case 21:if(!(r=e.sent).userExists||r.blocked){e.next=27;break}return tt.temporaryChat.createNew(t,r.username),e.abrupt("return",Me);case 27:if(r.userExists){e.next=31;break}return e.abrupt("return",Te);case 31:return e.abrupt("return",Ee);case 32:e.next=35;break;case 34:return e.abrupt("return",De);case 35:e.next=40;break;case 37:return e.prev=37,e.t0=e.catch(14),e.abrupt("return",De);case 40:case"end":return e.stop()}}),e,null,[[14,37]])})))).apply(this,arguments)}var Ae=function(){function e(t,s){Object(j.a)(this,e),this._normalChat=0,this._groupChats=new fe,this.uid=t,this.username=s,this.color=pe.random()}return Object(f.a)(e,[{key:"addGroupChat",value:function(e){this.groupChats.add(e,e)}},{key:"removeGroupChat",value:function(e){this.groupChats.remove(e)}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"normalChat",get:function(){return this._normalChat},set:function(e){this._normalChat=e}},{key:"groupChats",get:function(){return this._groupChats},set:function(e){this._groupChats=e}}]),e}(),Ie={};function Re(){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/data.json",t);case 3:if(!(s=e.sent).ok){e.next=10;break}return e.next=7,s.json();case 7:Ie=e.sent,e.next=11;break;case 10:throw new Error;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e){var t=e.msg;return Object(v.jsxs)("div",{className:(t.bySelf?"self ":"other ")+"msg-container",children:[t.userTop?Object(v.jsx)("div",{className:"w-100",children:Object(v.jsx)("strong",{className:"header",children:Object(v.jsx)(Fe,{user:t.userTop})})}):null,Object(v.jsx)("div",{className:"content",children:Object(v.jsx)("p",{children:t.content.text})}),Object(v.jsx)("div",{className:"date-outer",children:Object(v.jsx)("div",{className:"date",children:t.mDateString})})]})}function Be(e){var t=e.msg;return Object(v.jsxs)("div",{className:(t.bySelf?"self ":"other ")+"msg-container",children:[Object(v.jsx)(Ge,{msg:t}),Object(v.jsx)("div",{className:"date-outer",children:Object(v.jsx)("div",{className:"date",children:t.mDateString})})]})}function Ge(e){var t=e.msg;return Object(v.jsx)(K,{children:We(t,!0)})}s(179);function Le(e){var t=e.msg;switch(t.type){case Ie.messageTypes.normalMessage:return Object(v.jsx)(ze,{msg:t});case Ie.messageTypes.statusMessage:return Object(v.jsx)(Be,{msg:t});default:return Object(v.jsx)("span",{})}}function Fe(e){return Object(v.jsx)("span",{style:{color:pe.names[e.user.color]},children:e.user.username})}var He=0,Ve=1,Je=["den chat erstellt","hinzugef\xfcgt","entfernt","dem chat beigetreten","den chat verlassen","zum Admin gemacht","nicht mehr Admin"];function We(e,t){return function(){var t=e.userTop,n=e.content.passiveUsers;switch(e.content.type){case Ie.statusMessageTypes.chatCreated:return s(t,He,n,Ie.statusMessageTypes.chatCreated);case Ie.statusMessageTypes.usersAdded:return s(t,He,n,Ie.statusMessageTypes.usersAdded);case Ie.statusMessageTypes.usersRemoved:return s(t,He,n,Ie.statusMessageTypes.usersRemoved);case Ie.statusMessageTypes.usersJoined:return s(t,Ve,[],Ie.statusMessageTypes.usersJoined);case Ie.statusMessageTypes.usersLeft:return s(t,He,[],Ie.statusMessageTypes.usersLeft);case Ie.statusMessageTypes.usersMadeAdmin:return s(t,He,n,Ie.statusMessageTypes.usersMadeAdmin);case Ie.statusMessageTypes.usersRemovedAdmin:return s(t,Ve,[],Ie.statusMessageTypes.usersRemovedAdmin)}}();function s(s,n,r,a){function c(){switch(n){case He:return e.bySelf?" hast ":" hat ";case Ve:return" ist"}}function i(){if(r.length<1)return"";if(1===r.length){var e=tt.users.get(r[0]);return e?t?Object(v.jsx)(Fe,{user:e}):e.username:"1 Benutzer"}return r.length+" Benutzer"}function o(){return" "+Je[a]}return t?Object(v.jsxs)("span",{children:[Object(v.jsx)(Fe,{user:e.userTop}),c(),i(),o()]}):e.userTop.username+c()+i()+o()}}var qe=function(){function e(t,s,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date(Date.now()),a=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;Object(j.a)(this,e),this.mid=t,this.uid=s,this.date=r,this.chat=n,this.type=a,this.content=c}return Object(f.a)(e,[{key:"getMessageObject",value:function(e){var t={mDateString:this.getMessageViewDateString(),dateString:this.getDateString(),date:this.date,bySelf:this.uid===tt.userSelf.uid,type:this.type,content:this.content};return e&&(t.userTop=this.getUserTop()),t}},{key:"getUserTop",value:function(){if(this.isBySelf())return{uid:this.uid,username:"Du",color:tt.userSelf.color};var e=tt.users.get(this.uid);return{uid:this.uid,username:e.username,color:e.color}}},{key:"isBySelf",value:function(){return this.uid===tt.userSelf.uid}},{key:"getChatViewDateString",value:function(){return this.isDateToday()?"heute "+this.getTimeString():this.isDateYesterday()?"gestern":this.getDateString()}},{key:"getChatViewMsgString",value:function(){switch(this.type){case Ie.messageTypes.normalMessage:var e=this.content.text;return e.length>18&&(e=e.substr(0,18)+"..."),this.uid===tt.userSelf.uid?"Du: ".concat(e):"normalchat"===this.chat.type?this.content.text:"".concat(tt.users.get(this.uid).username,": ").concat(e);case Ie.messageTypes.statusMessage:return We(this.getMessageObject(!0),!1)}}},{key:"getMessageViewDateString",value:function(){return this.isDateToday()?this.getTimeString():this.isDateYesterday()?"gestern "+this.getTimeString():this.getDateString()+" "+this.getTimeString()}},{key:"isDateToday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"isDateYesterday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()-1&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"getDateString",value:function(){var e,t=this.date.getDate();e=t<10?"0"+t:t;var s,n=this.date.getMonth();s=n+1<10?"0"+(n+1):n+1;var r=this.date.getFullYear();return"".concat(e,".").concat(s,".").concat(r)}},{key:"getTimeString",value:function(){var e,t=this.date.getHours();e=t<10?"0"+t:t;var s,n=this.date.getMinutes();return s=n<10?"0"+n:n,"".concat(e,":").concat(s)}},{key:"isDifferentDay",value:function(e){return this.date.getDay()!==e.getDay()||this.date.getMonth()!==e.getMonth()||this.date.getFullYear()!==e.getFullYear()}},{key:"mid",get:function(){return this._mid},set:function(e){this._mid=e}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"date",get:function(){return this._date},set:function(e){this._date=e}},{key:"chat",get:function(){return this._chat},set:function(e){this._chat=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"content",get:function(){return this._content},set:function(e){this._content=e}}]),e}(),Ye=function(){function e(){Object(j.a)(this,e),this.events=new Map}return Object(f.a)(e,[{key:"on",value:function(e,t){this.events.has(e)?this.events.get(e).push(t):this.events.set(e,[t])}},{key:"rm",value:function(e,t){if(this.events.has(e))for(var s=this.events.get(e),n=0;n<s.length;n++)s[n]===t&&s.splice(n,1)}},{key:"trigger",value:function(e){if(this.events.has(e)){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];for(var r=0;r<this.events.get(e).length;r++){var a;(a=this.events.get(e))[r].apply(a,s)}}}},{key:"events",get:function(){return this._events},set:function(e){this._events=e}}]),e}(),Ze=function(){function e(t,s,n){Object(j.a)(this,e),this._messages=new fe,this._event=new Ye,this._unreadMessages=0,this._reachedTopMessages=!1,this.type=t,this.id=s,this.chatName=n}return Object(f.a)(e,[{key:"initFirstMessage",value:function(e){e.empty||this.messages.add(e.mid,new qe(e.mid,e.uid,this,new Date(e.date),e.type,e.content))}},{key:"loadMessages",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n,r,a,c,i,o,u,h,d=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reachedTopMessages){e.next=16;break}return s=function(){var e=d.getLastMessage();return null!==e?e.mid:-1},e.next=4,we({chatType:this.type,chatId:this.id,lastMsgId:s(),num:t});case 4:if(!(n=e.sent).ok){e.next=15;break}return e.next=8,n.json();case 8:for(r=e.sent,this.reachedTopMessages="reached top"===r.status,a=r.messages,c=new Array(a.length),i=this.showUserInfoMessage(),o=a.length-1;o>=0;o--)u=a[o],h=new qe(u.mid,u.uid,this,new Date(u.date),u.type,u.content),this.messages.add(u.mid,h),c[o]=h.getMessageObject(i);return e.abrupt("return",c);case 15:throw new Error;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLastMessage",value:function(){return 0!==this.messages.length?this.messages[0].value:null}},{key:"getFirstMessage",value:function(){return 0!==this.messages.length?this.messages[this.messages.length-1].value:null}},{key:"getMessages",value:function(){for(var e=this.showUserInfoMessage(),t=new Array(this.messages.length),s=0;s<this.messages.length;s++){var n=this.messages[s].value;t[s]=n.getMessageObject(e)}return t}},{key:"addMessage",value:function(e,t,s,n){var r=new qe(t,e,this,new Date(Date.now()),s,n);this.messages.add(t,r),Object(i.getDispatch)().newMsg(this,this.unreadMessages,r.getMessageObject(this.showUserInfoMessage()))}},{key:"showUserInfoMessage",value:function(){return"groupChat"===this.type}},{key:"getChatObject",value:function(){return{type:this.type,id:this.id,chatName:this.chatName,latestMessage:this.getLatestMessageObject(),unreadMessages:this.unreadMessages}}},{key:"getLatestMessageObject",value:function(){if(0===this.messages.length)return null;var e=this.getFirstMessage();return{msgString:e.getChatViewMsgString(),dateString:e.getChatViewDateString(),date:e.date}}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"chatName",get:function(){return this._chatName},set:function(e){this._chatName=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"unreadMessages",get:function(){return this._unreadMessages},set:function(e){this._unreadMessages=e}},{key:"reachedTopMessages",get:function(){return this._reachedTopMessages},set:function(e){this._reachedTopMessages=e}}]),e}(),$e=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e,n,r){var a,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(j.a)(this,s),(a=t.call(this,"normalChat",e,n))._isTyping=!1,a.otherUser=r,a.unreadMessages=c,a}return Object(f.a)(s,[{key:"getUsersTyping",value:function(){if(this.isTyping){var e=tt.users.get(this.otherUser);return[{uid:e.uid,username:e.username}]}return[]}},{key:"getLatestUserTyping",value:function(){if(this.isTyping){var e=tt.users.get(this.otherUser);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!0,this.event.trigger("typeState changed"))}},{key:"stoppedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!1,this.event.trigger("typeState changed"))}},{key:"otherUser",get:function(){return this._otherUser},set:function(e){this._otherUser=e}},{key:"isTyping",get:function(){return this._isTyping},set:function(e){this._isTyping=e}}]),s}(Ze),Ke=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e,n,r){var a,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(j.a)(this,s),(a=t.call(this,"groupChat",e,n))._users=[],a._usersTyping=[],a.users=r,a.unreadMessages=c,a}return Object(f.a)(s,[{key:"getUsersTyping",value:function(){if(this.usersTyping.length>0){for(var e=[],t=0;t<this.usersTyping.length;t++){var s=tt.users.get(this.usersTyping[t]);e.push({uid:s.uid,username:s.username})}return e}return[]}},{key:"getLatestUserTyping",value:function(){if(this.usersTyping.length>0){var e=tt.users.get(this.usersTyping[this.usersTyping.length-1]);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){this.isMember(e)&&(this.isTyping(e)||(this.usersTyping.push(e),this.event.trigger("typeState changed")))}},{key:"stoppedTyping",value:function(e){this.isMember(e)&&this.isTyping(e)&&(this.usersTyping.splice(this.getIndexOfTyping(e),1),this.event.trigger("typeState changed"))}},{key:"isMember",value:function(e){return e!==tt.userSelf.uid&&this.users.find((function(t){return t===e}))}},{key:"isTyping",value:function(e){return this.usersTyping.find((function(t){return t===e}))}},{key:"getIndexOfTyping",value:function(e){return this.usersTyping.findIndex((function(t){return t===e}))}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"usersTyping",get:function(){return this._usersTyping},set:function(e){this._usersTyping=e}}]),s}(Ze),Qe=function(){function e(){Object(j.a)(this,e),this._isShown=!1}return Object(f.a)(e,[{key:"createNew",value:function(e,t){this.chatNow=new $e(0,t,e)}},{key:"doesExist",value:function(e){return void 0!==this.chatNow&&this.chatNow.otherUser===e}},{key:"show",value:function(){this.isShown=!0,Object(i.getDispatch)().showTempChat(this.chatNow)}},{key:"update",value:function(){Object(i.getDispatch)().updateTempChat(this.chatNow)}},{key:"hide",value:function(){this.isShown=!1,Object(i.getDispatch)().hideTempChat()}},{key:"createNewNormalChat",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n,r,a,c,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.chatNow.otherUser,n=this.chatNow.chatName,e.next=4,ve({uid:s,username:n,message:{type:Ie.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}}});case 4:if(!(r=e.sent).ok){e.next=20;break}return e.next=8,r.json();case 8:return a=e.sent,-1===tt.users.getIndex(s)&&tt.users.add(s,new Ae(s,n)),c=tt.users.get(s),o=new $e(a.ncid,n,s),c.normalChat=o.id,tt.chats.normal.add(a.ncid,o),u=new qe(a.mid,tt.userSelf.uid,o,new Date(Date.now()),Ie.messageTypes.normalMessage,{text:t,mentions:[],media:[]}),o.messages.add(u.mid,u),Object(i.getDispatch)().addChat(o),Object(i.getDispatch)().selectChat(o),this.hide(),e.abrupt("return",!0);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isShown",get:function(){return this._isShown},set:function(e){this._isShown=e}},{key:"chatNow",get:function(){return this._chatNow},set:function(e){this._chatNow=e}}]),e}(),Xe=function(){function e(){Object(j.a)(this,e),this._userSelf={uid:0,username:""},this._users=new fe,this._chats={normal:new fe,group:new fe},this._event=new Ye,this._finishedLoading=!1,this._temporaryChat=new Qe,this._initCalled=!1}return Object(f.a)(e,[{key:"destruct",value:function(){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect()),this.initCalled=!1}},{key:"init",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,s,n,r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(i.getGlobal)().userSelf,s=t.uid,n=t.username,this.userSelf=new Ae(s,n),this.userInfo={uid:s,username:n},this.initCalled=!0,this.userSelf=new Ae(s,n),this.userInfo={uid:s,username:n},this.socket=le.a.connect("/",{secure:!0}),this.socket.emit("auth",Object(i.getGlobal)().authTokens),this.socket.on("initialized",(function(){r.initChats()})),this.socket.on("chat message",(function(e){var t=r.getChat(e.chat.type,e.chat.id);if(null!==t){var s=r.isCurrentChat(t.type,t.id);t.addMessage(e.uid,e.mid,e.type,e.content),t.hasNewMsg=!s,t.unreadMessages++,r.event.trigger("new message",e.chat.type,e.chat.id)}})),this.socket.on("started typing",(function(e){r.getChat(e.chat.type,e.chat.id).startedTyping(e.uid)})),this.socket.on("stopped typing",(function(e){r.getChat(e.chat.type,e.chat.id).stoppedTyping(e.uid)})),this.socket.on("users-noChat",(function(e){et.event.trigger("users-noChat",e)})),this.socket.on("new chat",(function(e){r.addNewChat(e)})),this.socket.on("disconnect",(function(){setTimeout((function(){alert("Verbindung verloren! Seite wird neu geladen"),location.reload()}),1e3)}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initChats",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge();case 2:if(200!==(t=e.sent).status){e.next=8;break}return e.next=6,t.json();case 6:for(s=e.sent,n=0;n<s.length;n++)"normalChat"===s[n].type?this.addNewNormalChat(s[n]):"groupChat"===s[n].type&&this.addNewGroupChat(s[n]);case 8:this.finishedLoading=!0,this.event.trigger("chats loaded",this.getChatArraySortedByDate());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChatArraySortedByDate",value:function(){function e(e){var t=e.latestMessage;return null!==t?t.date.getTime():new Date(0).getTime()}function t(t,s){for(var n=s,r=s+1;r<t.length;r++)e(t[n])<e(t[r])&&(n=r);return n}function s(e,t,s){var n=e[t];e[t]=e[s],e[s]=n}function n(e){for(var n=function(e){for(var t=new Array(e.length),s=0;s<e.length;s++){var n=e[s].value;t[s]=n.getChatObject()}return t}(e),r=0;r<n.length-1;r++){s(n,r,t(n,r))}return n}return function(t,s){for(var n=new Array(t.length+s.length),r=0,a=0,c=0;c<n.length;c++)a<s.length?r<t.length&&e(t[r])>e(s[a])?(n[c]=t[r],r++):(n[c]=s[a],a++):(n[c]=t[r],r++);return n}(n(this.chats.normal),n(this.chats.group))}},{key:"isCurrentChat",value:function(e,t){var s=Object(i.getGlobal)().currentChat;return s.type===e&&s.id===t}},{key:"getChat",value:function(e,t){return"normalChat"===e?this.chats.normal.get(t):"tempChat"===e?this.temporaryChat.chatNow:"groupChat"===e?this.chats.group.get(t):void 0}},{key:"addNewChat",value:function(e){var t;"normalChat"===e.type?t=this.addNewNormalChat(e):"groupChat"===e.type&&(t=this.addNewGroupChat(e)),t.unreadMessages=1,Object(i.getDispatch)().addChat(t)}},{key:"addNewNormalChat",value:function(e){var t;-1===this.users.getIndex(e.members[0].uid)?(t=new Ae(e.members[0].uid,e.members[0].username),this.users.add(t.uid,t)):t=this.users.get(e.members[0].uid);var s=new $e(e.id,e.chatName,t.uid,e.unreadMessages);return t.normalChat=s.id,s.initFirstMessage(e.firstMessage),this.chats.normal.add(e.id,s),s}},{key:"addNewGroupChat",value:function(e){for(var t=[],s=0;s<e.members.length;s++){var n=e.members[s],r=void 0;-1===this.users.getIndex(n.uid)?(r=new Ae(n.uid,n.username),this.users.add(r.uid,r)):r=this.users.get(n.uid),t.push(r.uid),r.addGroupChat(e.id)}var a=new Ke(e.id,e.chatName,t,e.unreadMessages);return a.initFirstMessage(e.firstMessage),this.chats.group.add(e.id,a),a}},{key:"socket",get:function(){return this._socket},set:function(e){this._socket=e}},{key:"userSelf",get:function(){return this._userSelf},set:function(e){this._userSelf=e}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"chats",get:function(){return this._chats},set:function(e){this._chats=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"finishedLoading",get:function(){return this._finishedLoading},set:function(e){this._finishedLoading=e}},{key:"temporaryChat",get:function(){return this._temporaryChat},set:function(e){this._temporaryChat=e}},{key:"initCalled",get:function(){return this._initCalled},set:function(e){this._initCalled=e}}]),e}(),et=new Xe;var tt=et,st=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).isSelected=function(){return n.props.id===n.global.currentChat.id&&n.props.type===n.global.currentChat.type},n.typeStateChanged=function(){var e="",t=tt.getChat(n.props.type,n.props.id).getLatestUserTyping();null!==t&&(e=t.username+" schreibt..."),n.setState({typeMsg:e})},n.state={lastMsg:void 0,typeMsg:""},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=function(){return e.props.latestMessage?Object(v.jsx)("span",{children:e.props.latestMessage.msgString}):Object(v.jsx)("span",{children:"Noch keine Nachrichten vorhanden"})},s=function(){return e.props.latestMessage?Object(v.jsx)("div",{className:"lastMsg-date",children:e.props.latestMessage.dateString}):null};return Object(v.jsx)("li",{className:"chat-item"+(this.isSelected()?" selected ":""),children:Object(v.jsxs)(o.b,{to:"normalChat"===e.props.type?"/chat/user/"+tt.getChat("normalChat",e.props.id).otherUser:"groupChat"===e.props.type?"/chat/group/"+e.props.id:"tempChat"===e.props.type?"/chat/user/"+tt.temporaryChat.chatNow.otherUser:void 0,children:[Object(v.jsxs)("div",{className:"w-100",children:[Object(v.jsx)("strong",{className:"chatItem-username",children:this.props.name}),0===e.props.unreadMessages?null:Object(v.jsx)("div",{className:"newMsg-number",children:e.props.unreadMessages})]}),""===e.state.typeMsg?Object(v.jsxs)("div",{className:"w-100 lastMsg",children:[t(),s()]}):Object(v.jsx)("div",{className:"w-100 typeMsg",children:e.state.typeMsg})]})})}},{key:"componentDidMount",value:function(){tt.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,s){e.type===this.props.type&&e.id===this.props.id||(tt.getChat(e.type,e.id).event.rm("typeState changed",this.typeStateChanged),tt.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged),this.setState({typeMsg:""}))}},{key:"componentWillUnmount",value:function(){tt.getChat(this.props.type,this.props.id).event.rm("typeState changed",this.typeStateChanged)}}]),s}(i.Component),nt=(s(180),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).state={searchValue:""},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this,t=0;return Object(v.jsxs)(K,{children:[Object(v.jsx)(ue,{onSearch:function(t){e.setState({searchValue:t})}}),Object(v.jsxs)("ul",{className:"chat-list",children:[e.global.tempChat?Object(v.jsx)(st,{id:0,type:"tempChat",name:e.global.tempChat.chatName,unreadMessages:0,latestMessage:null},-1):null,this.global.chats.map((function(s,n){return s.chatName.includes(e.state.searchValue)?(t++,Object(v.jsx)(st,{id:s.id,type:s.type,name:s.chatName,unreadMessages:s.unreadMessages,latestMessage:s.latestMessage},n)):null}))]}),0===t?Object(v.jsx)("span",{children:"Nichts gefunden"}):null]})}}]),s}(i.Component));s(181);function rt(e){return Object(v.jsx)("div",{className:"loader-init",children:Object(v.jsx)("div",{className:"col-sm-12 my-auto",children:Object(v.jsxs)("div",{className:"init-container border rounded",children:[Object(v.jsx)("div",{className:"spinner-border text-secondary",style:{width:"15rem",height:"15rem",borderWidth:"0.5rem"},role:"status",children:Object(v.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(v.jsx)("div",{className:"loader-text",children:e.msg})]})})})}var at=s(56),ct=(s(182),s(114));function it(e){return ot.apply(this,arguments)}function ot(){return(ot=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/group/"+t+"/",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/message",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s(184);var lt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e))._userTyping=!1,n._typeEventEmitted=!1,n.onTyping=function(e){n.setState({message:e.target.value}),n.handleTypeMessage()},n.handleTypeMessage=function(){n.isTempChat||(n.userTyping&&clearTimeout(n.typeTimeout),n.userTyping=!0,n.typeEventEmitted||(n.typeEventEmitted=!0,tt.socket.emit("started typing")),n.typeTimeout=setTimeout((function(){n.userTyping=!1,n.typeEventEmitted&&(n.typeEventEmitted=!1,tt.socket.emit("stopped typing"))}),1e3))},n.onSubmit=function(e){if(e.preventDefault(),""!==n.state.message){var t=n.state.message;if(n.setState({message:""}),n.isTempChat){var s=n.props.location.pathname;tt.temporaryChat.createNewNormalChat(t).then((function(e){e&&(n.props.history.replace("/chat"),n.props.history.replace(s))}))}else n.sendMessage(t).then((function(e){tt.getChat(n.props.chatType,n.props.chatId).addMessage(tt.userSelf.uid,e,Ie.messageTypes.normalMessage,{text:t,mentions:[],media:[]})})).catch((function(e){}))}},n.sendMessage=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ut({type:Ie.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}});case 2:if(!(s=e.sent).ok){e.next=8;break}return e.next=6,s.json();case 6:return n=e.sent,e.abrupt("return",n.mid);case 8:return e.abrupt("return",new Error);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onEmojiInput=function(e){n.setState({message:n.state.message+e.native}),n.handleTypeMessage()},n.toggleEmoji=function(e){n.setState((function(e){return{showEmoji:!e.showEmoji}}))},n.state={message:"",showEmoji:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsxs)(K,{children:[Object(v.jsxs)("form",{onSubmit:this.onSubmit,className:"msg-form",children:[Object(v.jsxs)("div",{className:"message-input",children:[Object(v.jsx)("input",{autoComplete:"off",placeholder:"Nachricht:",name:"message-input-text",value:this.state.message,onChange:this.onTyping}),Object(v.jsx)("i",{className:"far fa-smile fa-2x emoji-toggle",onClick:this.toggleEmoji})]}),Object(v.jsx)("button",{className:"btn-submit",type:"submit",children:Object(v.jsx)("i",{className:"far fa-paper-plane fa-2x","data-toggle":"tooltip",title:"send message"})})]}),this.state.showEmoji?Object(v.jsx)("div",{style:{position:"absolute",bottom:"60px",right:"50px",width:"350px",height:"425px"},children:Object(v.jsx)(ct.a,{onSelect:this.onEmojiInput,native:!0})}):null]})}},{key:"componentDidMount",value:function(){this.isTempChat="tempChat"===this.props.chatType}},{key:"componentDidUpdate",value:function(e,t,s){this.isTempChat="tempChat"===this.props.chatType}},{key:"userTyping",get:function(){return this._userTyping},set:function(e){this._userTyping=e}},{key:"typeEventEmitted",get:function(){return this._typeEventEmitted},set:function(e){this._typeEventEmitted=e}},{key:"typeTimeout",get:function(){return this._typeTimeout},set:function(e){this._typeTimeout=e}},{key:"isTempChat",get:function(){return this._isTempChat},set:function(e){this._isTempChat=e}}]),s}(n.Component),dt=Object(u.j)(lt),pt=(s(185),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e))._isMounted=!1,n.scrollHandler=function(e){n.setState({scrollToBottom:n.getScrollToBottom()}),0===n.messagesNode.scrollTop&&n.loadMessages()},n.setScrollToBottom=function(e){n.messagesNode.scrollTop=n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-e},n.getScrollToBottom=function(){return n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-n.messagesNode.scrollTop},n.assignMessagesRef=function(e){n.messages=e},n.loadMessages=function(){var e=tt.getChat(n.global.currentChat.type,n.global.currentChat.id);e.reachedTopMessages||n.setState({msgLoading:!0}),e.loadMessages(10).then((function(e){n.dispatch.addLoadedMessages(e),n.setState((function(e){return{msgLoading:!1}})),n.setScrollToBottom(n.state.scrollToBottom)})).catch((function(e){return n.setState({msgLoading:!1})}))},n.chatChanged=function(){0===n.messagesNode.scrollTop&&n.loadMessages()},n.assignMessagesRef=n.assignMessagesRef.bind(Object(at.a)(n)),n.state={msgLoading:!1,scrollToBottom:0,messages:[],typeMessages:[]},n}return Object(f.a)(s,[{key:"componentDidMount",value:function(){this.messagesNode=c.a.findDOMNode(this.messages),this.chatChanged(),this.isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,s){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(this.setScrollToBottom(0),this.chatChanged()),0===this.state.scrollToBottom&&(this.setScrollToBottom(0),this.global.currentChat.newMessages>0&&this.setGlobal((function(e){return{currentChat:Object(k.a)(Object(k.a)({},e.currentChat),{},{newMessages:0})}})))}},{key:"render",value:function(){var e=this,t=new Date(0),s=function(e){return s=e.date,n=t,s.getDay()!==n.getDay()||s.getMonth()!==n.getMonth()||s.getFullYear()!==n.getFullYear()?(t=e.date,Object(v.jsx)("div",{className:"date-container",children:Object(v.jsx)("div",{children:e.dateString})})):(t=e.date,null);var s,n};return Object(v.jsxs)("div",{className:"chat-container",children:[Object(v.jsxs)("div",{className:"messages",onScroll:this.scrollHandler,ref:this.assignMessagesRef,children:[e.state.msgLoading?Object(v.jsx)("div",{className:"messageLoader-top",children:Object(v.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(v.jsx)("span",{className:"sr-only",children:"Loading..."})})}):null,this.global.currentChat.messages.map((function(e,t){return Object(v.jsxs)(K,{children:[s(e),Object(v.jsx)(Le,{msg:e})]},t)})),0===e.global.currentChat.messages.length?Object(v.jsx)("div",{className:"alert alert-primary",role:"alert",children:"Noch keine Nachrichten vorhanden"}):null,e.isMounted&&e.getScrollToBottom()>10?Object(v.jsxs)("div",{id:"messages-bottom",className:"messages-bottom",onClick:function(){e.setState({scrollToBottom:0})},children:[Object(v.jsx)("div",{id:"btnToBottom",className:"chevron-down",children:Object(v.jsx)("i",{className:"fas fa-chevron-down fa-2x"})}),e.global.currentChat.newMessages>0?Object(v.jsx)("div",{id:"scroll-down-number",className:"number",children:e.global.currentChat.newMessages}):null]}):null]}),Object(v.jsx)(dt,{chatType:this.props.chatType,chatId:this.props.chatId})]})}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"isMounted",get:function(){return this._isMounted},set:function(e){this._isMounted=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"messagesNode",get:function(){return this._messagesNode},set:function(e){this._messagesNode=e}}]),s}(i.Component)),jt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsxs)("div",{className:"chat-container",children:[Object(v.jsx)("div",{className:"messages",children:Object(v.jsx)("div",{className:"alert alert-primary",role:"alert",children:"Noch keine Nachrichten vorhanden"})}),Object(v.jsx)(dt,{chatType:"tempChat",chatId:0})]})}},{key:"componentDidMount",value:function(){tt.temporaryChat.show()}},{key:"componentDidUpdate",value:function(e,t,s){e.uid!==this.props.uid&&tt.temporaryChat.update()}},{key:"componentWillUnmount",value:function(){tt.temporaryChat.hide()}}]),s}(n.Component);function ft(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"ung\xfcltige Addresse"})})}function mt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Du kannst dir selbst nicht schreiben"})})}function bt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Dieser User hat dich blockiert"})})}function gt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Dieser User existiert nicht"})})}function Ot(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Du bist nicht Mitglied in diesem chat jetzt beitreten"})})}function vt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Du bist nicht dazu berechtigt diesen chat anzusehen"})})}function xt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Dieser Chat existiert nicht"})})}function yt(){return Object(v.jsx)("div",{children:Object(v.jsx)("h2",{children:"Fehler"})})}var kt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).userChanged=function(){var e=parseInt(n.props.uid);if(n.global.userSelf.uid===e)n.setState({error:Ue,loaded:!0});else{var t=function(){(function(e){return _e.apply(this,arguments)})(e).then((function(t){t===Ne?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:X,ihcData:{name:tt.users.get(e).username,uid:e}}).then(),n.selectNormalChat(e)):t===Me?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:X,ihcData:{name:tt.temporaryChat.chatNow.chatName,uid:e}}).then(),n.selectTempChat()):n.setState({error:De}),n.setState({loaded:!0})})).catch((function(e){return n.setState({error:De})}))};tt.finishedLoading?t():tt.event.on("chats loaded",(function(){t()})),n.setState({uid:parseInt(n.props.uid)})}},n.state={uid:0,loaded:!1,error:Ne},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"h-100",children:[function(){if(!e.state.loaded)return Object(v.jsx)(rt,{msg:"Chat wird geladen"})}(),e.state.error===Se?Object(v.jsx)(ft,{}):e.state.error===Ue?Object(v.jsx)(mt,{}):e.state.loaded?e.state.error===Ne?Object(v.jsx)(pt,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id}):e.state.error===Me?Object(v.jsx)(jt,{uid:e.state.uid}):e.state.error===Ee?Object(v.jsx)(bt,{}):Object(v.jsx)(gt,{}):void 0]})}},{key:"componentDidMount",value:function(){this.userChanged()}},{key:"componentDidUpdate",value:function(e,t,s){e.uid!==this.props.uid&&(isNaN(this.props.uid)?this.setState({error:Se}):this.userChanged())}},{key:"selectTempChat",value:function(){this.dispatch.showTempChat()}},{key:"selectNormalChat",value:function(e){if(-1===tt.users.getIndex(e))this.setState({error:Te});else{var t=tt.users.get(e).normalChat,s=tt.getChat("normalChat",t);this.dispatch.selectChat(s)}}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:Q,ihcData:null}).then()}}]),s}(i.Component),wt=(s(186),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsx)("div",{className:"modal-outer",onClick:function(){e.props.history.goBack()},children:Object(v.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(v.jsxs)("div",{className:"modal-inner",onClick:function(e){e.stopPropagation()},children:[Object(v.jsx)("div",{className:"btn-close",onClick:function(){e.props.history.goBack()},children:"\xd7"}),this.props.children]})})})}}]),s}(n.Component)),Ct=Object(u.j)(wt);function Nt(e){return Object(v.jsx)("div",{className:"m-header",children:e.children})}function St(e){return Object(v.jsx)("div",{className:"m-main",children:e.children})}var Mt=s(116),Tt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).clicked=function(t){e.props.isSelected?e.props.deselectUser(e.props.index):e.props.selectUser(e.props.index)},e}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsxs)("li",{onClick:this.clicked,children:[Object(v.jsx)("div",{className:"username",children:this.props.username}),Object(v.jsx)("div",{className:"user-select fa-lg"+(this.props.isSelected?" selected":""),children:Object(v.jsx)("i",{className:"fas fa-check"})})]},this.props.index)}}]),s}(n.Component),Et=s(58),Ut=s.n(Et),Dt=0,_t=1,At=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e.target.value,searchResult:[],hasMore:!0})},n.loadUsers=Object(d.a)(l.a.mark((function e(){var t,s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,s=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===s){e.next=14;break}return n.lastRequest={searchValue:t,length:s},e.prev=4,e.next=7,n.props.loadUsers(t,s);case 7:0===(r=e.sent).length?n.setState({hasMore:!1,error:Dt}):n.setState((function(e){return{searchResult:e.searchResult.concat(r),error:Dt}})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),n.setState({error:_t});case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),n.selectUser=function(e){var t=n.state.searchResult[e];n.props.selectUser(t.uid,t.username)},n.deselectUser=function(e){var t=n.state.searchResult[e];n.props.deselectUser(t.uid)},n.state={searchValue:"",searchResult:[],error:Dt,hasMore:!0},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsxs)(K,{children:[Object(v.jsx)("form",{className:"form-group",style:{width:"90%",maxWidth:"650px"},children:Object(v.jsx)("input",{type:"text",className:"form-control p-2 m-2",placeholder:"Benutzer suchen",value:this.state.searchValue,onChange:this.searchChanged})}),Object(v.jsx)("div",{className:"selectUsers",ref:function(t){return e.scrollParentRef=t},children:Object(v.jsx)(Ut.a,{pageStart:0,loadMore:this.loadUsers,hasMore:this.state.hasMore,loader:Object(v.jsx)("div",{className:"loader",children:Object(v.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(v.jsx)("span",{className:"sr-only",children:"Loading..."})})},-1),useWindow:!1,getScrollParent:function(){return e.scrollParentRef},children:Object(v.jsxs)("ul",{className:"selectUsers",children:[this.state.searchResult.map((function(t,s){return Object(v.jsx)(Tt,{index:s,uid:t.uid,username:t.username,selectUser:e.selectUser,deselectUser:e.deselectUser,isSelected:e.props.isUserSelected(t.uid)},s)})),0===this.state.searchResult.length?Object(v.jsx)("div",{className:"nothingFound",children:"Nichts gefunden!"},-1):null]})})})]})}}]),s}(n.Component),It=(s(188),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).selectUser=function(e,t){n.setState((function(s){return{selectedUsers:s.selectedUsers.concat({uid:e,username:t})}}))},n.deselectUser=function(e){n.setState((function(t){var s=Object(Mt.a)(t.selectedUsers),n=s.findIndex((function(t){return t.uid===e}));return s.splice(n,1),{selectedUsers:s}}))},n.deselectIndex=function(e){n.deselectUser(n.state.selectedUsers[e].uid)},n.isUserSelected=function(e){return n.state.selectedUsers.find((function(t){return t.uid===e}))},n.btnNextClicked=function(e){n.props.onNext(n.state.selectedUsers)},n.state={selectedUsers:[],showOnlySelected:!1},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return 0===this.state.selectedUsers.length&&this.state.showOnlySelected&&this.setState({showOnlySelected:!1}),Object(v.jsxs)(K,{children:[Object(v.jsx)("div",{className:"select-users",children:0===e.state.selectedUsers.length?Object(v.jsx)("h4",{children:"Noch niemand ausgew\xe4hlt"}):Object(v.jsxs)("h4",{className:"w-100",children:[Object(v.jsxs)("span",{className:"selected-num"+(e.state.showOnlySelected?" selected":""),onClick:function(t){e.setState((function(e){return{showOnlySelected:!e.showOnlySelected}}))},children:[e.state.selectedUsers.length,"\xa0Benutzer"]}),"\xa0ausgew\xe4hlt",Object(v.jsx)("i",{className:"fas fa-arrow-right fa-lg float-right btn-next",onClick:e.btnNextClicked})]})}),this.state.showOnlySelected?Object(v.jsx)("div",{className:"selectUsers",children:Object(v.jsx)("ul",{className:"selectUsers only-selected",children:this.state.selectedUsers.map((function(t,s){return Object(v.jsx)(Tt,{index:s,uid:t.uid,username:t.username,selectUser:function(){},deselectUser:e.deselectIndex,isSelected:!0},s)}))})}):Object(v.jsx)(At,{selectUser:this.selectUser,deselectUser:this.deselectUser,isUserSelected:this.isUserSelected,loadUsers:this.props.loadUsers})]})}}]),s}(n.Component)),Rt=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:s})},e.next=3,me("/group/"+t+"/members",n);case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error adding members");case 11:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),Pt=function(){var e=Object(d.a)(l.a.mark((function e(t,s){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)},e.next=3,me("/user/notInGroup/"+t,n);case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching users");case 11:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),zt=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json"}},e.next=3,me("/group/"+t+"/leave",s);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:if(!e.sent.error){e.next=10;break}throw new Error("Error leaving chat");case 10:e.next=13;break;case 12:throw new Error("Error leaving chat");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bt=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json"}},e.next=3,me("/group/"+t+"/removeAdmin",s);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:if(!e.sent.error){e.next=10;break}throw new Error("Error removing admin");case 10:e.next=13;break;case 12:throw new Error("Error removing admin");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Gt(e){var t=Object(u.g)(),s=function(){var s=Object(d.a)(l.a.mark((function s(n){return l.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,Rt(e.gcid,n);case 3:t.goBack(),s.next=8;break;case 6:s.prev=6,s.t0=s.catch(0);case 8:case"end":return s.stop()}}),s,null,[[0,6]])})));return function(e){return s.apply(this,arguments)}}(),n=function(){var t=Object(d.a)(l.a.mark((function t(s,n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Pt(e.gcid,{search:s,limit:10,start:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}();return Object(v.jsxs)(K,{children:[Object(v.jsx)(Nt,{children:Object(v.jsx)("h2",{children:"Benutzer hinzuf\xfcgen"})}),Object(v.jsx)(St,{children:Object(v.jsx)("div",{className:"addMembers",children:Object(v.jsx)(It,{onNext:s,loadUsers:n})})})]})}var Lt=s(47),Ft=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.removeMemberFromChat=Object(d.a)(l.a.mark((function t(){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"DELETE",headers:{Accept:"application/json"}},t.next=4,me("/group/"+e.props.gcid+"/member/"+e.props.member.uid,s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.makeMemberAdmin=Object(d.a)(l.a.mark((function t(){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"POST",headers:{Accept:"application/json"}},t.next=4,me("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/giveAdmin",s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.removeMemberAdmin=Object(d.a)(l.a.mark((function t(){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"POST",headers:{Accept:"application/json"}},t.next=4,me("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/removeAdmin",s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e}return Object(f.a)(s,[{key:"isMemberSelf",value:function(){return this.props.member.uid===this.global.userSelf.uid}},{key:"render",value:function(){var e=this.props.location.pathname;return Object(v.jsxs)("ul",{className:"userOptions",children:[Object(v.jsx)("li",{children:Object(v.jsxs)(o.b,{to:e+"/userInfo/"+this.props.member.uid,children:["zeige ",this.props.member.username," an"]})},0),Object(v.jsx)("li",{children:Object(v.jsxs)(o.b,{to:"/chat/user/"+this.props.member.uid,children:["Nachricht an ",this.props.member.username]})},1),this.isSelfAdmin()&&!this.isMemberSelf()?Object(v.jsxs)(K,{children:[Object(v.jsx)("li",{className:"noLink",onClick:this.removeMemberFromChat,children:"aus chat entfernen"},2),this.props.member.isAdmin?Object(v.jsx)("li",{className:"noLink",onClick:this.removeMemberAdmin,children:"admin status entfernen"},3):Object(v.jsx)("li",{className:"noLink",onClick:this.makeMemberAdmin,children:"zu admin machen"},4)]}):null]})}}]),s}(i.Component),Ht=Object(u.j)(Ft);function Vt(e){var t=Object(u.h)().pathname;return Object(v.jsxs)("ul",{className:"chatOptions",children:[e.memberSelf.isAdmin?Object(v.jsxs)(K,{children:[Object(v.jsx)("li",{className:"addUsers",children:Object(v.jsx)(o.b,{to:t+"/addUsers",children:"Benutzer hinzuf\xfcgen"})},0),Object(v.jsx)("li",{className:"removeSelfAdmin noLink",onClick:function(){Bt(e.gcid).then((function(){})).catch((function(e){console.log(e)}))},children:"admin status entfernen"},1)]}):null,Object(v.jsx)("li",{className:"leaveChat noLink",onClick:function(){zt(e.gcid).then((function(){})).catch((function(e){console.log(e)}))},children:"Chat verlassen"},2)]})}var Jt=s(110),Wt=s.n(Jt),qt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).handleEdit=function(){var e=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.target.value,n.setState({isEditing:!1,value:s}),e.next=4,n.props.onSubmit(s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.editPressed=function(){n.setState({isEditing:!0})},n.state={isEditing:!1,value:n.props.value},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsxs)("div",{className:this.props.class,children:[Object(v.jsx)(Wt.a,{name:this.props.name,value:this.state.value,isEditing:this.state.isEditing,changeCallback:this.handleEdit,optClass:"input"}),Object(v.jsx)("i",{className:"fas fa-edit edit",onClick:this.editPressed})]})}}]),s}(n.Component),Yt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(d.a)(l.a.mark((function t(s){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({description:s})},t.next=3,me("/group/"+e.props.gcid+"/description",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)(qt,{class:"description",name:"editDescription",value:this.props.description,onSubmit:this.onSubmit})}}]),s}(n.Component),Zt=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(){var t=Object(d.a)(l.a.mark((function t(s){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatName:s})},t.next=3,me("/group/"+e.props.gcid+"/chatName",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)(qt,{class:"chatName",name:"editChatName",value:this.props.chatName,onSubmit:this.onSubmit})}}]),s}(n.Component),$t=(s(213),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).state={error:!1,data:null},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;if(this.state.error)return Object(v.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Ein Fehler ist aufgetreten!"});var t=tt.userSelf.uid;return Object(v.jsxs)("div",{className:"groupChatInfo",children:[this.props.data.memberSelf.isAdmin?Object(v.jsx)("h1",{children:Object(v.jsx)(Zt,{gcid:this.props.gcid,chatName:this.props.data.chatName})}):Object(v.jsx)("div",{className:"chatName",children:Object(v.jsx)("h1",{children:this.props.data.chatName})}),this.props.data.memberSelf.isAdmin?Object(v.jsx)(Yt,{gcid:this.props.gcid,description:this.props.data.description}):Object(v.jsx)("div",{className:"description",children:this.props.data.description}),Object(v.jsx)(Lt.a,{trigger:["click"],overlay:Object(v.jsx)(Vt,{gcid:this.props.gcid,memberSelf:this.props.data.memberSelf}),children:Object(v.jsx)("i",{className:"fas fa-ellipsis-v fa-lg chat-options-btn fa-2x",role:"button"})}),Object(v.jsxs)("h4",{children:[this.props.data.members.length,"\xa0Mitglieder:"]}),Object(v.jsx)("ul",{className:"userList",children:this.props.data.members.map((function(s,n){return Object(v.jsx)("li",{children:Object(v.jsxs)("div",{className:"userItem",children:[t===s.uid?Object(v.jsx)("span",{children:"Du"}):s.username,Object(v.jsxs)("div",{className:"right",children:[s.isAdmin?Object(v.jsx)("span",{className:"user-admin",children:"Admin\xa0\xa0"}):null,Object(v.jsx)(Lt.a,{trigger:["click"],overlay:Object(v.jsx)(Ht,{gcid:e.props.gcid,memberSelf:e.props.data.memberSelf,member:s}),animation:"slide-up",alignPoint:!0,children:Object(v.jsx)("i",{className:"fas fa-ellipsis-v fa-lg",role:"button"})})]})]})},n)}))})]})}}]),s}(n.Component)),Kt=Object(u.j)($t);function Qt(e){var t=Object(u.i)().path,s=Object(v.jsx)(Kt,{gcid:e.gcid,data:e.data});return Object(v.jsxs)(K,{children:[Object(v.jsx)($,{displayIn:["Mobile"],children:Object(v.jsxs)(u.d,{children:[Object(v.jsx)(u.b,{path:"".concat(t,"/addUsers"),children:Object(v.jsx)(Gt,{gcid:e.gcid})}),Object(v.jsx)(u.b,{path:"*",children:s})]})}),Object(v.jsxs)($,{displayIn:["Laptop","Tablet"],children:[Object(v.jsx)(u.d,{children:Object(v.jsx)(u.b,{path:"".concat(t,"/addUsers"),children:Object(v.jsx)(Ct,{children:Object(v.jsx)(Gt,{gcid:e.gcid})})})}),s]})]})}var Xt=0,es=1,ts=2,ss=3,ns=4,rs=5,as=0,cs=1,is=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).loadGroupChatInfo=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,it(n.props.gcid);case 3:if(403!==(s=e.sent).status){e.next=8;break}return e.abrupt("return",ns);case 8:if(404!==s.status){e.next=12;break}return e.abrupt("return",ts);case 12:if(!s.ok){e.next=29;break}return e.next=15,s.json();case 15:if(r=e.sent,n.setState({chatData:r}),!r.error){e.next=25;break}if("not part of chat"!==r.error){e.next=22;break}return e.abrupt("return",ss);case 22:return e.abrupt("return",rs);case 23:e.next=27;break;case 25:if(-1===tt.chats.group.getIndex(t)){e.next=27;break}return e.abrupt("return",Xt);case 27:e.next=30;break;case 29:return e.abrupt("return",rs);case 30:e.next=35;break;case 32:return e.prev=32,e.t0=e.catch(0),e.abrupt("return",rs);case 35:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(t){return e.apply(this,arguments)}}(),n.chatChanged=function(){if(isNaN(n.props.gcid))n.setState({error:es,loaded:!0});else{var e=function(){var e=parseInt(n.props.gcid);n.loadGroupChatInfo(e).then((function(t){t===Xt?(n.selectGroupChat(e),n.setState({loaded:!0,error:Xt,gcid:e}),n.setGlobal({infoHeaderCenter:ee,ihcData:{name:tt.chats.group.get(e).chatName,gcid:e}}).then()):n.setState({loaded:!0,error:t})})).catch()};tt.finishedLoading?e():tt.event.on("chats loaded",(function(){e()}))}},n.state={gcid:0,loaded:!1,chatData:null,error:Xt},n}return Object(f.a)(s,[{key:"selectGroupChat",value:function(e){if(-1===tt.chats.group.getIndex(e))this.setState({error:ts});else{var t=tt.chats.group.get(e);this.dispatch.selectChat(t)}}},{key:"componentDidMount",value:function(){this.chatChanged()}},{key:"componentDidUpdate",value:function(e,t,s){e.gcid!==this.props.gcid&&this.chatChanged()}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:Q,ihcData:null}).then()}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"h-100",children:[function(){if(!e.state.loaded)return Object(v.jsx)(rt,{msg:"Chat wird geladen"})}(),function(){if(e.state.error===es)return Object(v.jsx)(ft,{});if(e.state.loaded)switch(e.state.error){case Xt:switch(e.props.tab){case as:return Object(v.jsx)(pt,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id});case cs:return Object(v.jsx)(Qt,{gcid:e.state.gcid,data:e.state.chatData});default:return null}case ss:return Object(v.jsx)(Ot,{});case ns:return Object(v.jsx)(vt,{});case ts:return Object(v.jsx)(xt,{});case rs:return Object(v.jsx)(yt,{});default:return null}}()]})}}]),s}(i.Component),os=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(){var e;Object(j.a)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).elementClicked=function(t){tt.temporaryChat.createNew(e.props.uid,e.props.username)},e}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("li",{children:Object(v.jsx)(o.b,{to:"/chat/user/"+this.props.uid,onClick:this.elementClicked,replace:!0,children:this.props.username})})}}]),s}(n.Component),us=Object(u.j)(os),hs=(s(214),0),ls=1,ds=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e,searchResult:[],hasMore:!0})},n.loadChats=Object(d.a)(l.a.mark((function e(){var t,s,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,s=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===s){e.next=22;break}return n.lastRequest={searchValue:t,length:s},e.prev=4,e.next=7,n.props.loadChats(t,s);case 7:if(!(r=e.sent).ok){e.next=16;break}return e.next=11,r.json();case 11:0===(a=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(a)}})),n.setState({error:hs}),e.next=17;break;case 16:n.setState({error:ls});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:ls});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.state={error:hs,showOptions:!1,searchValue:"",searchResult:[],hasMore:!0},n}return Object(f.a)(s,[{key:"componentDidUpdate",value:function(e,t,s){this.props.showSearchBar||this.props.searchValue!==e.searchValue&&this.searchChanged(this.props.searchValue)}},{key:"render",value:function(){var e=this;return this.state.error===ls?Object(v.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Ein Fehler ist aufgetreten!"},0):Object(v.jsxs)(K,{children:[this.props.showSearchBar?Object(v.jsx)("div",{className:"user-top",children:Object(v.jsx)("div",{className:"searchUser",children:Object(v.jsx)("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:function(t){e.searchChanged()}})})}):null,Object(v.jsx)("div",{className:"selectChat",ref:function(t){return e.scrollParentRef=t},children:Object(v.jsx)(Ut.a,{pageStart:0,loadMore:this.loadChats,hasMore:this.state.hasMore,loader:Object(v.jsx)("div",{className:"loader",children:Object(v.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(v.jsx)("span",{className:"sr-only",children:"Loading..."})})},-1),useWindow:!1,getScrollParent:function(){return e.scrollParentRef},children:Object(v.jsxs)("ul",{className:"selectChat",children:[this.state.searchResult.map((function(t,s){return Object(v.jsx)(us,{uid:t.uid,username:t.username,hide:e.props.hide},s)})),0===this.state.searchResult.length?Object(v.jsx)("div",{className:"nothingFound",children:"Nichts gefunden!"},-1):null]})})})]})}}]),s}(n.Component);s(215),s(216);function ps(e){return js.apply(this,arguments)}function js(){return(js=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/user/noChat",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fs(e){return ms.apply(this,arguments)}function ms(){return(ms=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/group/",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bs(e){return gs.apply(this,arguments)}function gs(){return(gs=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/user/",s);case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching users");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Os=0,vs=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).newGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Ss.newGroup)},n.joinGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Ss.chooseGroup)},n.searchChanged=function(e){var t=e.target.value;n.setState({searchValue:t,searchValid:!0})},n.loadChats=function(){var e=Object(d.a)(l.a.mark((function e(t,s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ps({search:t,limit:10,start:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),n.state={error:Os,searchValue:""},n}return Object(f.a)(s,[{key:"render",value:function(){var e=Object(v.jsx)("div",{className:"options",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{onClick:this.newGroupClick,children:"neue Gruppe"}),Object(v.jsx)("li",{onClick:this.joinGroupClick,children:"einer Gruppe beitreten"})]})});return Object(v.jsxs)(K,{children:[Object(v.jsxs)("div",{className:"user-top",children:[Object(v.jsx)("div",{className:"searchUser",children:Object(v.jsx)("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:this.searchChanged})}),Object(v.jsx)("div",{className:"user-more",children:Object(v.jsx)(Lt.a,{trigger:["click"],overlay:e,animation:"slide-up",alignPoint:!0,children:Object(v.jsx)("i",{className:"fas fa-ellipsis-h fa-2x",role:"button"})})})]}),Object(v.jsx)(ds,{showSearchBar:!1,searchValue:this.state.searchValue,loadChats:this.loadChats})]})}}]),s}(n.Component),xs=(s(217),s.p+"static/media/placeholder.3c40b139.png"),ys=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).groupNameChanged=function(e){n.setState({groupName:e.target.value})},n.descriptionChanged=function(e){n.setState({description:e.target.value})},n.isPublicChanged=function(){n.setState((function(e){return{isPublic:!e.isPublic}}))},n.formSubmitted=function(e){e.preventDefault(),""!==n.state.groupName&&n.props.submitGroup({name:n.state.groupName,description:n.state.description,isPublic:n.state.isPublic})},n.state={groupName:"",description:"",isPublic:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"groupInfoForm",children:Object(v.jsxs)("form",{onSubmit:this.formSubmitted,children:[Object(v.jsx)("img",{style:{display:"none"},id:"groupImgInput1",src:xs,alt:"Placeholder"}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"exampleFormControlInput1",children:"Gruppenname"}),Object(v.jsx)("input",{type:"text",name:"groupName",className:"form-control",id:"input-groupName",placeholder:"Gruppenname",value:this.state.name,onChange:this.groupNameChanged,minLength:1})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"description1",children:"Beschreibung"}),Object(v.jsx)("textarea",{className:"form-control",id:"description1",rows:"3",value:this.state.description,onChange:this.descriptionChanged})]}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsxs)("label",{className:"check-container",children:["\xf6ffentlicher chat",Object(v.jsx)("input",{type:"checkbox",checked:this.state.isPublic,onChange:this.isPublicChanged}),Object(v.jsx)("span",{className:"checkmark",children:Object(v.jsx)("i",{className:"fas fa-check"})})]})}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsx)("button",{type:"submit",className:"float-right btn btn-primary m-3",children:"Gruppe erstellen"})})]})})}}]),s}(n.Component),ks=0,ws=1,Cs=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).showEnterChatInfo=function(e){n.setState({currentTab:ws,selectedUsers:e})},n.submitGroup=function(e){for(var t=new Array(n.state.selectedUsers.length),s=0;s<n.state.selectedUsers.length;s++)t[s]={uid:n.state.selectedUsers[s].uid,username:n.state.selectedUsers[s].username,isAdmin:!1};n.createGroupChat(e,t).then((function(e){}))},n.createGroupChat=function(){var e=Object(d.a)(l.a.mark((function e(t,s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fs({data:t,users:s});case 3:e.sent.ok&&n.props.history.goBack(),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,s){return e.apply(this,arguments)}}(),n.loadUsers=function(){var e=Object(d.a)(l.a.mark((function e(t,s){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bs({search:t,limit:10,start:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),n.state={currentTab:ks,selectedUsers:[]},n}return Object(f.a)(s,[{key:"render",value:function(){switch(this.state.currentTab){case ks:return Object(v.jsx)(It,{onNext:this.showEnterChatInfo,loadUsers:this.loadUsers});case ws:return Object(v.jsx)(ys,{submitGroup:this.submitGroup});default:return null}}}]),s}(n.Component),Ns=Object(u.j)(Cs),Ss=(s(218),{chooseUser:0,newGroup:1,chooseGroup:2}),Ms=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).setCurrentTab=function(e){n.setState({currentTab:e})},n.state={currentTab:Ss.chooseUser},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsxs)(K,{children:[Object(v.jsx)(Nt,{children:Object(v.jsx)("h1",{children:function(){switch(e.state.currentTab){case Ss.chooseUser:return"Neuer Chat";case Ss.newGroup:return"Neue Gruppe";case Ss.chooseGroup:return"Gruppe ausw\xe4hlen";default:return"Neuer Chat"}}()})}),Object(v.jsx)(St,{children:Object(v.jsx)("div",{className:"newChat",children:function(){switch(e.state.currentTab){case Ss.chooseUser:return Object(v.jsx)(vs,{setCurrentTab:e.setCurrentTab,hide:e.props.hide});case Ss.newGroup:return Object(v.jsx)(Ns,{});case Ss.chooseGroup:return Object(v.jsx)("div",{children:Object(v.jsx)("h4",{children:"chooseGroup"})});default:return Object(v.jsx)(vs,{setCurrentTab:e.setCurrentTab,hide:e.props.hide})}}()})})]})}}]),s}(n.Component),Ts=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/user/"+t,s);case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error fetching UserInfo");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Es=0,Us=1,Ds=2,_s=3,As=4,Is=5,Rs=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).setUser=Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNaN(n.props.uid)){e.next=4;break}n.setState({error:Ds}),e.next=16;break;case 4:return t=parseInt(n.props.uid),n.setState({uid:t,error:Es,loaded:!1}),e.prev=6,e.next=9,Ts(t);case 9:(s=e.sent).uidSelf===t?n.setState({error:Us,loaded:!0}):s.userExists?s.blocked?n.setState({error:As,loaded:!0}):n.setState({userInfo:s,loaded:!0}):n.setState({error:_s,loaded:!0}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),n.setState({error:Is,loaded:!0});case 16:case"end":return e.stop()}}),e,null,[[6,13]])}))),n.state={uid:0,loaded:!1,error:Es,userInfo:null},n}return Object(f.a)(s,[{key:"render",value:function(){return this.state.loaded?this.state.error===Us?Object(v.jsxs)(K,{children:[Object(v.jsx)(Nt,{children:Object(v.jsx)("h1",{children:"Du"})}),Object(v.jsx)(St,{children:"xx"})]}):this.state.error!==Es?Object(v.jsx)("div",{children:"Error!"}):Object(v.jsxs)(K,{children:[Object(v.jsx)(Nt,{children:Object(v.jsxs)("h1",{children:[this.state.userInfo.username,"\xa0",Object(v.jsx)(o.b,{to:"/chat/user/"+this.state.uid,children:Object(v.jsx)("i",{className:"far fa-comment-alt"})})]})}),Object(v.jsx)(St,{children:Object(v.jsx)("h2",{children:"Gruppen"})})]}):null}},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setUser();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setState({error:4,loaded:!0});case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(d.a)(l.a.mark((function e(t,s,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.uid===this.props.uid){e.next=4;break}return e.next=4,this.setUser();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState({error:4,loaded:!0});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,s,n){return e.apply(this,arguments)}}()}]),s}(n.Component),Ps=(s(219),function(){var e=Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/user/self",t);case 3:if(!(s=e.sent).ok){e.next=10;break}return e.next=7,s.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Error requesting user info!");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),zs=function(){var e=Object(d.a)(l.a.mark((function e(t){var s,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=3,me("/user/setEmail",s);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bs=(s(220),function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).startEdit=function(){n.setState({isEditing:!0})},n.cancelEdit=function(){n.setState({isEditing:!1,value:n.props.value})},n.submitEdit=function(e){e.preventDefault(),n.setState({isEditing:!1}),"function"===typeof n.props.onChange&&n.props.onChange(n.state.value)},n.state={isEditing:!1,value:n.props.value},n}return Object(f.a)(s,[{key:"render",value:function(){var e=this;return Object(v.jsx)("span",{className:"label-edit "+this.props.className,children:this.state.isEditing?Object(v.jsxs)("form",{onSubmit:this.submitEdit,children:[Object(v.jsx)("input",{type:"text",value:this.state.value,style:{width:this.state.value.length+"ch"},onChange:function(t){e.setState({value:t.target.value})}}),"\xa0",Object(v.jsx)("i",{className:"fas fa-check fa-lg",onClick:this.submitEdit}),"\xa0",Object(v.jsx)("i",{className:"fas fa-times fa-lg",onClick:this.cancelEdit})]}):Object(v.jsxs)("span",{onDoubleClick:this.startEdit,children:[this.props.children,"\xa0",Object(v.jsx)("i",{className:"fas fa-pen",onClick:this.startEdit})]})})}}]),s}(n.Component)),Gs=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).changeEmail=function(e){n.state.userDataSelf.email!==e&&zs({email:e}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=7;break}return e.next=3,t.json();case 3:e.sent.emailTaken?(console.log("email taken"),n.setState({emailChangeRequested:!1,setEmailError:!0,setEmailErrorMessage:"E-Mail wird bereits verwendet!"})):n.setState({setEmailError:!1,emailChangeRequested:!0}),e.next=8;break;case 7:n.setState({setEmailError:!0,setEmailErrorMessage:"Fehler beim Versenden der E-Mail!",emailChangeRequested:!1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},n.state={userDataSelf:null,loaded:!1,error:!1,isEditing:!1,emailChangeRequested:!1,setEmailError:!1,setEmailErrorMessage:""},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsxs)(K,{children:[Object(v.jsx)(Nt,{children:Object(v.jsx)("h1",{children:"Einstellungen"})}),Object(v.jsx)(St,{children:this.state.loaded?Object(v.jsxs)("div",{className:"settings",children:[Object(v.jsxs)("span",{className:"settings-header",children:["E-Mail Addresse: ",Object(v.jsx)("br",{})]}),Object(v.jsx)(Bs,{className:"email",value:this.state.userDataSelf.email,onChange:this.changeEmail,children:""===this.state.userDataSelf.email?Object(v.jsx)(K,{children:"Noch keine E-Mail Addresse!"}):Object(v.jsx)(K,{children:this.state.userDataSelf.email})}),this.state.emailChangeRequested?Object(v.jsxs)(K,{children:["\xa0",Object(v.jsx)("span",{className:"emailChanged",children:"Mail mit Verifizierungslink wurde versendet!"})]}):null,this.state.setEmailError?Object(v.jsxs)(K,{children:["\xa0",Object(v.jsx)("span",{className:"set-email-error",children:this.state.setEmailErrorMessage})]}):null,Object(v.jsx)("div",{className:"settings-about",children:Object(v.jsx)(o.b,{to:"/about",children:"\xfcber diese Seite"})})]}):this.state.error?Object(v.jsx)("span",{children:"ein Fehler ist aufgetreten!"}):Object(v.jsx)("span",{children:"laden..."})})]})}},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ps();case 3:t=e.sent,this.setState({loaded:!0,userDataSelf:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({error:!0});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()}]),s}(n.Component);function Ls(e){var t=Object(u.i)().path;return Object(v.jsxs)(u.d,{children:[Object(v.jsxs)(u.b,{path:"".concat(t,"/newChat"),children:[e.children,Object(v.jsx)(Ct,{children:Object(v.jsx)(Ms,{})})]}),Object(v.jsx)(u.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(t){return Object(v.jsxs)(K,{children:[e.children,Object(v.jsx)(Ct,{children:Object(v.jsx)(Rs,{uid:t.match.params.uidInfo})})]})}}),Object(v.jsxs)(u.b,{path:"".concat(t,"/settings"),children:[e.children,Object(v.jsx)(Ct,{children:Object(v.jsx)(Gs,{})})]}),Object(v.jsx)(u.b,{path:"*",children:e.children})]})}function Fs(e){var t=Object(u.i)().path;return Object(v.jsxs)("div",{className:"main-container",children:[Object(v.jsx)("div",{className:"mc-left",children:Object(v.jsx)(nt,{})}),Object(v.jsx)("div",{className:"mc-right",children:Object(v.jsxs)(u.d,{children:[Object(v.jsx)(u.b,{path:"".concat(t,"/user/:uid"),render:function(e){return Object(v.jsx)(Ls,{children:Object(v.jsx)(kt,{uid:e.match.params.uid})})}}),Object(v.jsx)(u.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return Object(v.jsx)(Ls,{children:Object(v.jsx)(is,{gcid:e.match.params.gcid,tab:as})})}}),Object(v.jsx)(u.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return Object(v.jsx)(Ls,{children:Object(v.jsx)(is,{gcid:e.match.params.gcid,tab:cs})})}}),Object(v.jsx)(u.b,{path:t,children:Object(v.jsx)(Ls,{children:Object(v.jsx)("h1",{children:"noch kein chat ausgew\xe4hlt"})})})]})})]})}s(221);var Hs=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).typeStateChanged=function(){var e=tt.getChat(n.props.chatType,n.props.chatId);n.setState({usersTyping:e.getUsersTyping()})},n.state={usersTyping:[]},n}return Object(f.a)(s,[{key:"render",value:function(){return Object(v.jsx)("div",{className:"typeMsg-container",children:this.state.usersTyping.map((function(e,t){return Object(v.jsx)("div",{className:"typeMsg",children:e.username+" schreibt..."},t)}))})}},{key:"componentDidMount",value:function(){tt.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,s){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(tt.getChat(e.chatType,e.chatId).event.rm("typeState changed",this.typeStateChanged),tt.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged))}},{key:"componentWillUnmount",value:function(){tt.getChat(this.props.chatType,this.props.chatId).event.rm("typeState changed",this.typeStateChanged)}}]),s}(n.Component);function Vs(e){var t=Object(u.i)().path;return Object(v.jsxs)(u.d,{children:[Object(v.jsx)(u.b,{path:"".concat(t,"/newChat"),children:Object(v.jsx)(Ms,{})}),Object(v.jsx)(u.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(e){return Object(v.jsx)(Rs,{uid:e.match.params.uidInfo})}}),Object(v.jsx)(u.b,{path:"".concat(t,"/settings"),children:Object(v.jsx)(Gs,{})}),Object(v.jsx)(u.b,{path:"*",children:e.children})]})}function Js(e){var t=Object(u.i)().path,s=Object(i.useGlobal)(),n=Object(z.a)(s,2),r=n[0],a=(n[1],function(){return""!==r.currentChat.type&&0!==r.currentChat.id?Object(v.jsx)(Hs,{chatType:r.currentChat.type,chatId:r.currentChat.id}):null});return Object(v.jsxs)(u.d,{children:[Object(v.jsx)(u.b,{path:"".concat(t,"/user/:uid"),render:function(e){return Object(v.jsxs)(Vs,{children:[Object(v.jsx)("div",{className:"main-container",children:Object(v.jsx)(kt,{uid:e.match.params.uid})}),a()]})}}),Object(v.jsx)(u.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return Object(v.jsxs)(Vs,{children:[Object(v.jsx)("div",{className:"main-container",children:Object(v.jsx)(is,{gcid:e.match.params.gcid,tab:as})}),a()]})}}),Object(v.jsx)(u.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return Object(v.jsx)(Vs,{children:Object(v.jsx)(is,{gcid:e.match.params.gcid,tab:cs})})}}),Object(v.jsx)(u.b,{path:t,children:Object(v.jsx)(Vs,{children:Object(v.jsx)("div",{className:"chat-list-outer-small",children:Object(v.jsx)(nt,{})})})}),Object(v.jsx)(u.b,{path:"*",children:Object(v.jsx)("h3",{children:"Not found!"})})]})}s(222);var Ws=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).state={modal:0,modalInfo:null,notifications:0},n}return Object(f.a)(s,[{key:"componentDidMount",value:function(){tt.initCalled||tt.init().then((function(e){}))}},{key:"render",value:function(){return Object(v.jsxs)("div",{className:"h-100",children:[Object(v.jsx)(ie,{}),Object(v.jsx)($,{displayIn:["Mobile"],children:Object(v.jsx)(Js,{})}),Object(v.jsx)($,{displayIn:["Laptop","Tablet"],children:Object(v.jsx)(Fs,{})})]})}}]),s}(n.Component);s(223);function qs(){return Object(v.jsxs)("div",{className:"about",children:[Object(v.jsx)("h2",{children:"\xdcber diese Seite"}),Object(v.jsx)("h4",{children:"Erstellt von:"}),"Stefan Schlaghuber",Object(v.jsx)("br",{}),"2002 Gro\xdfmugl",Object(v.jsx)("br",{}),"stefan.schlaghuber@gmail.com",Object(v.jsx)("br",{})]})}s(224),s(225);function Ys(e){return Zs.apply(this,arguments)}function Zs(){return(Zs=Object(d.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,me("/user/self",s,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $s(){Object(i.addReducer)("deleteAuthTokens",(function(e,t){return localStorage.removeItem("authTokens"),location.reload(),t.deleteUserSelf(),t.resetGlobal(),et.destruct(),et=new Xe,{loaded:!0,authTokens:void 0}})),Object(i.addReducer)("initAuthTokens",function(){var e=Object(d.a)(l.a.mark((function e(t,s,n){var r,a,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Re();case 3:return e.next=5,Ys(n);case 5:if(403!==(r=e.sent).status){e.next=11;break}return localStorage.removeItem("authTokens"),e.abrupt("return",{loaded:!0,authTokens:void 0});case 11:return e.next=13,r.json();case 13:return a=e.sent,c=a.uid,i=a.username,s.setUserSelf(c,i),e.abrupt("return",{loaded:!0,authTokens:n});case 17:e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{loaded:!1});case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,s,n){return e.apply(this,arguments)}}()),Object(i.addReducer)("setAuthTokens",(function(e,t,s){return localStorage.setItem("authTokens",JSON.stringify(s)),{loaded:!0,authTokens:s}}))}var Ks=function(e){Object(m.a)(s,e);var t=Object(b.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;n.setState(Object(p.a)({},t,s))},n.submitHandler=function(e){e.preventDefault();var t=O()({password:n.state.password,passwordRepeat:n.state.passwordRepeat},{password:{presence:!0,length:{minimum:8,tooShort:"Passwort muss mindestens 8 Zeichen lang sein",maximum:50,tooLong:"Passwort darf h\xf6chstens 50 Zeichen lang sein"}},passwordRepeat:{presence:!0,equality:"password",length:{minimum:8,tooShort:"Passwort muss mindestens 8 Zeichen lang sein",maximum:50,tooLong:"Passwort darf h\xf6chstens 50 Zeichen lang sein"}}});if("undefined"!=typeof t){var s;"undefined"!=typeof t.password?s=t.password[0]:"undefined"!=typeof t.passwordRepeat&&(s="Passw\xf6rter stimmen nicht \xfcberein!"),s=s.replace("Username ","").replace("Password ",""),n.setState({error:!0,errorMessage:s})}else{var r=n.state.password;E(n.props.verificationCode,r).then((function(e){200===e.status?n.setState({error:!1,passwordResetSuccess:!0}):403===e.status?n.setState({error:!0,errorMessage:"Fehler: Dieser Link ist ung\xfcltig!"}):n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})})).catch((function(e){n.setState({error:!0,errorMessage:"ein Fehler ist aufgetreten"})}))}},n.errorMessage=function(){if(n.state.error)return Object(v.jsx)(x,{children:n.state.errorMessage})},n.successMessage=function(){if(n.state.passwordResetSuccess)return Object(v.jsx)(y,{children:"Passwort erfolgreich zur\xfcckgesetzt!"})},n.componentDidMount=function(){T(n.props.verificationCode).then((function(e){200!==e.status&&n.setState({linkValid:!1})})).catch((function(e){n.setState({linkValid:!1})}))},n.state={linkValid:!0,error:!1,errorMessage:"",password:"",passwordRepeat:"",passwordResetSuccess:!1},n}return Object(f.a)(s,[{key:"render",value:function(){return this.state.linkValid?Object(v.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(v.jsx)("div",{className:"col-sm-12 my-auto",children:Object(v.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(v.jsx)(_,{}),Object(v.jsx)("h1",{children:"neues Passwort eingeben"}),this.errorMessage(),Object(v.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"password",children:"Passwort:"}),Object(v.jsx)(w,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(v.jsxs)("div",{className:"form-group",children:[Object(v.jsx)("label",{htmlFor:"passwordRepeat",children:"Passwort wiederholen:"}),Object(v.jsx)(w,{name:"passwordRepeat",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),this.successMessage(),Object(v.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Passwort zur\xfccksetzen"})]})]})})}):Object(v.jsx)(x,{children:"Ung\xfcltiger Link!"})}}]),s}(i.Component);function Qs(){var e=Object(i.useDispatch)();return Object(i.useEffect)((function(){var t=JSON.parse(localStorage.getItem("authTokens"));e.initAuthTokens(t)}),[]),Object(v.jsx)(o.a,{children:Object(v.jsxs)(u.d,{children:[Object(v.jsx)(G,{path:"/chat",component:Ws}),Object(v.jsx)(u.b,{exact:!0,path:"/login",component:D}),Object(v.jsx)(u.b,{exact:!0,path:"/register",component:I}),Object(v.jsx)(u.b,{path:"/verifyEmail/:code",render:function(e){return Object(v.jsx)(R,{verificationCode:e.match.params.code})}}),Object(v.jsx)(u.b,{exact:!0,path:"/forgotPassword",component:P}),Object(v.jsx)(u.b,{path:"/resetPassword/:code",render:function(e){return Object(v.jsx)(Ks,{verificationCode:e.match.params.code})}}),Object(v.jsx)(u.b,{path:"/about",children:Object(v.jsx)(qs,{})}),Object(v.jsx)(u.b,{exact:!0,path:"/",children:Object(v.jsx)(u.a,{to:"/chat"})}),Object(v.jsx)(u.b,{path:"*",children:Object(v.jsx)(Xs,{})})]})})}function Xs(){var e=Object(u.h)();return Object(v.jsx)("div",{children:Object(v.jsxs)("h3",{children:["No match for ",Object(v.jsx)("code",{children:e.pathname})]})})}Object(i.setGlobal)({loaded:!1,authTokens:void 0,userSelf:{},infoHeaderCenter:Q,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}),function(){function e(e){Object(i.setGlobal)({chats:e})}tt.finishedLoading?e(tt.getChatArraySortedByDate()):tt.event.on("chats loaded",e)}(),Object(i.addReducer)("setUserSelf",(function(e,t,s,n){return{userSelf:{uid:s,username:n}}})),Object(i.addReducer)("deleteUserSelf",(function(e,t){return{userSelf:{}}})),Object(i.addReducer)("resetGlobal",(function(e,t){return{infoHeaderCenter:Q,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}})),function(){var e=this;function t(e,t){return e.chats.findIndex((function(e){return e.id===t.id&&e.type===t.type}))}Object(i.addReducer)("newMsg",(function(e,s,n,r,a){var c=t(e,n);if(-1!==c){if(function(e,t){var s=e.currentChat;return s.type===t.type&&s.id===t.id}(e,n)){var i=e.chats.splice(0),o=i[c];return o.latestMessage=n.getLatestMessageObject(),o.unreadMessages=0,i.splice(c,1),i.unshift(o),{chats:i,currentChat:Object(k.a)(Object(k.a)({},e.currentChat),{},{messages:e.currentChat.messages.concat(a),newMessages:e.currentChat.newMessages+1})}}var u=e.chats.splice(0),h=u[c];h.latestMessage=n.getLatestMessageObject();var l=e.newMessages;return 0===h.unreadMessages&&l++,h.unreadMessages=r+1,u.splice(c,1),u.unshift(h),{chats:u,newMessages:l}}})),Object(i.addReducer)("selectChat",(function(e,s,n){var r=t(e,n);if(-1!==r){var a=e.chats.splice(0),c=a[r],i=e.newMessages;return c.unreadMessages>0&&i--,c.unreadMessages=0,a[r]=c,tt.socket.emit("change chat",{type:n.type,id:n.id}),{currentChat:{type:n.type,id:n.id,messages:n.getMessages(),newMessages:0},chats:a,tempChat:null,newMessages:i}}})),Object(i.addReducer)("selectNoChat",(function(e,t){return tt.socket.emit("change chat",null),{currentChat:{type:"",id:0,messages:[]}}})),Object(i.addReducer)("addLoadedMessages",(function(e,t,s){return{currentChat:Object(k.a)(Object(k.a)({},e.currentChat),{},{messages:s?s.concat(e.currentChat.messages):e.currentChat.messages})}})),Object(i.addReducer)("addChat",(function(e,t,s){var n,r,a=e.chats.splice(0),c=s.getChatObject();if(0===a.length)return{chats:[c]};for(var i=0;i<a.length;i++)if(r=c,!(n=a[i]).latestMessage||r.latestMessage&&n.latestMessage.date.getTime()<r.latestMessage.date.getTime()){a.splice(i,0,c);break}return{chats:a}})),Object(i.addReducer)("removeChat",(function(s,n,r){var a=t(s,r),c=e.state.chats.splice(0);return c.splice(a,1),{chats:c}})),Object(i.addReducer)("showTempChat",(function(e,t){var s=tt.temporaryChat.chatNow;return tt.socket.emit("change chat",null),{tempChat:s.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("updateTempChat",(function(e,t,s){return{tempChat:s.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(i.addReducer)("hideTempChat",(function(e,t){return{tempChat:null}}))}(),$s();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(Qs,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[226,1,2]]]);
//# sourceMappingURL=main.991f54ff.chunk.js.map