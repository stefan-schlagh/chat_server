{"version":3,"sources":["Auth/MsgBox.js","Auth/TogglePassword.js","Auth/apiCalls.js","Auth/Login.js","Auth/BackToLogin.js","Auth/Register.js","Auth/VerifyEmail.js","Auth/ForgotPassword.js","utilComp/PrivateRoute.js","responsive/utilResponsive.js","responsive/Responsive.js","utilComp/Dummy.js","Home/Header/HeaderLeft.js","Home/Header/Header.js","Home/allChats/ChatSearchBox.js","util/Color.js","util/BinSearch.js","global/requests.js","chatData/apiCalls.js","chatData/User.js","global/globalData.js","Home/chatView/chatContainer/message/NormalMessage.js","Home/chatView/chatContainer/message/StatusMessage.js","Home/chatView/chatContainer/message/Message.js","chatData/message/statusMessage.js","chatData/message/message.js","util/Event.js","chatData/chat/chat.js","chatData/chat/normalChat.js","chatData/chat/groupChat.js","chatData/tempChatLoader.js","chatData/chatSocket.js","Home/allChats/ChatItem.js","Home/allChats/ChatList.js","Home/chatView/ChatViewLoader.js","Home/chatView/apiCalls.js","Home/chatView/chatContainer/MessageForm.js","Home/chatView/chatContainer/ChatContainer.js","Home/chatView/TempChatContainer.js","Home/chatView/chatViewErrorMessages.js","Home/chatView/NormalChatView.js","utilComp/Modal.js","Home/selectUsers/UserItem.js","Home/selectUsers/UserList.js","Home/selectUsers/SelectUsers.js","Home/chatView/groupChatInfo/apiCalls.js","Home/chatView/groupChatInfo/AddUsers.js","Home/chatView/groupChatInfo/UserOptions.js","Home/chatView/groupChatInfo/ChatOptions.js","Home/chatView/groupChatInfo/edit/inlineEdit.js","Home/chatView/groupChatInfo/edit/editDescription.js","Home/chatView/groupChatInfo/edit/editChatName.js","Home/chatView/groupChatInfo/GroupChatInfo.js","Home/chatView/groupChatInfo/ModalRouterGroupChatInfo.js","Home/chatView/GroupChatView.js","Home/selectChat/UserItem.js","Home/selectChat/SelectChat.js","Home/newChat/apiCalls.js","Home/newChat/chooseUser/ChooseUser.js","img/placeholder.png","Home/newChat/newGroup/GroupInfoForm.js","Home/newChat/newGroup/NewGroup.js","Home/newChat/NewChat.js","Home/userInfo/userInfoApiCalls.js","Home/userInfo/UserInfo.js","Home/settings/apiCalls.js","util/EditableLabel.js","Home/settings/Settings.js","Home/ModalRouterBigScreens.js","Home/GridBigScreens.js","Home/chatView/TypeMsgContainer.js","Home/ModalRouterSmallScreens.js","Home/RouterSmallScreens.js","Home/Home.js","About/About.js","global/apiCalls.js","global/authTokens.js","Auth/ResetPassword.js","App.js","global/global.js","global/initChats.js","global/chats.js","serviceWorker.js","index.js"],"names":["ErrorMsg","className","this","props","children","Component","SuccessMsg","TogglePassword","state","showPassword","onClick","setState","type","login","username","password","a","config","method","headers","body","JSON","stringify","fetch","register","verifyEmail","verificationCode","requestPasswordResetLink","email","isVerificationCodeValid","setPassword","code","Login","changeHandler","event","nam","target","name","val","value","submitHandler","preventDefault","errorMessage","valConstraints","presence","length","minimum","tooShort","maximum","tooLong","format","pattern","RegExp","message","valResult","validate","replace","error","valid","uNameErr","pwErr","then","response","status","json","data","dispatch","setUserSelf","uid","setAuthTokens","tokens","history","push","catch","err","redirect","style","display","maxWidth","onSubmit","htmlFor","placeholder","onChange","to","withRouter","BackToLogin","Register","passwordRepeat","equality","usernameTaken","VerifyEmail","componentDidMount","loading","success","ForgotPassword","sentMail","successMessage","PrivateRoute","component","rest","useGlobal","global","render","loaded","authTokens","pathname","referer","location","IdDeviceBreakpointsByWidth","IdMobileHeight","getWindowDimension","width","window","innerWidth","document","documentElement","clientWidth","height","innerHeight","clientHeight","initialState","Responsive","displayIn","shouldRenderChildren","shouldRender","Fragment","handleResize","indexOf","addEventListener","removeEventListener","React","PureComponent","Dummy","didMount","prevProps","prevState","snapshot","didUpdate","infoHeaderCenter","HeaderLeft","id","goBack","newMessages","HeaderCenter","ihcData","data-toggle","title","gcid","renderChatInfo","Header","clickCheckBox","checkBoxClicked","stopPropagation","setTimeout","clickDocument","changeChecked","logout","deleteAuthTokens","checked","userSelf","BottomToolTip","text","placement","trigger","overlay","ChatSearchBox","searchChanged","onSearch","Colors","aqua","black","blue","brown","cyan","darkblue","darkcyan","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkviolet","fuchsia","gold","green","indigo","khaki","lightblue","lightgreen","lightgrey","lightpink","lime","magenta","maroon","navy","olive","orange","pink","purple","violet","red","silver","result","count","prop","names","Math","random","BinSearchArray","key","left","right","k","floor","i","getIndex","splice","getNearestKey","Array","makeRequest","tokensP","getGlobal","configI","getDispatch","Error","selectChats","createNormalChat","selectUser","loadMessages","UserErrorCode","chatSocket","users","get","normalChat","user","temporaryChat","createNew","doesExist","ok","userExists","blocked","User","_normalChat","_groupChats","color","groupChats","add","remove","_uid","_username","_color","globalData","fetchData","NormalMessage","msg","bySelf","userTop","UsernameSpan","content","mDateString","StatusMessage","StatusMsgContent","getStatusMessageString","Message","messageTypes","normalMessage","statusMessage","middleStringD","statusMessagesD","useReact","passiveUsers","statusMessageTypes","chatCreated","renderStringD","usersAdded","usersRemoved","usersJoined","usersLeft","usersMadeAdmin","usersRemovedAdmin","getStatusMessageStringD","middle","getMiddleString","getPassiveUsers","getTString","mid","chat","date","Date","now","userTopShown","getMessageViewDateString","dateString","getDateString","getUserTop","isBySelf","isDateToday","getTimeString","isDateYesterday","msgString","substr","getMessageObject","dateNow","getDate","getMonth","getFullYear","ds","d","ms","m","y","hs","h","getHours","getMinutes","date2","getDay","_mid","_date","_chat","_type","_content","EventHandler","events","Map","fn","has","set","e","_events","Chat","chatName","_messages","_event","_unreadMessages","_reachedTopMessages","messageData","empty","messages","num","reachedTopMessages","getLastMsgId","getLastMessage","chatType","chatId","lastMsgId","lMessages","showUserInfoMessage","rMessages","newMsg","unreadMessages","latestMessage","getLatestMessageObject","lm","getFirstMessage","getChatViewMsgString","getChatViewDateString","_id","_chatName","NormalChat","_isTyping","otherUser","isTyping","_otherUser","GroupChat","uids","_users","_usersTyping","usersTyping","rc","isMember","getIndexOfTyping","find","findIndex","TempChatLoader","_isShown","chatNow","undefined","isShown","showTempChat","updateTempChat","hideTempChat","otherUid","otherUsername","mentions","media","newChat","ncid","chats","normal","addChat","selectChat","hide","_chatNow","ChatSocket","_userSelf","_chats","group","_finishedLoading","_temporaryChat","_initCalled","socket","removeAllListeners","disconnect","initCalled","userInfo","io","connect","secure","emit","on","initChats","getChat","isCurrentChat","addMessage","hasNewMsg","startedTyping","stoppedTyping","addNewChat","alert","reload","addNewNormalChat","addNewGroupChat","finishedLoading","getChatArraySortedByDate","getMessageTime","c","getTime","getMaxDate","iFrom","max","swap","items","firstIndex","secondIndex","temp","getSorted","sorted","arr","clone","getChatObject","cloneArr","arr1","arr2","merged","p1","p2","mergeArr","currentChat","members","initFirstMessage","firstMessage","member","addGroupChat","_socket","ChatItem","isSelected","typeStateChanged","typeMsg","userTyping","getLatestUserTyping","lastMsg","renderMsg","renderDate","rm","ChatList","searchValue","found","tempChat","map","includes","ChatViewLoader","borderWidth","role","loadGroupChat","sendMessage","MessageForm","_userTyping","_typeEventEmitted","onTyping","handleTypeMessage","isTempChat","clearTimeout","typeTimeout","typeEventEmitted","createNewNormalChat","onEmojiInput","emoji","native","toggleEmoji","showEmoji","autoComplete","position","bottom","onSelect","_typeTimeout","_isTempChat","ChatContainer","_isMounted","scrollHandler","scrollToBottom","getScrollToBottom","messagesNode","scrollTop","setScrollToBottom","scrollHeight","offsetHeight","assignMessagesRef","msgLoading","addLoadedMessages","chatChanged","bind","typeMessages","ReactDOM","findDOMNode","isMounted","setGlobal","lastDate","renderDateContainer","date1","onScroll","ref","_messagesNode","TempChatContainer","show","update","AddressNotValid","CannotWriteYourself","BlockedByThisUser","UserNotExisting","NoMemberInPublicChat","NoAuthorization","ChatNotExisting","GeneralError","NormalChatView","userChanged","parseInt","getUserNormalChat","res","selectNormalChat","selectTempChat","renderLoader","isNaN","Modal","ModalHeader","ModalMain","UserItem","clicked","deselectUser","index","errorCode","lastRequest","searchResult","hasMore","loadUsers","concat","scrollParentRef","pageStart","loadMore","loader","useWindow","getScrollParent","item","isUserSelected","SelectUsers","selectedUsers","arrClone","deselectIndex","btnNextClicked","onNext","showOnlySelected","addMembers","fetchUsersNotInGroup","leaveChat","removeSelfAdmin","AddUsers","useHistory","submitUsers","numAlreadyLoaded","search","limit","start","UserOptions","isSelfAdmin","memberSelf","isAdmin","removeMemberFromChat","makeMemberAdmin","removeMemberAdmin","isMemberSelf","ChatOptions","useLocation","console","log","Edit","handleEdit","isEditing","editPressed","class","changeCallback","optClass","DescriptionEdit","description","ChatNameEdit","GroupChatInfo","uidSelf","animation","alignPoint","ModalRouterGroupChatInfo","path","useRouteMatch","groupChatInfo","groupChatErrorCode","groupChatTabs","GroupChatView","loadGroupChatInfo","chatData","chatExists","r","selectGroupChat","tab","renderChat","elementClicked","SelectChat","loadChats","showOptions","showSearchBar","requestUsersNoChat","createGroupChat","fetchUsers","ChooseUser","newGroupClick","setCurrentTab","tabs","newGroup","joinGroupClick","chooseGroup","searchValid","options","GroupInfoForm","groupNameChanged","groupName","descriptionChanged","isPublicChanged","isPublic","formSubmitted","submitGroup","src","alt","minLength","rows","NewGroup","showEnterChatInfo","currentTab","chooseUser","NewChat","newTab","getHeader","router","fetchUserInfo","UserInfo","setUser","getUserSelf","setEmail","EditableLabel","startEdit","cancelEdit","submitEdit","onDoubleClick","Settings","changeEmail","userDataSelf","emailTaken","emailChangeRequested","setEmailError","setEmailErrorMessage","ModalRouterBigScreens","routeProps","match","params","uidInfo","GridBigScreens","TypeMsgContainer","getUsersTyping","ModalRouterSmallScreens","RouterSmallScreens","renderTypeMsgContainer","modal","modalInfo","notifications","init","About","reqUserSelf","addReducer","localStorage","removeItem","deleteUserSelf","resetGlobal","destruct","existingTokens","setItem","ResetPassword","passwordResetSuccess","linkValid","App","useDispatch","useEffect","parse","getItem","initAuthTokens","exact","NoMatch","chatsLoaded","element","chatsClone","chatObject","unshift","getMessages","chat1","chat2","initChatReducers","Boolean","hostname","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.66e8d7f7.chunk.js","sourcesContent":["import React,{Component} from \"react\";\r\n\r\nclass ErrorMsg extends Component{\r\n    render() {\r\n        return(\r\n            <small className=\"alert alert-danger p-1 message d-block\">\r\n                {this.props.children}\r\n            </small>\r\n        )\r\n    }\r\n}\r\nclass SuccessMsg extends Component{\r\n    render() {\r\n        return(\r\n            <small className=\"alert alert-success p-1 message d-block\">\r\n                {this.props.children}\r\n            </small>\r\n        )\r\n    }\r\n}\r\n\r\nexport {ErrorMsg,SuccessMsg};","import React,{Component} from \"react\";\r\n\r\nimport \"./TogglePassword.scss\"\r\n\r\nexport default class TogglePassword extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showPassword: false\r\n        }\r\n    }\r\n    render() {\r\n        return(\r\n            <div className=\"psw-group\">\r\n                <i className={(this.state.showPassword ? \"fa-eye-slash\" : \"fa-eye\") + \" fas psw-toggle-icon\"}\r\n                   onClick={() => this.setState(state => ({showPassword: !state.showPassword}))}\r\n                />\r\n                <input type={this.state.showPassword ? \"text\" : \"password\"}\r\n                       {...this.props}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n}","export const login = async (username,password) => {\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            username: username,\r\n            password: password\r\n        })\r\n    };\r\n    return  await fetch('/auth/login', config);\r\n};\r\n\r\nexport const register = async(username,password) => {\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            username: username,\r\n            password: password\r\n        })\r\n    };\r\n    return await fetch('/auth/register', config);\r\n};\r\n\r\nexport const verifyEmail = async(verificationCode) => {\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n        }\r\n    };\r\n    return await fetch('/user/verifyEmail/' + verificationCode, config);\r\n};\r\n\r\nexport const requestPasswordResetLink = async (username,email) => {\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            username: username,\r\n            email: email\r\n        })\r\n    };\r\n    return await fetch('/pwReset/requestLink',config);\r\n}\r\n\r\nexport const isVerificationCodeValid = async(verificationCode) => {\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n        }\r\n    };\r\n    return await fetch('/pwReset/isValid/' + verificationCode, config);\r\n};\r\n\r\nexport const setPassword = async (code,password) => {\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            code: code,\r\n            password: password\r\n        })\r\n    };\r\n    return await fetch('/pwReset/set',config);\r\n}","import React,{Component} from \"reactn\";\r\nimport {\r\n    Link,\r\n    withRouter\r\n} from \"react-router-dom\";\r\nimport validate from \"validate.js\";\r\nimport {ErrorMsg} from \"./MsgBox\";\r\nimport TogglePassword from \"./TogglePassword\";\r\nimport {login} from \"./apiCalls\";\r\n\r\nclass Login extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: false,\r\n            errorMessage: '',\r\n            username: '',\r\n            password: '',\r\n            redirect: false\r\n        };\r\n    }\r\n    changeHandler = event => {\r\n        let nam = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[nam]: val});\r\n    };\r\n    submitHandler = event => {\r\n        event.preventDefault();\r\n        /*\r\n            constraints für validation\r\n         */\r\n        const  valConstraints = {\r\n            username: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 3,\r\n                    tooShort: 'Benutzername zu kurz',\r\n                    maximum: 30,\r\n                    tooLong: 'Benutzername zu lang'\r\n                },\r\n                format: {\r\n                    pattern: new RegExp(/^\\w[\\w ]*$$/),\r\n                    message: 'ungültiges Format'\r\n                }\r\n            },\r\n            password: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 8,\r\n                    tooShort: 'Passwort muss mindestens 8 Zeichen lang sein',\r\n                    maximum: 50,\r\n                    tooLong: 'Passwort darf höchstens 50 Zeichen lang sein'\r\n                }\r\n            },\r\n        };\r\n        /*\r\n            validate\r\n         */\r\n        const valResult = validate({\r\n            username: this.state.username,\r\n            password: this.state.password\r\n        },valConstraints);\r\n\r\n        if(typeof(valResult) != \"undefined\"){\r\n\r\n            let errorMessage;\r\n\r\n            if(typeof(valResult.username) != \"undefined\") {\r\n                errorMessage = valResult.username[0];\r\n            }else if(typeof(valResult.password) != \"undefined\") {\r\n                errorMessage = valResult.password[0];\r\n            }\r\n            errorMessage = errorMessage.replace(\"Username \",\"\").replace(\"Password \",\"\");\r\n\r\n            this.setState({\r\n                error: true,\r\n                errorMessage: errorMessage\r\n            });\r\n\r\n        }else {\r\n            this.setState({\r\n                valid: true,\r\n                uNameErr: '',\r\n                pwErr: ''\r\n            });\r\n           /*\r\n                request to server\r\n            */\r\n           login(this.state.username,this.state.password)\r\n               .then(async response => {\r\n                   // success\r\n                   if(response.status === 200){\r\n                       const data = await response.json();\r\n                       this.dispatch.setUserSelf(data.uid,this.state.username);\r\n                       // set auth tokens\r\n                       this.dispatch.setAuthTokens(data.tokens);\r\n                       // go to chat home\r\n                       this.props.history.push('/chat');\r\n                   // wrong password\r\n                   }else if(response.status === 403){\r\n                       this.setState({\r\n                           error: true,\r\n                           errorMessage: 'Falsches Passwort!'\r\n                       });\r\n                   // user does not exit\r\n                   }else if(response.status === 404){\r\n                       this.setState({\r\n                           error: true,\r\n                           errorMessage: 'Falscher Benutzername E-Mail Addresse'\r\n                       });\r\n                   }else {\r\n                       this.setState({\r\n                           error: true,\r\n                           errorMessage: 'ein Fehler ist aufgetreten'\r\n                       });\r\n                   }\r\n               })\r\n               .catch(err => {\r\n                   this.setState({\r\n                       error: true,\r\n                       errorMessage: 'ein Fehler ist aufgetreten'\r\n                   });\r\n               });\r\n        }\r\n\r\n    };\r\n    errorMessage = () => {\r\n        if(this.state.error)\r\n            return (\r\n                <ErrorMsg>\r\n                    {this.state.errorMessage}\r\n                </ErrorMsg>\r\n            )\r\n    };\r\n\r\n    render(){\r\n\r\n        return(\r\n            <div className=\"h-100\" style={{display: \"flex\"}}>\r\n                <div className=\"col-sm-12 my-auto\">\r\n                    <div className=\"container border rounded p-3\" style={{maxWidth: \"800px\"}}>\r\n                        <h1>Login</h1>\r\n                        {this.errorMessage()}\r\n                        <form onSubmit={this.submitHandler}>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"username\">Benutzername:</label>\r\n                                <input type=\"text\"\r\n                                       name=\"username\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"Benutzernamen eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"password\">Passwort:</label>\r\n                                <TogglePassword\r\n                                       name=\"password\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"Passwort eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                haben Sie noch keinen Account? <Link to=\"/register\">Jetzt registrieren</Link>\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                Passwort vergessen? <Link to=\"/forgotPassword\">Jetzt zurücksetzen</Link>\r\n                            </div>\r\n                            <input\r\n                                type=\"submit\"\r\n                                className=\"btn btn-primary\"\r\n                                value=\"Login\"\r\n                            />\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withRouter(Login);","import React from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nimport \"./BackToLogin.scss\";\r\n\r\nexport default function BackToLogin(){\r\n    return(\r\n        <h5 className={\"back-to-login\"}>\r\n            <Link to={\"/login\"}>\r\n                <i className=\"fas fa-arrow-left\"/>\r\n                &nbsp;\r\n                zurück zu login\r\n            </Link>\r\n        </h5>\r\n    )\r\n}","import React,{Component} from \"reactn\";\r\nimport validate from \"validate.js\";\r\nimport {ErrorMsg} from \"./MsgBox\";\r\nimport {withRouter} from \"react-router-dom\";\r\nimport TogglePassword from \"./TogglePassword\";\r\nimport {register} from \"./apiCalls\";\r\nimport BackToLogin from \"./BackToLogin\";\r\n\r\nclass Register extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: false,\r\n            errorMessage: '',\r\n            username: '',\r\n            password: '',\r\n            passwordRepeat: '',\r\n            redirect: false\r\n        }\r\n    }\r\n    changeHandler = event => {\r\n        let nam = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[nam]: val});\r\n    };\r\n    submitHandler = event => {\r\n        event.preventDefault();\r\n        /*\r\n            constraints für validation\r\n         */\r\n        const  valConstraints = {\r\n            username: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 3,\r\n                    tooShort: 'Benutzername zu kurz',\r\n                    maximum: 30,\r\n                    tooLong: 'Benutzername zu lang'\r\n                },\r\n                format: {\r\n                    pattern: new RegExp(/^\\w[\\w ]*$$/),\r\n                    message: 'ungültiges Format'\r\n                }\r\n            },\r\n            password: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 8,\r\n                    tooShort: 'Passwort muss mindestens 8 Zeichen lang sein',\r\n                    maximum: 50,\r\n                    tooLong: 'Passwort darf höchstens 50 Zeichen lang sein'\r\n                }\r\n            },\r\n            passwordRepeat: {\r\n                presence: true,\r\n                equality: \"password\",\r\n                length: {\r\n                    minimum: 8,\r\n                    tooShort: 'Passwort muss mindestens 8 Zeichen lang sein',\r\n                    maximum: 50,\r\n                    tooLong: 'Passwort darf höchstens 50 Zeichen lang sein'\r\n                }\r\n            }\r\n        };\r\n        /*\r\n            validate\r\n         */\r\n        const valResult = validate({\r\n            username: this.state.username,\r\n            password: this.state.password,\r\n            passwordRepeat: this.state.passwordRepeat\r\n        },valConstraints);\r\n\r\n        if(typeof(valResult) != \"undefined\"){\r\n\r\n            let errorMessage;\r\n\r\n            if(typeof(valResult.username) != \"undefined\") {\r\n                errorMessage = valResult.username[0];\r\n            }else if(typeof(valResult.password) != \"undefined\") {\r\n                errorMessage = valResult.password[0];\r\n            }else if(typeof(valResult.passwordRepeat)!=\"undefined\") {\r\n                errorMessage = \"Passwörter stimmen nicht überein!\"\r\n            }\r\n            errorMessage = errorMessage.replace(\"Username \",\"\").replace(\"Password \",\"\");\r\n\r\n            this.setState({\r\n                error: true,\r\n                errorMessage: errorMessage\r\n            });\r\n\r\n        }else {\r\n            this.setState({\r\n                error: false,\r\n                errorMessage: ''\r\n            });\r\n            /*\r\n                request to server\r\n             */\r\n            register(this.state.username,this.state.password)\r\n                .then(async response => {\r\n                    if(response.status === 200){\r\n\r\n                        const data = await response.json();\r\n                        // if username taken --> show error message\r\n                        if(data.usernameTaken){\r\n                            this.setState({\r\n                                error: true,\r\n                                errorMessage: 'Benutzername bereits vergeben'\r\n                            });\r\n                        }else{\r\n                            this.dispatch.setUserSelf(data.uid,this.state.username);\r\n                            // set auth tokens\r\n                            this.dispatch.setAuthTokens(data.tokens);\r\n                            // go to chat home\r\n                            this.props.history.push('/chat');\r\n                        }\r\n                    }else {\r\n                        this.setState({\r\n                            error: true,\r\n                            errorMessage: 'ein Fehler ist aufgetreten'\r\n                        });\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    this.setState({\r\n                        error: true,\r\n                        errorMessage: 'ein Fehler ist aufgetreten'\r\n                    });\r\n                });\r\n        }\r\n    };\r\n    errorMessage = () => {\r\n        if(this.state.error)\r\n            return (\r\n                <ErrorMsg>\r\n                    {this.state.errorMessage}\r\n                </ErrorMsg>\r\n            )\r\n    };\r\n\r\n    render(){\r\n\r\n        return (\r\n            <div className=\"h-100\" style={{display: \"flex\"}}>\r\n                <div className=\"col-sm-12 my-auto\">\r\n                    <div className=\"container border rounded p-3\" style={{maxWidth: \"800px\"}}>\r\n                        <BackToLogin/>\r\n                        <h1>Registrieren</h1>\r\n                        {this.errorMessage()}\r\n                        <form onSubmit={this.submitHandler}>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"username\">Benutzername:</label>\r\n                                <input type=\"text\"\r\n                                       name=\"username\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"Benutzernamen eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"password\">Passwort:</label>\r\n                                <TogglePassword\r\n                                       name=\"password\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"Passwort eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"passwordRepeat\">Passwort wiederholen:</label>\r\n                                <TogglePassword\r\n                                    name=\"passwordRepeat\"\r\n                                    className=\"form-control\"\r\n                                    placeholder=\"Passwort eingeben\"\r\n                                    onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <input type=\"submit\" className=\"btn btn-primary\" value=\"Registrieren\"/>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withRouter(Register);","import React,{Component} from \"reactn\";\r\nimport {verifyEmail} from \"./apiCalls\";\r\nimport \"./VerifyEmail.scss\";\r\n\r\nexport default class VerifyEmail extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n            error: false,\r\n            success: false\r\n        }\r\n    }\r\n\r\n    render(){\r\n        if(this.state.loading){\r\n            return null;\r\n        } else if(this.state.error){\r\n            return(\r\n                <div className=\"h-100 verifyEmail error\">\r\n                    <h3>\r\n                        Fehler!\r\n                    </h3>\r\n                </div>\r\n            )\r\n        } else if(!this.state.success){\r\n            return(\r\n                <div className=\"h-100 verifyEmail\">\r\n                    <h3>\r\n                        Ungültiger Verifizierungscode!\r\n                    </h3>\r\n                </div>\r\n            )\r\n        } else{\r\n            return(\r\n                <div className=\"h-100 verifyEmail\">\r\n                    <h3>\r\n                    E-Mail Addresse erfolgreich verifiziert!\r\n                    </h3>\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        verifyEmail(this.props.verificationCode)\r\n            .then(response => {\r\n                this.setState({\r\n                    loading: false,\r\n                    success: response.status === 200\r\n                });\r\n            })\r\n            .catch(err => {\r\n                this.setState({\r\n                    loading: false,\r\n                    error: true\r\n                });\r\n            });\r\n    }\r\n}","import React,{Component} from \"reactn\";\r\nimport {requestPasswordResetLink} from \"./apiCalls\";\r\nimport {ErrorMsg, SuccessMsg} from \"./MsgBox\";\r\nimport validate from \"validate.js\";\r\nimport BackToLogin from \"./BackToLogin\";\r\n\r\nexport default class ForgotPassword extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: false,\r\n            errorMessage: '',\r\n            username: '',\r\n            email: '',\r\n            sentMail: false\r\n        };\r\n    }\r\n    changeHandler = event => {\r\n        let nam = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[nam]: val});\r\n    };\r\n    submitHandler = event => {\r\n        event.preventDefault();\r\n        /*\r\n            constraints für validation\r\n         */\r\n        const  valConstraints = {\r\n            username: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 3,\r\n                    tooShort: 'Benutzername zu kurz',\r\n                    maximum: 30,\r\n                    tooLong: 'Benutzername zu lang'\r\n                },\r\n                format: {\r\n                    pattern: new RegExp(/^\\w[\\w ]*$$/),\r\n                    message: 'ungültiges Format'\r\n                }\r\n            },\r\n            email: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 1,\r\n                    tooShort: 'E-Mail Addresse benötigt'\r\n                }\r\n            }\r\n        };\r\n        /*\r\n            validate\r\n         */\r\n        const valResult = validate({\r\n            username: this.state.username,\r\n            email: this.state.email\r\n        },valConstraints);\r\n\r\n        if(typeof(valResult) != \"undefined\") {\r\n\r\n            let errorMessage;\r\n\r\n            if (typeof (valResult.username) != \"undefined\")\r\n                errorMessage = valResult.username[0];\r\n            else if (typeof (valResult.email) != \"undefined\")\r\n                errorMessage = valResult.email[0];\r\n            errorMessage = errorMessage.replace(\"Username \",\"\").replace(\"Email \",\"\");\r\n\r\n            this.setState({\r\n                error: true,\r\n                errorMessage: errorMessage\r\n            });\r\n        }else {\r\n\r\n            const {username, email} = this.state;\r\n\r\n            requestPasswordResetLink(username, email)\r\n                .then(response => {\r\n                    if (response.status === 200)\r\n                        this.setState({\r\n                            error: false,\r\n                            sentMail: true\r\n                        });\r\n                    else if(response.status === 404)\r\n                        this.setState({\r\n                            error: true,\r\n                            errorMessage: 'Dieser Benutzer scheint nicht zu existieren'\r\n                        })\r\n                    else\r\n                        this.setState({\r\n                            error: true,\r\n                            errorMessage: 'ein Fehler ist aufgetreten'\r\n                        });\r\n                })\r\n                .catch(err => {\r\n                    this.setState({\r\n                        error: true,\r\n                        errorMessage: 'ein Fehler ist aufgetreten'\r\n                    });\r\n                });\r\n        }\r\n    }\r\n    errorMessage = () => {\r\n        if(this.state.error)\r\n            return (\r\n                <ErrorMsg>\r\n                    {this.state.errorMessage}\r\n                </ErrorMsg>\r\n            )\r\n    };\r\n    successMessage = () => {\r\n        if(this.state.sentMail)\r\n            return (\r\n                <SuccessMsg>\r\n                    E-Mail zum zurücksetzen des Passwortes wurde versendet!\r\n                </SuccessMsg>\r\n            )\r\n    }\r\n    render() {\r\n        return (\r\n            <div className=\"h-100\" style={{display: \"flex\"}}>\r\n                <div className=\"col-sm-12 my-auto\">\r\n                    <div className=\"container border rounded p-3\" style={{maxWidth: \"800px\"}}>\r\n                        <BackToLogin/>\r\n                        <h1>Passwort zurücksetzen</h1>\r\n                        {this.errorMessage()}\r\n                        <form onSubmit={this.submitHandler}>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"username\">Benutzername:</label>\r\n                                <input type=\"text\"\r\n                                       name=\"username\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"Benutzernamen eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"email\">E-Mail Addresse:</label>\r\n                                <input type=\"email\"\r\n                                       name=\"email\"\r\n                                       className=\"form-control\"\r\n                                       placeholder=\"E-Mail Addresse eingeben\"\r\n                                       onChange={this.changeHandler}\r\n                                />\r\n                            </div>\r\n                            {this.successMessage()}\r\n                            <input\r\n                                type=\"submit\"\r\n                                className=\"btn btn-primary\"\r\n                                value=\"Passwort zurücksetzen\"\r\n                            />\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport {useGlobal} from \"reactn\";\r\n\r\nfunction PrivateRoute({ component: Component, ...rest }) {\r\n\r\n    const [global,setGlobal] = useGlobal();\r\n\r\n    return (\r\n        <Route\r\n            {...rest}\r\n            render={props =>\r\n                global.loaded ? (\r\n                    global.authTokens ?\r\n                    (\r\n                        <Component {...props} />\r\n                    )\r\n                    : (\r\n                        <Redirect\r\n                            to={{\r\n                                pathname: \"/login\",\r\n                                state: {\r\n                                    referer: props.location\r\n                                }\r\n                            }}\r\n                        />\r\n                    )\r\n                ) : null\r\n            }\r\n        />\r\n    );\r\n}\r\n\r\nexport default PrivateRoute;","//https://medium.com/applike/https-medium-com-applike-react-responsive-conditional-rendering-of-component-c97ab247097d\r\n\r\nexport const DeviceWidthObject = {\r\n\r\n    MobileSmall      : { max: 320, min: 0 },\r\n    MobileMedium     : { max: 375, min: 321 },\r\n    MobileLarge      : { max: 767, min: 376 },\r\n\r\n    Tablet           : { max: 991, min: 768 },\r\n\r\n    LaptopSmall      : { max: 1024, min: 992 },\r\n    LaptopLarge      : { max: 1440, min: 1025 },\r\n\r\n    LargerThanLaptop : { max: 2560, min: 1441 },\r\n    LargeScreenMax   : { max: 999999, min: 2561 }\r\n\r\n};\r\n\r\nexport const IdDeviceBreakpointsByWidth = {\r\n\r\n    laptop_max : 1440,\r\n    laptop_min : 992,\r\n    tablet_min : 768,\r\n    tablet_max : 991,\r\n    mobile_max : 767,\r\n    default_min : 768 // Unrecognized device\r\n};\r\n\r\nexport const IdMobileHeight = {\r\n    mobileLandscape_min : 320,\r\n    mobileLandscape_max : 425\r\n};\r\n\r\nexport const getWindowDimension = () => {\r\n\r\n    const width = window.innerWidth\r\n        || document.documentElement.clientWidth\r\n        || document.body.clientWidth;\r\n\r\n    const height = window.innerHeight\r\n        || document.documentElement.clientHeight\r\n        || document.body.clientHeight;\r\n\r\n    return {width, height}\r\n\r\n};\r\n\r\nexport const getDeviceTypeInfo = () => {\r\n    const { width, height } = getWindowDimension();\r\n    const buildDeviceDetails = {\r\n        deviceType: '',\r\n        deviceTypeVariant: '',\r\n        orientation: 'Portrait',\r\n        width,\r\n        height,\r\n        isFallback: false\r\n    };\r\n//  Edge case\r\n    const hasEdgeCase = handleExceptions(buildDeviceDetails, width, height);\r\n    if (hasEdgeCase) {\r\n        return hasEdgeCase\r\n    }\r\n    if (height < width) {\r\n        // Orientation is landscape\r\n        buildDeviceDetails.orientation = 'Landscape';\r\n\r\n        if (height <= IdMobileHeight.mobileLandscape_max) {\r\n            // Mobile (landscape)\r\n            buildDeviceDetails.deviceType = 'Mobile';\r\n            for (const devc in DeviceWidthObject) {\r\n                if (\r\n                    height <= DeviceWidthObject[devc].max &&\r\n                    height >= DeviceWidthObject[devc].min\r\n                ) {\r\n                    buildDeviceDetails.deviceTypeVariant = devc;\r\n                    break\r\n                }\r\n            }\r\n        } else if (\r\n            width <= IdDeviceBreakpointsByWidth.tablet_max &&\r\n            width >= IdDeviceBreakpointsByWidth.tablet_min\r\n        ) {\r\n            // Tablet (landscape)\r\n            buildDeviceDetails.deviceType = 'Tablet';\r\n            buildDeviceDetails.deviceTypeVariant = 'Tablet';\r\n        } else if (\r\n            width <= IdDeviceBreakpointsByWidth.laptop_max &&\r\n            width >= IdDeviceBreakpointsByWidth.laptop_min\r\n        ) {\r\n            // Laptop (landscape)\r\n            buildDeviceDetails.deviceType = 'Laptop';\r\n\r\n            for (const devc in DeviceWidthObject) {\r\n                if (\r\n                    width <= DeviceWidthObject[devc].max &&\r\n                    width >= DeviceWidthObject[devc].min\r\n                ) {\r\n                    buildDeviceDetails.deviceTypeVariant = devc;\r\n                    break\r\n                }\r\n            }\r\n        } else if (width > IdDeviceBreakpointsByWidth.laptop_max) {\r\n            // Larger than Laptop (landscape)\r\n            buildDeviceDetails.deviceType = 'LargerThanLaptop';\r\n\r\n            for (const devc in DeviceWidthObject) {\r\n                if (\r\n                    width <= DeviceWidthObject[devc].max &&\r\n                    width >= DeviceWidthObject[devc].min\r\n                ) {\r\n                    buildDeviceDetails.deviceTypeVariant = devc\r\n                    break\r\n                }\r\n            }\r\n        } else {\r\n\r\n            buildDeviceDetails.deviceType = 'Mobile';\r\n            buildDeviceDetails.deviceTypeVariant = 'MobileLarge';\r\n            buildDeviceDetails.isFallback = true\r\n        }\r\n\r\n        return buildDeviceDetails\r\n    } else {\r\n        // Orientation is portrait\r\n        buildDeviceDetails.orientation = 'Portrait';\r\n\r\n        for (const devc in DeviceWidthObject) {\r\n            if (\r\n                width <= DeviceWidthObject[devc].max &&\r\n                width >= DeviceWidthObject[devc].min\r\n            ) {\r\n                buildDeviceDetails.deviceTypeVariant = devc;\r\n                break\r\n            }\r\n        }\r\n\r\n        if (\r\n            width <= IdDeviceBreakpointsByWidth.laptop_max &&\r\n            width >= IdDeviceBreakpointsByWidth.laptop_min\r\n        ) {\r\n            buildDeviceDetails.deviceType = 'Laptop'\r\n        }\r\n\r\n        if (\r\n            width <= IdDeviceBreakpointsByWidth.tablet_max &&\r\n            width >= IdDeviceBreakpointsByWidth.tablet_min\r\n        ) {\r\n            buildDeviceDetails.deviceType = 'Tablet'\r\n        }\r\n        if (width <= IdDeviceBreakpointsByWidth.mobile_max) {\r\n            buildDeviceDetails.deviceType = 'Mobile'\r\n        }\r\n\r\n        if (width > IdDeviceBreakpointsByWidth.laptop_max) {\r\n            buildDeviceDetails.deviceType = 'LargerThanLaptop'\r\n        }\r\n\r\n        return buildDeviceDetails\r\n    }\r\n};\r\n\r\nconst handleExceptions = (buildDeviceDetails, width, height) => {\r\n    //  iPadPro\r\n    if (width === 1024 && height === 1366) {\r\n        buildDeviceDetails.deviceType = 'Tablet';\r\n        buildDeviceDetails.deviceTypeVariant = 'iPadPro';\r\n        buildDeviceDetails.orientation = 'Portrait';\r\n\r\n        return buildDeviceDetails\r\n    } else if (width === 1366 && height === 1024) {\r\n        //  Edge case\r\n        buildDeviceDetails.deviceType = 'Tablet';\r\n        buildDeviceDetails.deviceTypeVariant = 'iPadPro';\r\n        buildDeviceDetails.orientation = 'Landscape';\r\n\r\n        return buildDeviceDetails\r\n    }\r\n\r\n    return undefined\r\n};","import React from 'react'\r\nimport {\r\n    getWindowDimension,\r\n    IdDeviceBreakpointsByWidth,\r\n    IdMobileHeight\r\n} from './utilResponsive';\r\n\r\nconst { width, height } = getWindowDimension();\r\nconst initialState = { width, height };\r\n\r\nexport default class Responsive extends React.PureComponent {\r\n\r\n    state = initialState;\r\n    componentDidMount () {\r\n        window.addEventListener('resize', this.handleResize, false)\r\n    }\r\n    componentWillUnmount () {\r\n        window.removeEventListener('resize', this.handleResize, false)\r\n    }\r\n    render = () => {\r\n        const { children, displayIn } = this.props;\r\n        const { width, height } = this.state;\r\n        const shouldRenderChildren = this.shouldRender(displayIn, width, height);\r\n        return (\r\n            <React.Fragment>\r\n                {shouldRenderChildren ? children : null}\r\n            </React.Fragment>\r\n        )\r\n    };\r\n    handleResize = () => {\r\n        const { width, height } = getWindowDimension();\r\n        this.setState({ width, height })\r\n    };\r\n    shouldRender = (display, width, height) => {\r\n        if (\r\n            display.indexOf('Laptop') !== -1 &&\r\n            width >= IdDeviceBreakpointsByWidth.laptop_min\r\n        ) {\r\n            return true\r\n        }\r\n        if (\r\n            display.indexOf('Tablet') !== -1 &&\r\n            (width <= IdDeviceBreakpointsByWidth.tablet_max &&\r\n                width >= IdDeviceBreakpointsByWidth.tablet_min)\r\n        ) {\r\n            return true\r\n        }\r\n        // For mobile regardless of orientation\r\n        if (\r\n            display.indexOf('Mobile') !== -1 &&\r\n            width <= IdDeviceBreakpointsByWidth.mobile_max\r\n        ) {\r\n            return true\r\n        }\r\n        if (\r\n            display.indexOf('MobilePortrait') !== -1 &&\r\n            (width <= IdDeviceBreakpointsByWidth.mobile_max &&\r\n                height >= IdMobileHeight.mobileLandscape_max)\r\n        ) {\r\n            return true\r\n        }    return !!(\r\n            display.indexOf('MobileLandScape') !== -1 &&\r\n            (width <= IdDeviceBreakpointsByWidth.mobile_max &&\r\n                height <= IdMobileHeight.mobileLandscape_min)\r\n        )\r\n    }\r\n}","import {Component} from \"react\";\r\n\r\nexport default class Dummy extends Component {\r\n\r\n    componentDidMount() {\r\n        if(typeof(this.props.didMount) === 'function')\r\n            this.props.didMount();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(typeof(this.props.didUpdate) === 'function')\r\n            this.props.didUpdate();\r\n    }\r\n\r\n    render() {\r\n        if(this.props.children)\r\n            return this.props.children;\r\n        return null;\r\n    }\r\n}","import React,{Component} from \"reactn\";\r\nimport Responsive from \"../../responsive/Responsive\";\r\nimport {Link,withRouter} from \"react-router-dom\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\n\r\nimport \"./headerLeft.scss\";\r\n\r\nexport const infoHeaderCenter = {\r\n    none: 0,\r\n    normalChat: 1,\r\n    groupChat: 2\r\n};\r\n\r\nclass HeaderLeft extends Component{\r\n\r\n    render() {\r\n\r\n        const {pathname} = this.props.location;\r\n        /*\r\n            renders number of new messages\r\n         */\r\n        const renderNewMsgNumber = () => {\r\n            if(this.global.newMessages > 0){\r\n                return (\r\n                    <div className=\"btnBack-number\">\r\n                        {this.global.newMessages}\r\n                    </div>\r\n                )\r\n            }\r\n            return null;\r\n        };\r\n\r\n        const renderBtnBack = () => {\r\n            /*\r\n                only small screens\r\n             */\r\n            return (\r\n                <div className=\"float-left left\">\r\n                    <i id=\"btnBackToChatList\"\r\n                       className=\"fas fa-arrow-left fa-2x d-block d-md-none\"\r\n                       onClick={() => {this.props.history.goBack()}}\r\n                    />\r\n                    {renderNewMsgNumber()}\r\n                </div>\r\n            );\r\n        };\r\n\r\n        const renderChatInfo = () => {\r\n            /*\r\n                if there is a normal chat open, this info gets displayed\r\n             */\r\n            switch(this.global.infoHeaderCenter){\r\n\r\n                case infoHeaderCenter.normalChat:\r\n                    return (\r\n                        <HeaderCenter>\r\n                            <h3 id=\"chat-info-name\">\r\n                                {this.global.ihcData.name}\r\n                            </h3>\r\n                            <Link to={pathname + \"/userInfo/\" + this.global.ihcData.uid}>\r\n                                <i className=\"fas fa-info-circle fa-2x\"\r\n                                   data-toggle=\"tooltip\"\r\n                                   title=\"chat info\"\r\n                                />\r\n                            </Link>\r\n                        </HeaderCenter>\r\n                    );\r\n\r\n                case infoHeaderCenter.groupChat:\r\n                    return(\r\n                        <HeaderCenter>\r\n                            <h3 id=\"chat-info-name\">\r\n                                {this.global.ihcData.name}\r\n                            </h3>\r\n                            <Link to={\"/chat/groupInfo/\" + this.global.ihcData.gcid}>\r\n                                <i className=\"fas fa-info-circle fa-2x\"\r\n                                   data-toggle=\"tooltip\"\r\n                                   title=\"chat info\"\r\n                                />\r\n                            </Link>\r\n                        </HeaderCenter>\r\n                    );\r\n\r\n                default:\r\n                    return(\r\n                        <Responsive displayIn={[\"Laptop\",\"Tablet\"]}>\r\n                            <h3 className=\"pt-2 pl-2\">chat</h3>\r\n                        </Responsive>\r\n                    );\r\n            }\r\n        };\r\n\r\n        return(\r\n            <Dummy>\r\n                <Responsive displayIn={[\"Mobile\"]}>\r\n                    {renderBtnBack()}\r\n                </Responsive>\r\n                {renderChatInfo()}\r\n            </Dummy>\r\n        )\r\n    }\r\n}\r\nexport default withRouter(HeaderLeft);\r\n\r\nfunction HeaderCenter(props){\r\n    return(\r\n        <div id=\"chat-info\" className=\"center pt-2\">\r\n            {props.children}\r\n        </div>\r\n    )\r\n}","import React,{Component} from \"reactn\";\r\nimport HeaderLeft from \"./HeaderLeft\";\r\nimport {Link,withRouter} from \"react-router-dom\";\r\nimport Tooltip from \"rc-tooltip\";\r\n\r\nimport 'rc-tooltip/assets/bootstrap_white.css';\r\n\r\nimport './header.scss';\r\n\r\nclass Header extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            checkBoxClicked: false\r\n        };\r\n    }\r\n    clickCheckBox = event => {\r\n        if(this.state.checkBoxClicked)\r\n            event.stopPropagation();\r\n        else {\r\n            setTimeout(() => {\r\n                this.setState(state => ({\r\n                    checkBoxClicked: true\r\n                }));\r\n            }, 20);\r\n        }\r\n    };\r\n    clickDocument = event => {\r\n        if (this.state.checkBoxClicked)\r\n            this.changeChecked(event);\r\n    };\r\n    changeChecked = event => {\r\n        this.setState(state => ({\r\n            checkBoxClicked: !state.checkBoxClicked\r\n        }));\r\n    };\r\n\r\n    logout = () => {\r\n        /*\r\n            authTokens are deleted\r\n         */\r\n        this.dispatch.deleteAuthTokens();\r\n    };\r\n\r\n    render() {\r\n\r\n        const {pathname} = this.props.location;\r\n\r\n        return(\r\n            <div className=\"c-header\">\r\n\r\n                <HeaderLeft />\r\n\r\n                <div id=\"top-right\" className=\"right\" onClick={this.clickCheckBox}>\r\n\r\n                    <div className=\"right-l\" />\r\n\r\n                    <input type=\"checkbox\"\r\n                           id=\"btnControlTopRight\"\r\n                           className=\"btnControl\"\r\n                           checked={this.state.checkBoxClicked}\r\n                           onChange={this.changeChecked}\r\n                    />\r\n                    <label htmlFor=\"btnControlTopRight\">\r\n\r\n                        <div className=\"right-c\">\r\n                            <div className=\"d-only-when-small\">\r\n                                <i  id=\"user-info\"\r\n                                    className=\"fas fa-user fa-2x user-icon\"\r\n                                    data-toggle=\"tooltip\"\r\n                                    title=\"Benutzer-Info\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"d-only-when-big top-2right\">\r\n\r\n                                <Link to={pathname + \"/userInfo/\" + this.global.userSelf.uid}>\r\n                                    <BottomToolTip text=\"Benutzer-Info\">\r\n                                        <h4 id=\"username\"\r\n                                            className=\"p-2 username\"\r\n                                        >\r\n                                                {this.global.userSelf.username}\r\n                                        </h4>\r\n                                    </BottomToolTip>\r\n                                </Link>\r\n                                <div className=\"float-right\">\r\n                                    <Link to={pathname + \"/settings\"}>\r\n                                        <BottomToolTip text=\"Einstellungen\">\r\n                                            <i className=\"fas fa-user-cog fa-2x\"/>\r\n                                        </BottomToolTip>\r\n                                    </Link>\r\n                                    &nbsp;\r\n                                    <BottomToolTip text=\"logout\">\r\n                                        <i id=\"user-logout\"\r\n                                           className=\"fas fa-sign-out-alt fa-2x logout\"\r\n                                           onClick={this.logout}\r\n                                        />\r\n                                    </BottomToolTip>\r\n                                </div>\r\n\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    componentDidMount() {\r\n        document.addEventListener('click',this.clickDocument,false);\r\n    }\r\n    componentWillUnmount() {\r\n        document.removeEventListener('click',this.clickDocument,false);\r\n    }\r\n}\r\n\r\nfunction BottomToolTip(props){\r\n    return(\r\n        <Tooltip placement=\"bottom\"\r\n                 trigger={['hover']}\r\n                 overlay={\r\n                     <span>{props.text}</span>\r\n                 }>\r\n            {props.children}\r\n        </Tooltip>\r\n    )\r\n}\r\nexport default withRouter(Header);","import React,{Component} from \"react\";\r\nimport {Link,withRouter} from \"react-router-dom\";\r\n\r\nimport \"./chatSearchBox.scss\";\r\n\r\nclass ChatSearchBox extends Component{\r\n\r\n    searchChanged = event => {\r\n        this.props.onSearch(event.target.value);\r\n    };\r\n\r\n    render() {\r\n\r\n        const {pathname} = this.props.location;\r\n\r\n        return(\r\n            <div className=\"chatSearchBox\">\r\n                <div className=\"chat-select-form\">\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"chat-search\"\r\n                        className=\"chat-search\"\r\n                        placeholder=\"Chat suchen\"\r\n                        onChange={this.searchChanged}\r\n                    />\r\n                    <Link to={pathname + \"/newChat\"}>\r\n                        <button id=\"btn-newChat\"\r\n                                className=\"btn-newChat\"\r\n                        >\r\n                            <i className=\"fas fa-plus fa-lg\" />\r\n                        </button>\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default withRouter(ChatSearchBox);","let Colors = {};\r\nColors.names = {\r\n    aqua: \"#00ffff\",\r\n    black: \"#000000\",\r\n    blue: \"#0000ff\",\r\n    brown: \"#a52a2a\",\r\n    cyan: \"#00ffff\",\r\n    darkblue: \"#00008b\",\r\n    darkcyan: \"#008b8b\",\r\n    darkgrey: \"#a9a9a9\",\r\n    darkgreen: \"#006400\",\r\n    darkkhaki: \"#bdb76b\",\r\n    darkmagenta: \"#8b008b\",\r\n    darkolivegreen: \"#556b2f\",\r\n    darkorange: \"#ff8c00\",\r\n    darkorchid: \"#9932cc\",\r\n    darkred: \"#8b0000\",\r\n    darksalmon: \"#e9967a\",\r\n    darkviolet: \"#9400d3\",\r\n    fuchsia: \"#ff00ff\",\r\n    gold: \"#ffd700\",\r\n    green: \"#008000\",\r\n    indigo: \"#4b0082\",\r\n    khaki: \"#f0e68c\",\r\n    lightblue: \"#add8e6\",\r\n    lightgreen: \"#90ee90\",\r\n    lightgrey: \"#d3d3d3\",\r\n    lightpink: \"#ffb6c1\",\r\n    lime: \"#00ff00\",\r\n    magenta: \"#ff00ff\",\r\n    maroon: \"#800000\",\r\n    navy: \"#000080\",\r\n    olive: \"#808000\",\r\n    orange: \"#ffa500\",\r\n    pink: \"#ffc0cb\",\r\n    purple: \"#800080\",\r\n    violet: \"#800080\",\r\n    red: \"#ff0000\",\r\n    silver: \"#c0c0c0\"\r\n};\r\nColors.random = function() {\r\n    let result;\r\n    let count = 0;\r\n    for (let prop in this.names)\r\n        if (Math.random() < 1/++count)\r\n            result = prop;\r\n    return result;\r\n};\r\nexport default Colors;","\r\nexport default class BinSearchArray extends Array{\r\n\r\n    getIndex(key){\r\n\r\n        let left = 0;\r\n        let right = this.length-1;\r\n\r\n        while(left<=right){\r\n            let k= Math.floor((left+right)/2);\r\n            if(this[k].key === key)\r\n                return k;\r\n            else if(this[k].key < key)\r\n                left = k+1;\r\n            else //a[k]>v\r\n                right = k-1;\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    getNearestKey(key){\r\n        /*\r\n            besseren Algorithmus finden\r\n         */\r\n        let i;\r\n        ++key;\r\n\r\n        while((i = this.getIndex(--key)) === -1){\r\n            /*\r\n                wenn key 0 ist, wird vorne eingefügt\r\n             */\r\n            if(key === 0) return -1;\r\n        }\r\n\r\n        return i;\r\n    }\r\n\r\n    get(key){\r\n\r\n        let i = this.getIndex(key);\r\n\r\n        if(i !== -1)\r\n            return this[i].value;\r\n\r\n        return undefined;\r\n    }\r\n\r\n    add(key,value){\r\n        /*\r\n            key darf noch nicht vorhanden sein\r\n         */\r\n        if(this.getIndex(key) === -1) {\r\n\r\n            this.splice(this.getNearestKey(key) + 1, 0, {\r\n                key: key,\r\n                value: value\r\n            });\r\n        }\r\n    }\r\n\r\n    remove(key){\r\n\r\n        let i = this.getIndex(key);\r\n\r\n        if(i !== -1)\r\n            this.splice(i,1);\r\n    }\r\n}","import {getGlobal,getDispatch} from 'reactn';\r\n\r\nexport async function makeRequest(target,config,tokensP){\r\n    /*\r\n        if parameter tokens is defined, this is taken\r\n        else the one from global\r\n     */\r\n    const tokens = tokensP ? tokensP : getGlobal().authTokens;\r\n\r\n    const configI = {\r\n        ...config,\r\n        method: config.method,\r\n        headers: {\r\n            ...config.headers,\r\n            /*\r\n                jwt\r\n             */\r\n            'Authorization': tokens\r\n        }\r\n    };\r\n\r\n    const response = await fetch(target,configI);\r\n    /*\r\n        http-status 401: jwt timeout\r\n     */\r\n    if(response.status === 401){\r\n        /*\r\n            autToken is deleted\r\n         */\r\n        getDispatch().deleteAuthTokens();\r\n        /*\r\n            error is thrown\r\n         */\r\n        throw new Error('jwt expired');\r\n    }\r\n    return response;\r\n}","import {makeRequest} from \"../global/requests\";\r\n\r\nexport async function selectChats(){\r\n\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    /*\r\n        chats are requested\r\n     */\r\n    return await makeRequest('/chats', config);\r\n}\r\nexport async function createNormalChat(body){\r\n\r\n    const config = {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    return  await makeRequest('/user/chat', config);\r\n}\r\nexport async function selectUser(uid){\r\n\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    return await makeRequest('/user/' + uid, config);\r\n}\r\nexport async function loadMessages(body){\r\n\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    return  await makeRequest('/message/load', config);\r\n}","import Colors from \"../util/Color\";\r\nimport BinSearchArray from \"../util/BinSearch\";\r\nimport chatSocket from \"./chatSocket\";\r\nimport {selectUser} from \"./apiCalls\";\r\n\r\nexport const UserErrorCode = {\r\n    none: 0,\r\n    nan: 1,\r\n    tempChat: 2,\r\n    userNotExisting: 3,\r\n    blocked: 4,\r\n    isSelf: 5,\r\n    error: 6\r\n};\r\n\r\nexport async function getUserNormalChat(uid){\r\n    /*\r\n        does the user exist & does normal chat exist\r\n     */\r\n    if(chatSocket.users.getIndex(uid) !== -1){\r\n        /*\r\n            does a normalChat exist at the user\r\n         */\r\n        if(chatSocket.users.get(uid).normalChat !== 0) {\r\n\r\n            return UserErrorCode.none;\r\n        }else{\r\n            /*\r\n                chat does not exist in server\r\n                it gets created\r\n             */\r\n            const user = chatSocket.users.get(uid);\r\n            chatSocket.temporaryChat.createNew(uid,user.username);\r\n\r\n            return UserErrorCode.tempChat;\r\n        }\r\n        /*\r\n            does there exist a temporary chat with this user\r\n        */\r\n    }else if(chatSocket.temporaryChat.doesExist(uid)){\r\n        /*\r\n            user and chat does not exist in server\r\n         */\r\n        return UserErrorCode.tempChat;\r\n\r\n    }else{\r\n        /*\r\n            request user from server\r\n         */\r\n        try {\r\n            const response = await selectUser(uid);\r\n            /*\r\n                if ok, modal is closed\r\n             */\r\n            if(response.ok) {\r\n\r\n                const data = await response.json();\r\n\r\n                if(data.userExists && !data.blocked) {\r\n\r\n                    chatSocket.temporaryChat.createNew(uid,data.username);\r\n                    return UserErrorCode.tempChat;\r\n\r\n                }else{\r\n\r\n                    if(!data.userExists)\r\n\r\n                        return UserErrorCode.userNotExisting;\r\n\r\n                    else\r\n\r\n                        return UserErrorCode.blocked;\r\n                }\r\n\r\n            }else\r\n                return UserErrorCode.error;\r\n\r\n        }catch(error){\r\n            return UserErrorCode.error;\r\n        }\r\n    }\r\n}\r\n\r\nexport default class User{\r\n\r\n    _uid;\r\n    _username;\r\n    _color;\r\n    //ids der chats des Users\r\n    _normalChat = 0;\r\n    //ids of the groupchats\r\n    _groupChats = new BinSearchArray();\r\n\r\n    constructor(uid,username) {\r\n        this.uid = uid;\r\n        this.username = username;\r\n        this.color = Colors.random();\r\n    }\r\n    /*\r\n        groupChat is added\r\n     */\r\n    addGroupChat(gcid){\r\n        this.groupChats.add(gcid,gcid);\r\n    }\r\n\r\n    removeGroupChat(gcid){\r\n        this.groupChats.remove(gcid);\r\n    }\r\n\r\n    get uid() {\r\n        return this._uid;\r\n    }\r\n\r\n    set uid(value) {\r\n        this._uid = value;\r\n    }\r\n\r\n    get username() {\r\n        return this._username;\r\n    }\r\n\r\n    set username(value) {\r\n        this._username = value;\r\n    }\r\n\r\n    get color() {\r\n        return this._color;\r\n    }\r\n\r\n    set color(value) {\r\n        this._color = value;\r\n    }\r\n\r\n    get normalChat() {\r\n        return this._normalChat;\r\n    }\r\n\r\n    set normalChat(value) {\r\n        this._normalChat = value;\r\n    }\r\n\r\n    get groupChats() {\r\n        return this._groupChats;\r\n    }\r\n\r\n    set groupChats(value) {\r\n        this._groupChats = value;\r\n    }\r\n}","\r\nexport let globalData = {};\r\n\r\n/*\r\n    is called in isLoggedIn in App.js\r\n */\r\nexport async function fetchData(){\r\n\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    const response = await fetch('/data.json', config);\r\n\r\n    if(response.ok){\r\n\r\n        globalData = await response.json();\r\n    }else{\r\n        throw new Error();\r\n    }\r\n}","import React from \"react\";\r\nimport {UsernameSpan} from \"./Message\";\r\n\r\nexport default function NormalMessage(props){\r\n\r\n    const msg = props.msg;\r\n\r\n    return(\r\n        <div className={\r\n            (msg.bySelf ? \"self \" : \"other \") +\r\n            \"msg-container\"\r\n        }>\r\n            {msg.userTop ?\r\n                <div className=\"w-100\">\r\n                    <strong className=\"header\">\r\n                        <UsernameSpan user={msg.userTop}/>\r\n                    </strong>\r\n                </div>\r\n                : null}\r\n            <div className=\"content\">\r\n                <p>\r\n                    {msg.content.text}\r\n                </p>\r\n            </div>\r\n            <div className=\"date-outer\">\r\n                <div className=\"date\">\r\n                    {msg.mDateString}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport Dummy from \"../../../../utilComp/Dummy\";\r\nimport {getStatusMessageString} from \"../../../../chatData/message/statusMessage\";\r\n\r\nexport default function StatusMessage(props){\r\n\r\n    const msg = props.msg;\r\n\r\n    return(\r\n        <div className={\r\n            (msg.bySelf ? \"self \" : \"other \") +\r\n            \"msg-container\"\r\n        }>\r\n            <StatusMsgContent msg={msg}/>\r\n            <div className=\"date-outer\">\r\n                <div className=\"date\">\r\n                    {msg.mDateString}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nfunction StatusMsgContent(props) {\r\n\r\n    const msg = props.msg;\r\n\r\n    return(\r\n        <Dummy>\r\n            {getStatusMessageString(msg,true)}\r\n        </Dummy>\r\n    );\r\n}","import React from \"react\";\r\nimport {globalData} from \"../../../../global/globalData\";\r\nimport NormalMessage from \"./NormalMessage\";\r\nimport StatusMessage from \"./StatusMessage\";\r\nimport Colors from \"../../../../util/Color\";\r\n\r\nimport './message.scss'\r\n\r\nexport default function Message(props){\r\n\r\n    const msg = props.msg;\r\n\r\n    switch (msg.type) {\r\n\r\n        case globalData.messageTypes.normalMessage: {\r\n\r\n            return (\r\n                <NormalMessage msg={msg}/>\r\n            )\r\n        }\r\n\r\n        case globalData.messageTypes.statusMessage: {\r\n\r\n            return (\r\n                <StatusMessage msg={msg}/>\r\n            );\r\n        }\r\n\r\n        default:\r\n            return <span />;\r\n    }\r\n}\r\n\r\nexport function UsernameSpan(props){\r\n\r\n    return(\r\n        <span\r\n            style={{\r\n                color: Colors.names[props.user.color]\r\n            }}>\r\n                {props.user.username}\r\n        </span>\r\n    );\r\n}","import {UsernameSpan} from \"../../Home/chatView/chatContainer/message/Message\";\r\nimport {globalData} from \"../../global/globalData\";\r\nimport React from \"react\";\r\nimport chatSocket from \"../chatSocket\";\r\n\r\nexport const middleStringD = {\r\n    hatHast: 0,\r\n    ist: 1\r\n};\r\n\r\nexport const statusMessagesD = [\r\n    \"den chat erstellt\",\r\n    \"hinzugefügt\",\r\n    \"entfernt\",\r\n    \"dem chat beigetreten\",\r\n    \"den chat verlassen\",\r\n    \"zum Admin gemacht\",\r\n    \"nicht mehr Admin\"\r\n];\r\n\r\nexport function getStatusMessageString(msg,useReact){\r\n\r\n    return getStatusMessageStringD();\r\n\r\n    function getStatusMessageStringD() {\r\n\r\n        const userTop = msg.userTop;\r\n        const passiveUsers = msg.content.passiveUsers;\r\n\r\n        switch (msg.content.type) {\r\n\r\n            case globalData.statusMessageTypes.chatCreated:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.hatHast,\r\n                    passiveUsers,\r\n                    globalData.statusMessageTypes.chatCreated\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersAdded:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.hatHast,\r\n                    passiveUsers,\r\n                    globalData.statusMessageTypes.usersAdded\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersRemoved:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.hatHast,\r\n                    passiveUsers,\r\n                    globalData.statusMessageTypes.usersRemoved\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersJoined:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.ist,\r\n                    [],\r\n                    globalData.statusMessageTypes.usersJoined\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersLeft:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.hatHast,\r\n                    [],\r\n                    globalData.statusMessageTypes.usersLeft\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersMadeAdmin:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.hatHast,\r\n                    passiveUsers,\r\n                    globalData.statusMessageTypes.usersMadeAdmin\r\n                );\r\n\r\n            case globalData.statusMessageTypes.usersRemovedAdmin:\r\n                return renderStringD(\r\n                    userTop,\r\n                    middleStringD.ist,\r\n                    [],\r\n                    globalData.statusMessageTypes.usersRemovedAdmin\r\n                );\r\n\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    function renderStringD(userTop,middle,passiveUsers,statusMessage){\r\n\r\n        function getMiddleString(){\r\n\r\n            // eslint-disable-next-line default-case\r\n            switch (middle) {\r\n\r\n                case middleStringD.hatHast:\r\n                    return msg.bySelf ? \" hast \" : \" hat \";\r\n\r\n                case middleStringD.ist:\r\n                    return ' ist';\r\n            }\r\n        }\r\n\r\n        function getPassiveUsers(){\r\n\r\n            if(passiveUsers.length < 1 ){\r\n                return \"\";\r\n            }else if(passiveUsers.length === 1){\r\n\r\n                const user = chatSocket.users.get(passiveUsers[0]);\r\n\r\n                if(user)\r\n                    if(useReact)\r\n                        return(\r\n                            <UsernameSpan user={user}/>\r\n                        );\r\n                    else\r\n                        return user.username;\r\n                else\r\n                    return \"1 Benutzer\";\r\n\r\n            }else{\r\n                return passiveUsers.length + \" Benutzer\";\r\n            }\r\n        }\r\n\r\n        function getTString(){\r\n            return \" \" + statusMessagesD[statusMessage];\r\n        }\r\n\r\n        if(useReact)\r\n            return(\r\n                <span>\r\n                    <UsernameSpan user={msg.userTop}/>\r\n                    {getMiddleString()}\r\n                    {getPassiveUsers()}\r\n                    {getTString()}\r\n                </span>\r\n            );\r\n        else\r\n            return msg.userTop.username + getMiddleString() + getPassiveUsers() + getTString();\r\n    }\r\n\r\n}","import chatSocket from \"../chatSocket\";\r\nimport {globalData} from \"../../global/globalData\";\r\nimport {getStatusMessageString} from \"./statusMessage\";\r\n\r\nexport function isDifferentDay(date1,date2){\r\n    return date1.getDay() !== date2.getDay()\r\n        || date1.getMonth() !== date2.getMonth()\r\n        || date1.getFullYear() !== date2.getFullYear();\r\n}\r\n\r\nexport default class Message {\r\n\r\n    _mid;\r\n    _uid;\r\n    _date;\r\n    _chat;\r\n    _type;\r\n    _content;\r\n\r\n    constructor(\r\n        mid,\r\n        uid,\r\n        chat,\r\n        date = new Date(Date.now()),\r\n        type,\r\n        content\r\n    ) {\r\n        this.mid = mid;\r\n        this.uid = uid;\r\n        this.date = date;\r\n        //type: object of Chat\r\n        this.chat = chat;\r\n        this.type = type;\r\n        this.content = content;\r\n    }\r\n    /*\r\n        a object representing the message is returned\r\n     */\r\n    getMessageObject(userTopShown){\r\n\r\n        const message = {\r\n            mDateString: this.getMessageViewDateString(),\r\n            dateString: this.getDateString(),\r\n            date: this.date,\r\n            bySelf: this.uid === chatSocket.userSelf.uid,\r\n            type: this.type,\r\n            content: this.content\r\n        };\r\n        /*\r\n            if the user top should be shown, the property is added\r\n         */\r\n        if(userTopShown)\r\n            message.userTop = this.getUserTop();\r\n\r\n        return message;\r\n    }\r\n    /*\r\n        a object for the userinfo at the top of the message is returned\r\n     */\r\n    getUserTop(){\r\n        /*\r\n            is the message written by the user self?\r\n         */\r\n        if(this.isBySelf())\r\n            return {\r\n                uid: this.uid,\r\n                username: 'Du',\r\n                color: chatSocket.userSelf.color\r\n            };\r\n        /*\r\n            if the user is not self\r\n         */\r\n        const user = chatSocket.users.get(this.uid);\r\n        return {\r\n            uid: this.uid,\r\n            username: user.username,\r\n            color: user.color\r\n        };\r\n    }\r\n    /*\r\n        is the message by the client self?\r\n     */\r\n    isBySelf(){\r\n        return this.uid === chatSocket.userSelf.uid;\r\n    }\r\n\r\n    getChatViewDateString(){\r\n        /*\r\n            Wenn weniger als 1 Tag her: Uhrzeit\r\n         */\r\n        if(this.isDateToday()){\r\n\r\n            return 'heute ' + this.getTimeString();\r\n        }\r\n        /*\r\n            Wenn gestern: gestern\r\n         */\r\n        else if(this.isDateYesterday()){\r\n\r\n            return 'gestern';\r\n        }\r\n        /*\r\n            sonst: Datum\r\n         */\r\n        else{\r\n            return this.getDateString();\r\n        }\r\n    }\r\n\r\n    getChatViewMsgString(){\r\n\r\n        // eslint-disable-next-line default-case\r\n        switch(this.type) {\r\n\r\n            case globalData.messageTypes.normalMessage: {\r\n\r\n                let msgString = this.content.text;\r\n                /*\r\n                    Wenn string länger als 18 Zeichen, wird verkürzt\r\n                 */\r\n                if(msgString.length > 18)\r\n                msgString = msgString.substr(0, 18) + '...';\r\n                /*\r\n                    wenn selbst geschrieben, steht Du: davor\r\n                 */\r\n                if(this.uid === chatSocket.userSelf.uid)\r\n                    return`Du: ${msgString}`;\r\n\r\n                else if (this.chat.type === 'normalchat')\r\n                    return this.content.text;\r\n\r\n                else\r\n                    return `${chatSocket.users.get(this.uid).username}: ${msgString}`;\r\n            }\r\n            case globalData.messageTypes.statusMessage: {\r\n\r\n                return getStatusMessageString(\r\n                    this.getMessageObject(true),\r\n                    false\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    getMessageViewDateString(){\r\n        if(this.isDateToday()){\r\n\r\n            return this.getTimeString();\r\n        }\r\n        else if(this.isDateYesterday()){\r\n\r\n            return 'gestern ' + this.getTimeString();\r\n        }else{\r\n\r\n            return this.getDateString() + ' ' + this.getTimeString();\r\n        }\r\n    }\r\n\r\n    isDateToday(){\r\n        const dateNow = new Date(Date.now());\r\n        return this.date.getDate() === dateNow.getDate() &&\r\n            this.date.getMonth() === dateNow.getMonth() &&\r\n            this.date.getFullYear() === dateNow.getFullYear();\r\n    }\r\n\r\n    isDateYesterday(){\r\n        const dateNow = new Date(Date.now());\r\n        return this.date.getDate() === dateNow.getDate() - 1 &&\r\n            this.date.getMonth() === dateNow.getMonth() &&\r\n            this.date.getFullYear() === dateNow.getFullYear();\r\n    }\r\n\r\n    getDateString(){\r\n        const d = this.date.getDate();\r\n        let ds;\r\n        if(d<10)\r\n            ds = '0'+d;\r\n        else\r\n            ds = d;\r\n        const m = this.date.getMonth();\r\n        let ms;\r\n        if(m+1<10)\r\n            ms = '0'+(m+1);\r\n        else\r\n            ms = m+1;\r\n        const y = this.date.getFullYear();\r\n\r\n        return `${ds}.${ms}.${y}`;\r\n    }\r\n\r\n    getTimeString(){\r\n        const h = this.date.getHours();\r\n        let hs;\r\n        if(h<10)\r\n            hs = '0'+h;\r\n        else\r\n            hs = h;\r\n        const m = this.date.getMinutes();\r\n        let ms;\r\n        if(m<10)\r\n            ms = '0'+m;\r\n        else\r\n            ms = m;\r\n\r\n        return `${hs}:${ms}`;\r\n    }\r\n    /*\r\n        es wird überprüft, ob date2 an einem anderen Tag war\r\n     */\r\n    isDifferentDay(date2){\r\n        return this.date.getDay() !== date2.getDay()\r\n            || this.date.getMonth() !== date2.getMonth()\r\n            || this.date.getFullYear() !== date2.getFullYear();\r\n    }\r\n\r\n    get mid() {\r\n        return this._mid;\r\n    }\r\n\r\n    set mid(value) {\r\n        this._mid = value;\r\n    }\r\n\r\n    get uid() {\r\n        return this._uid;\r\n    }\r\n\r\n    set uid(value) {\r\n        this._uid = value;\r\n    }\r\n\r\n    get date() {\r\n        return this._date;\r\n    }\r\n\r\n    set date(value) {\r\n        this._date = value;\r\n    }\r\n\r\n    get chat() {\r\n        return this._chat;\r\n    }\r\n\r\n    set chat(value) {\r\n        this._chat = value;\r\n    }\r\n\r\n    get type() {\r\n        return this._type;\r\n    }\r\n\r\n    set type(value) {\r\n        this._type = value;\r\n    }\r\n\r\n    get content() {\r\n        return this._content;\r\n    }\r\n\r\n    set content(value) {\r\n        this._content = value;\r\n    }\r\n}","export default class EventHandler{\r\n\r\n    _events;\r\n\r\n    constructor() {\r\n        this.events = new Map();\r\n    }\r\n\r\n    /*\r\n        event-handler wird hinzugefügt\r\n     */\r\n    on(event,fn){\r\n        /*\r\n            wenn event in Map vorhanden, wird event hinzugefügt\r\n         */\r\n        if(this.events.has(event))\r\n            this.events.get(event).push(fn);\r\n        /*\r\n            wenn event in map noch nicht vorhanden,\r\n            wird entry in map hinzugefügt\r\n         */\r\n        else\r\n            this.events.set(event,[fn]);\r\n    }\r\n    /*\r\n        event-handler wird entfernt\r\n     */\r\n    rm(event,fn){\r\n        /*\r\n            wenn event existiert\r\n         */\r\n        if(this.events.has(event)){\r\n            const e = this.events.get(event);\r\n            for(let i=0;i<e.length;i++)\r\n                //wenn element die gesuchte function, wird sie gelöscht\r\n                if(e[i] === fn)\r\n                    e.splice(i,1);\r\n        }\r\n    }\r\n    /*\r\n        alle registrierten functions eines events werden ausgelöst\r\n     */\r\n    trigger(event,...rest){\r\n        /*\r\n            wenn event existiert\r\n         */\r\n        if(this.events.has(event)){\r\n            /*\r\n                es werden alle functions aufgerufen\r\n             */\r\n            for(let i=0;i<this.events.get(event).length;i++)\r\n                this.events.get(event)[i](...rest);\r\n        }\r\n    }\r\n\r\n    get events() {\r\n        return this._events;\r\n    }\r\n\r\n    set events(value) {\r\n        this._events = value;\r\n    }\r\n}","import BinSearchArray from \"../../util/BinSearch\";\r\nimport Message from \"../message/message\";\r\nimport EventHandler from \"../../util/Event\";\r\nimport {getDispatch} from 'reactn';\r\nimport {loadMessages} from \"../apiCalls\";\r\n\r\nexport class Chat {\r\n\r\n    _type;\r\n    _id;\r\n    _chatName;\r\n    _messages = new BinSearchArray();\r\n    _event = new EventHandler();\r\n    _unreadMessages = 0;\r\n    /*\r\n        are all messages already loaded?\r\n     */\r\n    _reachedTopMessages = false;\r\n\r\n    constructor(type, id,chatName) {\r\n        this.type = type;\r\n        this.id = id;\r\n        this.chatName = chatName;\r\n    }\r\n    /*\r\n        the first message of the object is initialized\r\n     */\r\n    initFirstMessage(messageData){\r\n\r\n        if(!messageData.empty)\r\n            this.messages.add(\r\n                messageData.mid,\r\n                new Message(\r\n                    messageData.mid,\r\n                    messageData.uid,\r\n                    this,\r\n                    new Date(messageData.date),\r\n                    messageData.type,\r\n                    messageData.content\r\n                )\r\n            );\r\n    }\r\n    /*\r\n        messages are loaded\r\n     */\r\n    async loadMessages(num){\r\n        /*\r\n            messages are only loaded, if top not already reached\r\n         */\r\n        if(!this.reachedTopMessages) {\r\n\r\n            const getLastMsgId = () => {\r\n                const msg = this.getLastMessage();\r\n                if (msg !== null)\r\n                    return msg.mid;\r\n                return -1;\r\n            };\r\n            /*\r\n                messages are loaded from server\r\n             */\r\n            const response = await loadMessages({\r\n                chatType: this.type,\r\n                chatId: this.id,\r\n                lastMsgId: getLastMsgId(),\r\n                num: num\r\n            });\r\n\r\n            if (response.ok) {\r\n\r\n                const data = await response.json();\r\n                /*\r\n                    is top already reached?\r\n                 */\r\n                this.reachedTopMessages = data.status === 'reached top';\r\n\r\n                const lMessages = data.messages;\r\n                /*\r\n                    the array that will be returned\r\n                 */\r\n                const messages = new Array(lMessages.length);\r\n                const userTopShown = this.showUserInfoMessage();\r\n\r\n                for (let i = lMessages.length - 1; i >= 0; i--) {\r\n\r\n                    const messageData = lMessages[i];\r\n                    /*\r\n                        message is created\r\n                     */\r\n                    const message =\r\n                        new Message(\r\n                            messageData.mid,\r\n                            messageData.uid,\r\n                            this,\r\n                            new Date(messageData.date),\r\n                            messageData.type,\r\n                            messageData.content\r\n                        );\r\n                    /*\r\n                        message is added to chat\r\n                     */\r\n                    this.messages.add(\r\n                        messageData.mid,\r\n                        message\r\n                    );\r\n                    messages[i] = message.getMessageObject(userTopShown);\r\n                }\r\n                return messages;\r\n            }\r\n            throw new Error();\r\n        }\r\n    }\r\n    /*\r\n        gibt die Nachricht, die am längsten zurück liegt, zurück\r\n     */\r\n    getLastMessage(){\r\n        if (this.messages.length !== 0)\r\n            return this.messages[0].value;\r\n        return null;\r\n    }\r\n    /*\r\n        gibt die neueste Nachricht im chat zurück\r\n     */\r\n    getFirstMessage(){\r\n        if (this.messages.length !== 0)\r\n            return this.messages[this.messages.length - 1].value;\r\n        return null;\r\n    }\r\n    /*\r\n        returns all messages in an array\r\n            userTopShown    should the user at the top be shown?\r\n     */\r\n    getMessages(){\r\n\r\n        const userTopShown = this.showUserInfoMessage();\r\n        const rMessages = new Array(this.messages.length);\r\n\r\n        for(let i=0;i<this.messages.length;i++){\r\n\r\n            const message = this.messages[i].value;\r\n            rMessages[i] = message.getMessageObject(userTopShown);\r\n        }\r\n\r\n        return rMessages;\r\n    }\r\n    /*\r\n        neue Nachricht wird hinzugefügt\r\n     */\r\n    addMessage(uid,mid,type,content){\r\n        const message =\r\n            new Message(\r\n                mid,\r\n                uid,\r\n                this,\r\n                new Date(Date.now()),\r\n                type,\r\n                content\r\n            );\r\n        this.messages.add(mid,message);\r\n        getDispatch().newMsg(\r\n            this,\r\n            this.unreadMessages,\r\n            message.getMessageObject(\r\n                this.showUserInfoMessage()\r\n            ));\r\n    }\r\n    /*\r\n        should the userInfo at the messages be shown (--> only in groupChats)\r\n     */\r\n    showUserInfoMessage(){\r\n        return(this.type === 'groupChat')\r\n    }\r\n    /*\r\n        an object of this chat is returned\r\n     */\r\n    getChatObject(){\r\n        return {\r\n            type: this.type,\r\n            id: this.id,\r\n            chatName: this.chatName,\r\n            latestMessage: this.getLatestMessageObject(),\r\n            unreadMessages: this.unreadMessages\r\n        };\r\n    }\r\n    /*\r\n        an object with the latest message is returned\r\n     */\r\n    getLatestMessageObject(){\r\n        /*\r\n            are there messages?\r\n        */\r\n        if(this.messages.length === 0){\r\n            return null;\r\n        }else{\r\n            const lm = this.getFirstMessage();\r\n            return {\r\n                msgString: lm.getChatViewMsgString(),\r\n                dateString: lm.getChatViewDateString(),\r\n                date: lm.date\r\n            };\r\n        }\r\n    }\r\n\r\n    get type() {\r\n        return this._type;\r\n    }\r\n\r\n    set type(value) {\r\n        this._type = value;\r\n    }\r\n\r\n    get id() {\r\n        return this._id;\r\n    }\r\n\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n\r\n    get messages() {\r\n        return this._messages;\r\n    }\r\n\r\n    set messages(value) {\r\n        this._messages = value;\r\n    }\r\n\r\n    get chatName() {\r\n        return this._chatName;\r\n    }\r\n\r\n    set chatName(value) {\r\n        this._chatName = value;\r\n    }\r\n\r\n    get event() {\r\n        return this._event;\r\n    }\r\n\r\n    set event(value) {\r\n        this._event = value;\r\n    }\r\n\r\n    get unreadMessages() {\r\n        return this._unreadMessages;\r\n    }\r\n\r\n    set unreadMessages(value) {\r\n        this._unreadMessages = value;\r\n    }\r\n\r\n    get reachedTopMessages() {\r\n        return this._reachedTopMessages;\r\n    }\r\n\r\n    set reachedTopMessages(value) {\r\n        this._reachedTopMessages = value;\r\n    }\r\n}\r\n","import chatSocket from \"../chatSocket\";\r\nimport {Chat} from \"./chat\";\r\n\r\nexport class NormalChat extends Chat{\r\n\r\n    _otherUser;\r\n    _isTyping = false;\r\n\r\n    constructor(id,chatName,uid,unreadMessages = 0) {\r\n        super('normalChat',id,chatName);\r\n        this.otherUser = uid;\r\n        this.unreadMessages = unreadMessages;\r\n    }\r\n\r\n    getUsersTyping(){\r\n        if(this.isTyping) {\r\n            const user = chatSocket.users.get(this.otherUser);\r\n            return [\r\n                {\r\n                    uid: user.uid,\r\n                    username: user.username\r\n                }\r\n            ];\r\n        }\r\n        return [];\r\n    }\r\n    /*\r\n        gibt den user zurück, der erst die kürzeste Zeit schreibt\r\n     */\r\n    getLatestUserTyping(){\r\n        if(this.isTyping) {\r\n            const user = chatSocket.users.get(this.otherUser);\r\n            return {\r\n                uid: user.uid,\r\n                username: user.username\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /*\r\n        is called when a user started typing\r\n     */\r\n    startedTyping(uid){\r\n        if(uid === this.otherUser){\r\n            this.isTyping = true;\r\n            this.event.trigger(\"typeState changed\");\r\n        }\r\n    }\r\n    /*\r\n        is called when a user stopped typing\r\n     */\r\n    stoppedTyping(uid){\r\n        if(uid === this.otherUser){\r\n            this.isTyping = false;\r\n            this.event.trigger(\"typeState changed\");\r\n        }\r\n    }\r\n\r\n    get otherUser() {\r\n        return this._otherUser;\r\n    }\r\n\r\n    set otherUser(value) {\r\n        this._otherUser = value;\r\n    }\r\n\r\n    get isTyping() {\r\n        return this._isTyping;\r\n    }\r\n\r\n    set isTyping(value) {\r\n        this._isTyping = value;\r\n    }\r\n}","import chatSocket from \"../chatSocket\";\r\nimport {Chat} from \"./chat\";\r\n\r\nexport class GroupChat extends Chat{\r\n    //array with uids\r\n    _users = [];\r\n    //Array mit uids von den usern, die gerade schreibem\r\n    _usersTyping = [];\r\n\r\n    constructor(id,chatName,uids,unreadMessages = 0) {\r\n        super('groupChat',id,chatName);\r\n        this.users = uids;\r\n        this.unreadMessages = unreadMessages;\r\n    }\r\n\r\n    getUsersTyping(){\r\n        if(this.usersTyping.length > 0) {\r\n\r\n            let rc = [];\r\n            for(let i=0;i<this.usersTyping.length;i++){\r\n                const user = chatSocket.users.get(this.usersTyping[i]);\r\n                rc.push({\r\n                    uid: user.uid,\r\n                    username: user.username\r\n                });\r\n            }\r\n            return rc;\r\n        }\r\n        return [];\r\n    }\r\n    /*\r\n        gibt den user zurück, der am neuestem schriebt\r\n     */\r\n    getLatestUserTyping(){\r\n        if(this.usersTyping.length > 0) {\r\n            const user = chatSocket.users.get(this.usersTyping[this.usersTyping.length - 1]);\r\n            return {\r\n                uid: user.uid,\r\n                username: user.username\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /*\r\n        is called when a user started typing\r\n     */\r\n    startedTyping(uid){\r\n        if(this.isMember(uid)){\r\n            if(!this.isTyping(uid)){\r\n                /*\r\n                    the user is added to the currently typing users\r\n                 */\r\n                this.usersTyping.push(uid);\r\n                this.event.trigger(\"typeState changed\");\r\n            }\r\n        }\r\n    }\r\n    /*\r\n        is called when a user stopped typing\r\n     */\r\n    stoppedTyping(uid){\r\n        if(this.isMember(uid)){\r\n            if(this.isTyping(uid)){\r\n                /*\r\n                    user is removed from the array of currently typing users\r\n                 */\r\n                this.usersTyping.splice(this.getIndexOfTyping(uid),1);\r\n                this.event.trigger(\"typeState changed\");\r\n            }\r\n        }\r\n    }\r\n    /*\r\n        returns true if the uid is member of the chat and not self\r\n     */\r\n    isMember(uid){\r\n        if(uid === chatSocket.userSelf.uid)\r\n            return false;\r\n        return this.users.find(e => e === uid);\r\n    }\r\n    /*\r\n        returns true if the user is currently typing\r\n     */\r\n    isTyping(uid){\r\n        return this.usersTyping.find(e => e === uid);\r\n    }\r\n    /*\r\n        returns the index of a currently typing user\r\n     */\r\n    getIndexOfTyping(uid){\r\n        return this.usersTyping.findIndex(e => e === uid);\r\n    }\r\n\r\n    get users() {\r\n        return this._users;\r\n    }\r\n\r\n    set users(value) {\r\n        this._users = value;\r\n    }\r\n\r\n    get usersTyping() {\r\n        return this._usersTyping;\r\n    }\r\n\r\n    set usersTyping(value) {\r\n        this._usersTyping = value;\r\n    }\r\n}","import {NormalChat} from \"./chat/normalChat\";\r\nimport chatSocket from \"./chatSocket\";\r\nimport User from \"./User\";\r\nimport Message from \"./message/message\";\r\nimport {getDispatch} from 'reactn';\r\nimport {globalData} from \"../global/globalData\";\r\nimport {createNormalChat} from \"./apiCalls\";\r\n\r\nexport default class TempChatLoader{\r\n\r\n    _isShown = false;\r\n    _chatNow;\r\n    /*\r\n        a new temporary chat gets created.\r\n        parameters uid and username required\r\n     */\r\n    createNew(uid,username){\r\n        this.chatNow = new NormalChat(0, username, uid);\r\n    }\r\n    /*\r\n        is the current tempChat already the one with this uid?\r\n     */\r\n    doesExist(uid){\r\n        if(this.chatNow === undefined)\r\n            return false;\r\n        return this.chatNow.otherUser === uid;\r\n    }\r\n    /*\r\n        tempChat gets shown\r\n     */\r\n    show(){\r\n        this.isShown = true;\r\n        getDispatch().showTempChat(this.chatNow);\r\n    }\r\n\r\n    update(){\r\n        getDispatch().updateTempChat(this.chatNow);\r\n    }\r\n\r\n    hide(){\r\n        this.isShown = false;\r\n        getDispatch().hideTempChat();\r\n    }\r\n    /*\r\n        a new normalChat is created out of the current tempChat\r\n     */\r\n    async createNewNormalChat(msg){\r\n\r\n        /*\r\n            the request gets sent to the server\r\n         */\r\n        const otherUid = this.chatNow.otherUser;\r\n        const otherUsername = this.chatNow.chatName;\r\n\r\n        const response = await createNormalChat({\r\n            uid: otherUid,\r\n            username: otherUsername,\r\n            message: {\r\n                type: globalData.messageTypes.normalMessage,\r\n                content: {\r\n                    text: msg,\r\n                    mentions: [],\r\n                    media: []\r\n                }\r\n            }\r\n        });\r\n\r\n        if(response.ok){\r\n\r\n            const data = await response.json();\r\n\r\n            if(chatSocket.users.getIndex(otherUid) === -1){\r\n                chatSocket.users.add(otherUid,new User(otherUid,otherUsername));\r\n            }\r\n            const otherUser = chatSocket.users.get(otherUid);\r\n\r\n            const newChat = new NormalChat(data.ncid,otherUsername,otherUid);\r\n            /*\r\n                chat gets added to user\r\n             */\r\n            otherUser.normalChat = newChat.id;\r\n            /*\r\n                chat is added in binsearchArray\r\n             */\r\n            chatSocket.chats.normal.add(data.ncid,newChat);\r\n            /*\r\n                message is added to chat\r\n             */\r\n            const message = new Message(\r\n                data.mid,\r\n                chatSocket.userSelf.uid,\r\n                newChat,\r\n                new Date(Date.now()),\r\n                globalData.messageTypes.normalMessage,\r\n                {\r\n                    text: msg,\r\n                    mentions: [],\r\n                    media: []\r\n                }\r\n            );\r\n            newChat.messages.add(message.mid,message);\r\n\r\n            //args: chat\r\n            getDispatch().addChat(newChat);\r\n            /*\r\n                currentChat gets changed\r\n             */\r\n            getDispatch().selectChat(newChat);\r\n            /*\r\n                tempChat is hidden\r\n             */\r\n            this.hide();\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    get isShown() {\r\n        return this._isShown;\r\n    }\r\n\r\n    set isShown(value) {\r\n        this._isShown = value;\r\n    }\r\n\r\n    get chatNow() {\r\n        return this._chatNow;\r\n    }\r\n\r\n    set chatNow(value) {\r\n        this._chatNow = value;\r\n    }\r\n}\r\n\r\n","import io from 'socket.io-client';\r\nimport User from \"./User\";\r\nimport BinSearchArray from \"../util/BinSearch\";\r\nimport {NormalChat} from './chat/normalChat';\r\nimport {GroupChat} from \"./chat/groupChat\";\r\nimport EventHandler from \"../util/Event\";\r\nimport TempChatLoader from \"./tempChatLoader\";\r\nimport {getGlobal,getDispatch} from 'reactn';\r\nimport {selectChats} from \"./apiCalls\";\r\n\r\nclass ChatSocket{\r\n\r\n    _socket;\r\n    _userSelf = {\r\n        uid: 0,\r\n        username: \"\"\r\n    };\r\n    _users = new BinSearchArray();\r\n    _chats = {\r\n        normal: new BinSearchArray(),\r\n        group: new BinSearchArray()\r\n    };\r\n    _event = new EventHandler();\r\n    _finishedLoading = false;\r\n    /*\r\n        normalchat not saved in the database\r\n     */\r\n    _temporaryChat = new TempChatLoader();\r\n    _initCalled = false;\r\n\r\n    destruct(){\r\n\r\n        if(this.socket) {\r\n            this.socket.removeAllListeners();\r\n            this.socket.disconnect();\r\n        }\r\n        this.initCalled = false;\r\n    }\r\n\r\n    async init(){\r\n\r\n        const {uid,username} = getGlobal().userSelf;\r\n        /*\r\n            user-Object is created\r\n         */\r\n        this.userSelf = new User(uid,username);\r\n\r\n        this.userInfo = {\r\n            uid: uid,\r\n            username: username\r\n        };\r\n\r\n        this.initCalled = true;\r\n\r\n        this.userSelf = new User(uid,username);\r\n\r\n        this.userInfo = {\r\n            uid: uid,\r\n            username: username\r\n        };\r\n\r\n        this.socket = io.connect('/', {secure: true});\r\n        /*\r\n            authTokens are sent to client\r\n         */\r\n        this.socket.emit('auth', getGlobal().authTokens);\r\n        /*\r\n            is called when user is initialized\r\n         */\r\n        this.socket.on('initialized',() => {\r\n\r\n            this.initChats();\r\n        });\r\n        /*\r\n            msg-handler\r\n         */\r\n        this.socket.on('chat message',data => {\r\n            /*\r\n                gets chat of msg\r\n                adds this message to chat\r\n            */\r\n            const chat = this.getChat(\r\n                data.chat.type,\r\n                data.chat.id\r\n            );\r\n            if(chat !== null) {\r\n                const isCurrentChat = this.isCurrentChat(\r\n                    chat.type,\r\n                    chat.id\r\n                );\r\n                chat.addMessage(\r\n                    data.uid,\r\n                    data.mid,\r\n                    data.type,\r\n                    data.content\r\n                );\r\n                /*\r\n                    hasNewMsg gets updated\r\n                    if current chat --> false\r\n                 */\r\n                chat.hasNewMsg = !isCurrentChat;\r\n                /*\r\n                    if chat is not currentChat, unreadMessages gets incremented\r\n                 */\r\n                chat.unreadMessages ++;\r\n                /*\r\n                    new message event is triggered\r\n                 */\r\n                this.event.trigger(\r\n                    'new message',\r\n                    data.chat.type,\r\n                    data.chat.id\r\n                );\r\n            }\r\n        });\r\n        /*\r\n            started typing\r\n         */\r\n        this.socket.on('started typing',data => {\r\n            /*\r\n                chat is searched\r\n             */\r\n            const chat = this.getChat(\r\n                data.chat.type,\r\n                data.chat.id\r\n            );\r\n            chat.startedTyping(data.uid);\r\n        });\r\n        /*\r\n            stopped typing\r\n         */\r\n        this.socket.on('stopped typing',data => {\r\n            /*\r\n                chat is searched\r\n             */\r\n            const chat = this.getChat(\r\n                data.chat.type,\r\n                data.chat.id\r\n            );\r\n            chat.stoppedTyping(data.uid);\r\n        });\r\n        /*\r\n            the result of the search in new chat\r\n         */\r\n        this.socket.on('users-noChat',data => {\r\n            chatSocket.event.trigger('users-noChat',data);\r\n        });\r\n        /*\r\n            the user has been added to a new chat\r\n         */\r\n        this.socket.on(\"new chat\",data => {\r\n            this.addNewChat(data);\r\n        });\r\n        /*\r\n            Bei disconnect wird Seite neu geladen\r\n         */\r\n        this.socket.on('disconnect',() => {\r\n            setTimeout(function() {\r\n\r\n                alert('Verbindung verloren! Seite wird neu geladen');\r\n                // eslint-disable-next-line no-restricted-globals\r\n                location.reload();\r\n            },1000);\r\n        });\r\n    }\r\n\r\n    async initChats(){\r\n\r\n        const response = await selectChats();\r\n\r\n        if(response.status === 200) {\r\n\r\n            const data = await response.json();\r\n            for (let i = 0; i < data.length; i++) {\r\n                if (data[i].type === 'normalChat') {\r\n                    /*\r\n                        normalChat is added\r\n                     */\r\n                    this.addNewNormalChat(data[i]);\r\n                } else if (data[i].type === 'groupChat') {\r\n                    /*\r\n                        groupChat is added\r\n                     */\r\n                    this.addNewGroupChat(data[i]);\r\n                }\r\n            }\r\n        }\r\n        this.finishedLoading = true;\r\n        this.event.trigger('chats loaded',this.getChatArraySortedByDate());\r\n    }\r\n\r\n    getChatArraySortedByDate(){\r\n\r\n        function getMessageTime (chat) {\r\n            const c = chat.latestMessage;\r\n            if(c !== null)\r\n                return c.date.getTime();\r\n            return new Date(0).getTime();\r\n        }\r\n\r\n        function getMaxDate (chats,iFrom) {\r\n            let max = iFrom;\r\n            for(let i = iFrom+1;i<chats.length;i++){\r\n                if(getMessageTime(chats[max]) < getMessageTime(chats[i]))\r\n                    max = i;\r\n            }\r\n            return max;\r\n        }\r\n        function swap (items, firstIndex, secondIndex) {\r\n            let temp = items[firstIndex];\r\n            items[firstIndex] = items[secondIndex];\r\n            items[secondIndex] = temp;\r\n        }\r\n        /*\r\n            Array is cloned\r\n         */\r\n        function cloneArr (arr) {\r\n            const clone = new Array(arr.length);\r\n            for(let i=0;i<arr.length;i++){\r\n                const chat = arr[i].value;\r\n                clone[i] = chat.getChatObject();\r\n            }\r\n            return clone;\r\n        }\r\n        /*\r\n            es wird ein sortiertes Array zurückgegeben\r\n         */\r\n        function getSorted (chats) {\r\n            //Array wird erzeugt\r\n            const sorted = cloneArr(chats);\r\n            /*\r\n                es wird immer das höchste eingefügt, um Array zu sortieren\r\n             */\r\n            for(let i=0;i<sorted.length-1;i++){\r\n                let max = getMaxDate(sorted,i);\r\n                swap(sorted,i,max);\r\n            }\r\n            return sorted;\r\n        }\r\n        /*\r\n            Arrays werden gemerged\r\n         */\r\n        function mergeArr (arr1,arr2) {\r\n\r\n            const merged = new Array(arr1.length + arr2.length);\r\n            let p1 = 0;\r\n            let p2 = 0;\r\n            for(let i=0;i<merged.length;i++){\r\n                if(! (p2 < arr2.length)){\r\n                    merged[i] = arr1[p1];\r\n                    p1++;\r\n                }else if (! (p1 < arr1.length)){\r\n                    merged[i] = arr2[p2];\r\n                    p2++;\r\n                }else if(getMessageTime(arr1[p1]) > getMessageTime(arr2[p2])){\r\n                    merged[i] = arr1[p1];\r\n                    p1++;\r\n                }else{\r\n                    merged[i] = arr2[p2];\r\n                    p2++;\r\n                }\r\n            }\r\n            return merged;\r\n        }\r\n        const ncSorted = getSorted(this.chats.normal);\r\n        const gcSorted = getSorted(this.chats.group);\r\n\r\n        return mergeArr(ncSorted, gcSorted);\r\n    }\r\n\r\n    isCurrentChat(type,id){\r\n        const currentChat = getGlobal().currentChat;\r\n        return currentChat.type === type && currentChat.id === id;\r\n    };\r\n\r\n    getChat(type,id){\r\n        /*\r\n            type can be:\r\n                normalChat\r\n                tempChat\r\n                groupChat\r\n         */\r\n        if(type === 'normalChat')\r\n            return this.chats.normal.get(id);\r\n        else if(type === 'tempChat') {\r\n            return this.temporaryChat.chatNow;\r\n        }\r\n        else if(type === 'groupChat')\r\n            return this.chats.group.get(id);\r\n    }\r\n    /*\r\n        a new chat gets added\r\n     */\r\n    addNewChat(data){\r\n\r\n        let newChat;\r\n\r\n        if(data.type === 'normalChat'){\r\n            /*\r\n                new normalChat gets created\r\n             */\r\n            newChat = this.addNewNormalChat(data);\r\n\r\n        }else if(data.type === 'groupChat'){\r\n\r\n            newChat = this.addNewGroupChat((data));\r\n        }\r\n        newChat.unreadMessages = 1;\r\n        /*\r\n            event gets triggered\r\n         */\r\n        getDispatch().addChat(newChat);\r\n    }\r\n    /*\r\n        a new normalChat gets added\r\n     */\r\n    addNewNormalChat(data){\r\n        /*\r\n            check if the other user does already exist\r\n                if not --> gets created\r\n         */\r\n        let otherUser;\r\n        if(this.users.getIndex(data.members[0].uid) === -1){\r\n            otherUser = new User(\r\n                data.members[0].uid,\r\n                data.members[0].username\r\n            );\r\n            this.users.add(otherUser.uid,otherUser);\r\n        }else{\r\n            otherUser = this.users.get(data.members[0].uid);\r\n        }\r\n        /*\r\n            new chat gets created\r\n         */\r\n        const newChat = new NormalChat(\r\n            data.id,\r\n            data.chatName,\r\n            otherUser.uid,\r\n            data.unreadMessages\r\n        );\r\n        /*\r\n            normalChat is set at other user\r\n         */\r\n        otherUser.normalChat = newChat.id;\r\n        /*\r\n            first message is initialized\r\n         */\r\n        newChat.initFirstMessage(data.firstMessage);\r\n        /*\r\n            new chat gets added to binSearchArray\r\n         */\r\n        this.chats.normal.add(data.id,newChat);\r\n\r\n        return newChat;\r\n    }\r\n    /*\r\n        a new groupChat gets added\r\n     */\r\n    addNewGroupChat(data){\r\n        /*\r\n            check which do not exist already --> get added\r\n         */\r\n        const members = [];\r\n\r\n        for(let i=0;i<data.members.length;i++) {\r\n\r\n            const member = data.members[i];\r\n            /*\r\n                does the user already exist?\r\n             */\r\n            let user;\r\n            if (this.users.getIndex(member.uid) === -1) {\r\n                user = new User(\r\n                    member.uid,\r\n                    member.username\r\n                );\r\n                this.users.add(user.uid, user);\r\n            } else {\r\n                user = this.users.get(member.uid);\r\n            }\r\n            /*\r\n                member gets added\r\n             */\r\n            members.push(user.uid);\r\n            /*\r\n                chat is added at user\r\n             */\r\n            user.addGroupChat(data.id);\r\n        }\r\n        /*\r\n            new chat gets created\r\n         */\r\n        const newChat =\r\n            new GroupChat(\r\n                data.id,\r\n                data.chatName,\r\n                members,\r\n                data.unreadMessages\r\n            );\r\n        /*\r\n            first message is initialized\r\n         */\r\n        newChat.initFirstMessage(data.firstMessage);\r\n        /*\r\n            new chat gets added to binSearchArray\r\n         */\r\n        this.chats.group.add(data.id,newChat);\r\n\r\n        return newChat;\r\n    }\r\n\r\n    get socket() {\r\n        return this._socket;\r\n    }\r\n\r\n    set socket(value) {\r\n        this._socket = value;\r\n    }\r\n\r\n    get userSelf() {\r\n        return this._userSelf;\r\n    }\r\n\r\n    set userSelf(value) {\r\n        this._userSelf = value;\r\n    }\r\n\r\n    get users() {\r\n        return this._users;\r\n    }\r\n\r\n    set users(value) {\r\n        this._users = value;\r\n    }\r\n\r\n    get chats() {\r\n        return this._chats;\r\n    }\r\n\r\n    set chats(value) {\r\n        this._chats = value;\r\n    }\r\n\r\n    get event() {\r\n        return this._event;\r\n    }\r\n\r\n    set event(value) {\r\n        this._event = value;\r\n    }\r\n\r\n    get finishedLoading() {\r\n        return this._finishedLoading;\r\n    }\r\n\r\n    set finishedLoading(value) {\r\n        this._finishedLoading = value;\r\n    }\r\n\r\n    get temporaryChat() {\r\n        return this._temporaryChat;\r\n    }\r\n\r\n    set temporaryChat(value) {\r\n        this._temporaryChat = value;\r\n    }\r\n\r\n    get initCalled() {\r\n        return this._initCalled;\r\n    }\r\n\r\n    set initCalled(value) {\r\n        this._initCalled = value;\r\n    }\r\n}\r\n\r\nlet chatSocket = new ChatSocket();\r\n\r\nexport function resetChatSocket(){\r\n    chatSocket.destruct();\r\n    chatSocket = new ChatSocket();\r\n}\r\n\r\nexport default chatSocket;\r\n","import React,{Component} from \"reactn\";\r\nimport {Link} from \"react-router-dom\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\n\r\nexport default class ChatItem extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            lastMsg: undefined,\r\n            typeMsg: ''\r\n        }\r\n    }\r\n    /*\r\n        is this chat selected?\r\n     */\r\n    isSelected = () => {\r\n        return this.props.id === this.global.currentChat.id && this.props.type === this.global.currentChat.type;\r\n    };\r\n    /*\r\n        wenn ein user anfängt, oder aufhört zu schreiben, wird diese Methode aufgerufen,\r\n        um die typeMsg zu aktualisieren\r\n     */\r\n    typeStateChanged = () => {\r\n\r\n        const chat = chatSocket.getChat(this.props.type,this.props.id);\r\n        let typeMsg = '';\r\n        /*\r\n            wenn latestuserTyping = null, schreibt gerade keiner\r\n         */\r\n        const userTyping = chat.getLatestUserTyping();\r\n        if(userTyping !== null){\r\n            typeMsg = userTyping.username + \" schreibt...\";\r\n        }\r\n        //state wird aktualisiert\r\n        this.setState({\r\n            typeMsg: typeMsg\r\n        });\r\n    };\r\n\r\n    render() {\r\n\r\n        const renderUnreadMsg = () => {\r\n            if(this.props.unreadMessages === 0)\r\n                return null;\r\n            else\r\n                return(\r\n                    <div className=\"newMsg-number\">\r\n                        {this.props.unreadMessages}\r\n                    </div>\r\n                );\r\n        };\r\n        /*\r\n            in der unteren Hälfte wird angezeigt wer schreibt\r\n            schreibt keiner, wird letzte Nachricht angezeigt\r\n         */\r\n        const renderLowerHalf = () => {\r\n            if(this.state.typeMsg === '')\r\n                return (\r\n                    <div className=\"w-100 lastMsg\">\r\n                        {renderMsg()}\r\n                        {renderDate()}\r\n                    </div>\r\n                );\r\n            else{\r\n                return (\r\n                    <div className=\"w-100 typeMsg\">\r\n                        {this.state.typeMsg}\r\n                    </div>\r\n                );\r\n            }\r\n        };\r\n\r\n        const renderMsg = () => {\r\n            if(this.props.latestMessage)\r\n                return(\r\n                    <span>\r\n                        {this.props.latestMessage.msgString}\r\n                    </span>\r\n                );\r\n            else\r\n                return(\r\n                    <span>\r\n                        Noch keine Nachrichten vorhanden\r\n                    </span>\r\n                );\r\n        };\r\n\r\n        const renderDate = () => {\r\n            if(this.props.latestMessage)\r\n                return(\r\n                    <div className=\"lastMsg-date\">\r\n                        {this.props.latestMessage.dateString}\r\n                    </div>\r\n                );\r\n            else\r\n                return null;\r\n        };\r\n\r\n        const getLink = () => {\r\n            if(this.props.type === 'normalChat'){\r\n                return '/chat/user/' + chatSocket.getChat('normalChat',this.props.id).otherUser;\r\n            }else if(this.props.type === 'groupChat'){\r\n                return '/chat/group/' + this.props.id;\r\n            }else if(this.props.type === 'tempChat'){\r\n                return '/chat/user/' + chatSocket.temporaryChat.chatNow.otherUser;\r\n            }\r\n        };\r\n\r\n        return(\r\n            <li className={\"chat-item\" + (this.isSelected() ? \" selected \" : \"\")}>\r\n                <Link to={getLink()}>\r\n                    <div className=\"w-100\">\r\n                        <strong className=\"chatItem-username\">\r\n                            {this.props.name}\r\n                        </strong>\r\n                        {renderUnreadMsg()}\r\n                    </div>\r\n                    {renderLowerHalf()}\r\n                </Link>\r\n            </li>\r\n        )\r\n    }\r\n\r\n    componentDidMount() {\r\n        const chat = chatSocket.getChat(this.props.type,this.props.id);\r\n        /*\r\n            event listener werden angelegt\r\n         */\r\n        //if(chat)\r\n        chat.event.on(\"typeState changed\",this.typeStateChanged);\r\n        /*else{\r\n            console.log('error',chatSocket.chats.group,this.props.type,this.props.id)\r\n        }*/\r\n    }\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            did component update?\r\n         */\r\n        if(prevProps.type !== this.props.type || prevProps.id !== this.props.id) {\r\n            //Listeners get replaced\r\n            const prevChat = chatSocket.getChat(prevProps.type,prevProps.id);\r\n            prevChat.event.rm(\"typeState changed\",this.typeStateChanged);\r\n\r\n            const newChat = chatSocket.getChat(this.props.type,this.props.id);\r\n            newChat.event.on(\"typeState changed\",this.typeStateChanged);\r\n\r\n            //typeMsg gets deleted\r\n            this.setState({\r\n                typeMsg: ''\r\n            });\r\n        }\r\n\r\n    }\r\n    componentWillUnmount() {\r\n        const chat = chatSocket.getChat(this.props.type,this.props.id);\r\n        /*\r\n            event listener werden entfernt\r\n         */\r\n        chat.event.rm(\"typeState changed\",this.typeStateChanged);\r\n    }\r\n}","import React,{Component} from \"reactn\";\r\nimport ChatSearchBox from \"./ChatSearchBox\";\r\nimport ChatItem from \"./ChatItem\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\n\r\nimport './chatList.scss';\r\n\r\nexport default class ChatList extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            //the current searchValue at the chatlist\r\n            searchValue: ''\r\n        };\r\n    }\r\n\r\n    render() {\r\n\r\n        let found = 0;\r\n\r\n        const showNothingFoundMsg = () => {\r\n            if(found === 0)\r\n                return(\r\n                    <span>\r\n                        Nichts gefunden\r\n                    </span>\r\n                );\r\n            return null;\r\n        };\r\n\r\n        const renderTempChat = () => {\r\n            /*\r\n                is tempChat not null?\r\n             */\r\n            if(this.global.tempChat){\r\n                return(\r\n                    <ChatItem\r\n                        key={-1}\r\n                        id={0}\r\n                        type={'tempChat'}\r\n                        name={this.global.tempChat.chatName}\r\n                        unreadMessages={0}\r\n                        latestMessage={null}\r\n                    />\r\n                );\r\n            }\r\n            return null;\r\n        };\r\n\r\n        return(\r\n                <Dummy>\r\n                    <ChatSearchBox\r\n                        onSearch={searchValue => {\r\n                            this.setState({\r\n                                searchValue: searchValue\r\n                            })\r\n                        }}\r\n                    />\r\n\r\n                    <ul className=\"chat-list\">\r\n                        {renderTempChat()}\r\n                        {this.global.chats.map((chat,i) => {\r\n                            if(chat.chatName.includes(this.state.searchValue)) {\r\n                                found++;\r\n                                return (\r\n                                    <ChatItem\r\n                                        key={i}\r\n                                        id={chat.id}\r\n                                        type={chat.type}\r\n                                        name={chat.chatName}\r\n                                        unreadMessages={chat.unreadMessages}\r\n                                        latestMessage={chat.latestMessage}\r\n                                    />\r\n                                );\r\n                            }\r\n                            return null;\r\n                        })}\r\n                    </ul>\r\n                    {showNothingFoundMsg()}\r\n                </Dummy>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\n\r\nimport './chatViewLoader.scss';\r\n\r\nexport default function ChatViewLoader (props){\r\n    return(\r\n        <div className=\"loader-init\">\r\n            <div className=\"col-sm-12 my-auto\">\r\n                <div className=\"init-container border rounded\">\r\n                    <div className=\"spinner-border text-secondary\"\r\n                         style={{\r\n                             width: '15rem',\r\n                             height: '15rem',\r\n                             borderWidth: '0.5rem'\r\n                         }}\r\n                         role=\"status\">\r\n                        <span className=\"sr-only\">Loading...</span>\r\n                    </div>\r\n                    <div className=\"loader-text\">{props.msg}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import {makeRequest} from \"../../global/requests\";\r\nimport {globalData} from \"../../global/globalData\";\r\n\r\nexport async function loadGroupChat(gcid){\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    return await makeRequest('/group/' + gcid + '/', config);\r\n}\r\nexport async function sendMessage(body){\r\n    const config = {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    return  await makeRequest('/message', config);\r\n}","import React,{Component} from \"react\";\r\nimport chatSocket from \"../../../chatData/chatSocket\";\r\nimport 'emoji-mart/css/emoji-mart.css';\r\nimport { Picker } from 'emoji-mart';\r\nimport {withRouter} from \"react-router-dom\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\nimport {globalData} from \"../../../global/globalData\";\r\nimport {sendMessage} from \"../apiCalls\";\r\n\r\nimport './messageForm.scss';\r\n\r\nclass MessageForm extends Component{\r\n\r\n    _userTyping = false;\r\n    _typeEventEmitted = false;\r\n    _typeTimeout;\r\n    /*\r\n        if the MessageFrom belongs to a tempChat, it has some other actions to do\r\n     */\r\n    _isTempChat;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            message: '',\r\n            showEmoji: false\r\n        }\r\n    }\r\n\r\n    onTyping = event => {\r\n\r\n        this.setState({\r\n           message: event.target.value\r\n        });\r\n\r\n        this.handleTypeMessage();\r\n    };\r\n\r\n    handleTypeMessage = () => {\r\n        /*\r\n            type message get only handled if the chat is not temporary\r\n         */\r\n        if(!this.isTempChat) {\r\n\r\n            if (this.userTyping) {\r\n                clearTimeout(this.typeTimeout);\r\n            }\r\n            this.userTyping = true;\r\n            if (!this.typeEventEmitted) {\r\n                this.typeEventEmitted = true;\r\n                chatSocket.socket.emit('started typing');\r\n            }\r\n            this.typeTimeout = setTimeout(() => {\r\n                this.userTyping = false;\r\n                if (this.typeEventEmitted) {\r\n                    this.typeEventEmitted = false;\r\n                    chatSocket.socket.emit('stopped typing');\r\n                }\r\n            }, 1000);\r\n        }\r\n    };\r\n\r\n    onSubmit = event => {\r\n        event.preventDefault();\r\n        /*\r\n            es kann keine leere Nachricht geschickt werden\r\n         */\r\n        if(this.state.message !== ''){\r\n            const message = this.state.message;\r\n            /*\r\n                input wird geleert\r\n             */\r\n            this.setState({\r\n                message: ''\r\n            });\r\n            if(this.isTempChat) {\r\n\r\n                const {pathname} = this.props.location;\r\n                /*\r\n                    the chat is created\r\n                 */\r\n                chatSocket.temporaryChat.createNewNormalChat(message)\r\n                    .then(redirect => {\r\n                        if(redirect) {\r\n                            this.props.history.replace(\"/chat\");\r\n                            this.props.history.replace(pathname);\r\n                        }\r\n                    });\r\n            }else{\r\n\r\n                this.sendMessage(message)\r\n                    .then(mid => {\r\n                        /*\r\n                            message is added to chat\r\n                         */\r\n                        const chat = chatSocket.getChat(this.props.chatType, this.props.chatId);\r\n                        chat.addMessage(\r\n                            chatSocket.userSelf.uid,\r\n                            mid,\r\n                            globalData.messageTypes.normalMessage,\r\n                            {\r\n                                text: message,\r\n                                mentions: [],\r\n                                media: []\r\n                            }\r\n                        );\r\n                    })\r\n                    .catch(err => {});\r\n            }\r\n        }\r\n    };\r\n\r\n    sendMessage = async msg => {\r\n        /*\r\n            message is sent to server\r\n         */\r\n        const response = await sendMessage({\r\n            type: globalData.messageTypes.normalMessage,\r\n            content: {\r\n                text: msg,\r\n                mentions: [],\r\n                media: []\r\n            }\r\n        });\r\n\r\n        if (response.ok) {\r\n\r\n            const data = await response.json();\r\n            /*\r\n                mid is returned\r\n             */\r\n            return data.mid;\r\n        }\r\n        return new Error();\r\n    };\r\n\r\n    onEmojiInput = emoji => {\r\n\r\n        this.setState({\r\n            message: this.state.message + emoji.native\r\n        });\r\n        this.handleTypeMessage();\r\n    };\r\n\r\n    toggleEmoji = event => {\r\n        this.setState(state => ({\r\n            showEmoji: !state.showEmoji\r\n        }))\r\n    };\r\n\r\n    render() {\r\n        return(\r\n            <Dummy>\r\n                <form onSubmit={this.onSubmit}\r\n                      className=\"msg-form\">\r\n                    <div className=\"message-input\">\r\n                        <input autoComplete=\"off\"\r\n                               placeholder=\"Nachricht:\"\r\n                               name=\"message-input-text\"\r\n                               value={this.state.message}\r\n                               onChange={this.onTyping}\r\n                        />\r\n                        <i className=\"far fa-smile fa-2x emoji-toggle\"\r\n                           onClick={this.toggleEmoji}\r\n                        />\r\n                    </div>\r\n                    <button className=\"btn-submit\" type=\"submit\">\r\n                        <i className=\"far fa-paper-plane fa-2x\"\r\n                           data-toggle=\"tooltip\"\r\n                           title=\"send message\" />\r\n                    </button>\r\n                </form>\r\n                {this.state.showEmoji ?\r\n                    <div style={{\r\n                        position: 'absolute',\r\n                        bottom: '60px',\r\n                        right: '50px',\r\n                        width: '350px',\r\n                        height: '425px'\r\n                    }}>\r\n                        <Picker onSelect={this.onEmojiInput}/>\r\n                    </div>\r\n                : null}\r\n            </Dummy>\r\n        )\r\n    }\r\n\r\n    componentDidMount() {\r\n        /*\r\n            isTempChat gets set\r\n         */\r\n        this.isTempChat = this.props.chatType === 'tempChat';\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            isTempChat gets updated\r\n         */\r\n        this.isTempChat = this.props.chatType === 'tempChat';\r\n    }\r\n\r\n    get userTyping() {\r\n        return this._userTyping;\r\n    }\r\n\r\n    set userTyping(value) {\r\n        this._userTyping = value;\r\n    }\r\n\r\n    get typeEventEmitted() {\r\n        return this._typeEventEmitted;\r\n    }\r\n\r\n    set typeEventEmitted(value) {\r\n        this._typeEventEmitted = value;\r\n    }\r\n\r\n    get typeTimeout() {\r\n        return this._typeTimeout;\r\n    }\r\n\r\n    set typeTimeout(value) {\r\n        this._typeTimeout = value;\r\n    }\r\n\r\n    get isTempChat() {\r\n        return this._isTempChat;\r\n    }\r\n\r\n    set isTempChat(value) {\r\n        this._isTempChat = value;\r\n    }\r\n}\r\n\r\nexport default withRouter(MessageForm);","import React,{Component} from \"reactn\";\r\nimport ReactDOM from 'react-dom';\r\nimport MessageForm from \"./MessageForm\";\r\nimport chatSocket from \"../../../chatData/chatSocket\";\r\nimport Message from \"./message/Message\";\r\nimport {isDifferentDay} from '../../../chatData/message/message'\r\n\r\nimport './chatContainer.scss';\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\n\r\nexport default class ChatContainer extends Component{\r\n\r\n    _isMounted = false;\r\n    _messages;\r\n    _messagesNode;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.assignMessagesRef = this.assignMessagesRef.bind(this);\r\n        this.state = {\r\n            msgLoading: false,\r\n            scrollToBottom: 0,\r\n            messages: [],\r\n            typeMessages: []\r\n        };\r\n    }\r\n    //scroll: https://jsfiddle.net/jwm6k66c/2480/\r\n    scrollHandler = event => {\r\n        this.setState({\r\n            scrollToBottom: this.getScrollToBottom()\r\n        });\r\n        /*\r\n            wenn oben angelangt, werden Nachrichten geladen\r\n         */\r\n        if (this.messagesNode.scrollTop === 0)\r\n            this.loadMessages();\r\n    };\r\n\r\n    setScrollToBottom = val => {\r\n        this.messagesNode.scrollTop = this.messagesNode.scrollHeight - this.messagesNode.offsetHeight - val;\r\n    };\r\n\r\n    getScrollToBottom  = () => {\r\n        return this.messagesNode.scrollHeight - this.messagesNode.offsetHeight - this.messagesNode.scrollTop;\r\n    };\r\n\r\n    assignMessagesRef = target => {\r\n        this.messages = target;\r\n    };\r\n\r\n    loadMessages = () => {\r\n\r\n        const chat = chatSocket.getChat(this.global.currentChat.type,this.global.currentChat.id);\r\n        /*\r\n            loader is only shown, if top not reached\r\n         */\r\n        if(!chat.reachedTopMessages)\r\n            this.setState({\r\n                msgLoading: true\r\n            });\r\n        /*\r\n            messages are loaded\r\n         */\r\n        chat.loadMessages(10)\r\n            .then(messages => {\r\n                /*\r\n                    loader is hidden\r\n                    messages are added\r\n                 */\r\n                this.dispatch.addLoadedMessages(messages);\r\n                this.setState(state => ({\r\n                    msgLoading: false\r\n                }));\r\n                this.setScrollToBottom(this.state.scrollToBottom);\r\n            })\r\n            .catch(err => this.setState({\r\n                msgLoading: false\r\n            }));\r\n    };\r\n    /*\r\n        is called when the selected chat changed\r\n     */\r\n    chatChanged = () => {\r\n        /*\r\n            if scrollToBottom is 0, the messages are loaded\r\n         */\r\n        if (this.messagesNode.scrollTop === 0)\r\n            this.loadMessages();\r\n    };\r\n\r\n    componentDidMount() {\r\n        this.messagesNode = ReactDOM.findDOMNode(this.messages);\r\n\r\n        this.chatChanged();\r\n\r\n        this.isMounted = true;\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            es wird überprüft, ob sich der chat geändert hat\r\n            wenn das der Fall ist:\r\n                wird messages loaded listener auf neuen chat angewandt\r\n                scrollToBottom wird auf 0 gesetzt\r\n                scrolltop wird überprüft\r\n         */\r\n        if(prevProps.chatType !== this.props.chatType || prevProps.chatId !== this.props.chatId) {\r\n\r\n            //scrollToBottom wird auf 0 gesetzt\r\n            this.setScrollToBottom(0);\r\n\r\n            this.chatChanged();\r\n        }\r\n        /*\r\n            wenn scrollToBottom 0 wird zu bottom gescrollt\r\n         */\r\n        if(this.state.scrollToBottom === 0) {\r\n            this.setScrollToBottom(0);\r\n            /*\r\n                newMessages is set to 0\r\n             */\r\n            if(this.global.currentChat.newMessages > 0)\r\n                this.setGlobal(global => ({\r\n                   currentChat: {\r\n                       ...global.currentChat,\r\n                       newMessages: 0\r\n                   }\r\n                }));\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        const showLoaderTop = () => {\r\n            if(this.state.msgLoading)\r\n                return(\r\n                    <div className=\"messageLoader-top\">\r\n                        <div className=\"spinner-border text-secondary\" role=\"status\">\r\n                            <span className=\"sr-only\">Loading...</span>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            return null;\r\n        };\r\n\r\n        const renderNewMessages = () => {\r\n\r\n            if(this.global.currentChat.newMessages > 0)\r\n                return(\r\n                    <div id=\"scroll-down-number\" className=\"number\">\r\n                        {this.global.currentChat.newMessages}\r\n                    </div>\r\n                );\r\n            return null;\r\n        };\r\n\r\n        const renderBtnToBottom = () => {\r\n            if(this.isMounted) {\r\n                if (this.getScrollToBottom() > 10) {\r\n                    return (\r\n                        <div id=\"messages-bottom\"\r\n                             className=\"messages-bottom\"\r\n                             onClick={() => {\r\n                                 this.setState({\r\n                                     scrollToBottom: 0\r\n                                 })\r\n                             }}\r\n                        >\r\n                            <div id=\"btnToBottom\" className=\"chevron-down\">\r\n                                <i className=\"fas fa-chevron-down fa-2x\"/>\r\n                            </div>\r\n                            {renderNewMessages()}\r\n                        </div>\r\n                    )\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n\r\n        let lastDate = new Date(0);\r\n        /*\r\n            wenn der Tag der letzten Nachrichten ein anderer wie der von dieser ist,\r\n            wird ein Container mit Datum gerendert\r\n         */\r\n        const renderDateContainer = msg => {\r\n            if(isDifferentDay(msg.date,lastDate)){\r\n                lastDate = msg.date;\r\n                return(\r\n                    <div className = \"date-container\">\r\n                        <div>\r\n                            {msg.dateString}\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            lastDate = msg.date;\r\n            return null;\r\n        };\r\n\r\n        const renderAlertNoMessages = () => {\r\n            if(this.global.currentChat.messages.length === 0)\r\n                return(\r\n                    <div className=\"alert alert-primary\" role=\"alert\">\r\n                        Noch keine Nachrichten vorhanden\r\n                    </div>\r\n                );\r\n            return null;\r\n        };\r\n\r\n        return(\r\n            <div className=\"chat-container\">\r\n                <div className=\"messages\"\r\n                     onScroll={this.scrollHandler}\r\n                     ref={this.assignMessagesRef}\r\n                >\r\n                    {showLoaderTop()}\r\n                    {this.global.currentChat.messages.map((msg,i) => {\r\n                        return (\r\n                            <Dummy key={i}>\r\n                                {renderDateContainer(msg)}\r\n                                <Message\r\n                                    msg={msg}\r\n                                />\r\n                            </Dummy>\r\n                        );\r\n                    })}\r\n                    {renderAlertNoMessages()}\r\n                    {renderBtnToBottom()}\r\n                </div>\r\n                <MessageForm\r\n                    chatType={this.props.chatType}\r\n                    chatId={this.props.chatId}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.isMounted = false;\r\n    }\r\n\r\n    get isMounted() {\r\n        return this._isMounted;\r\n    }\r\n\r\n    set isMounted(value) {\r\n        this._isMounted = value;\r\n    }\r\n\r\n    get messages() {\r\n        return this._messages;\r\n    }\r\n\r\n    set messages(value) {\r\n        this._messages = value;\r\n    }\r\n\r\n    get messagesNode() {\r\n        return this._messagesNode;\r\n    }\r\n\r\n    set messagesNode(value) {\r\n        this._messagesNode = value;\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport MessageForm from \"./chatContainer/MessageForm\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\n\r\nexport default class TempChatContainer extends Component{\r\n\r\n    render() {\r\n        return(\r\n            <div className=\"chat-container\">\r\n                <div className=\"messages\">\r\n                    <div className=\"alert alert-primary\" role=\"alert\">\r\n                        Noch keine Nachrichten vorhanden\r\n                    </div>\r\n                </div>\r\n                <MessageForm\r\n                    chatType={'tempChat'}\r\n                    chatId={0}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n    componentDidMount() {\r\n        chatSocket.temporaryChat.show();\r\n    }\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(prevProps.uid !== this.props.uid)\r\n            chatSocket.temporaryChat.update();\r\n    }\r\n    componentWillUnmount() {\r\n        chatSocket.temporaryChat.hide();\r\n    }\r\n}","import React from \"react\";\r\n\r\nexport function AddressNotValid() {\r\n    return(\r\n        <div>\r\n            <h2>ungültige Addresse</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function CannotWriteYourself(){\r\n    return(\r\n        <div>\r\n            <h2>Du kannst dir selbst nicht schreiben</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function BlockedByThisUser(){\r\n    return(\r\n        <div>\r\n            <h2>Dieser User hat dich blockiert</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function UserNotExisting(){\r\n    return(\r\n        <div>\r\n            <h2>Dieser User existiert nicht</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function NoMemberInPublicChat(){\r\n    return (\r\n        <div>\r\n            <h2>Du bist nicht Mitglied in diesem chat jetzt beitreten</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function NoAuthorization(){\r\n    return (\r\n        <div>\r\n            <h2>Du bist nicht dazu berechtigt diesen chat anzusehen</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function ChatNotExisting(){\r\n    return (\r\n        <div>\r\n            <h2>Dieser Chat existiert nicht</h2>\r\n        </div>\r\n    );\r\n}\r\nexport function GeneralError(){\r\n    return (\r\n        <div>\r\n            <h2>Fehler</h2>\r\n        </div>\r\n    );\r\n}","import React, {Component} from \"reactn\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\nimport ChatViewLoader from \"./ChatViewLoader\";\r\nimport ChatContainer from \"./chatContainer/ChatContainer\";\r\nimport TempChatContainer from \"./TempChatContainer\";\r\nimport {infoHeaderCenter} from \"../Header/HeaderLeft\";\r\nimport {UserErrorCode,getUserNormalChat} from \"../../chatData/User\";\r\nimport {\r\n    AddressNotValid,\r\n    BlockedByThisUser,\r\n    CannotWriteYourself,\r\n    UserNotExisting\r\n} from \"./chatViewErrorMessages\";\r\n\r\nexport default class NormalChatView extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            uid: 0,\r\n            loaded: false,\r\n            error: UserErrorCode.none\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const renderLoader = () => {\r\n            if(!this.state.loaded){\r\n                return(\r\n                    <ChatViewLoader\r\n                        msg=\"Chat wird geladen\"\r\n                    />\r\n                )\r\n            }\r\n        };\r\n\r\n        const renderChat = () => {\r\n            /*\r\n                es wird überprüft, ob uid number ist\r\n                --> wenn nicht, ungültige Addresse\r\n             */\r\n            if(this.state.error === UserErrorCode.nan){\r\n                return(\r\n                    <AddressNotValid/>\r\n                );\r\n            }\r\n            else if(this.state.error === UserErrorCode.isSelf){\r\n                return(\r\n                    <CannotWriteYourself/>\r\n                );\r\n            }\r\n            /*\r\n                chat wird nur gerendert, wenn geladen\r\n             */\r\n            else if(this.state.loaded){\r\n\r\n                if(this.state.error === UserErrorCode.none){\r\n\r\n                    return(\r\n                        <ChatContainer\r\n                            chatType={this.global.currentChat.type}\r\n                            chatId={this.global.currentChat.id}\r\n                        />\r\n                    )\r\n                }else if(this.state.error === UserErrorCode.tempChat){\r\n                    return(\r\n                        <TempChatContainer uid={this.state.uid}/>\r\n                    )\r\n                }else if(this.state.error === UserErrorCode.blocked){\r\n                    return(\r\n                        <BlockedByThisUser/>\r\n                    )\r\n                }else{\r\n                    return(\r\n                        <UserNotExisting/>\r\n                    )\r\n                }\r\n            }\r\n        };\r\n\r\n        return <div className=\"h-100\">\r\n            {renderLoader()}\r\n            {renderChat()}\r\n        </div>;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.userChanged();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            did uid change?\r\n         */\r\n        if(prevProps.uid !== this.props.uid){\r\n            /*\r\n                is props.uid a number?\r\n             */\r\n            if(isNaN(this.props.uid)){\r\n                this.setState({\r\n                    error: UserErrorCode.nan\r\n                });\r\n            }\r\n            else{\r\n                this.userChanged();\r\n            }\r\n\r\n        }\r\n    }\r\n    /*\r\n        is called when the user changed and when the component mounted\r\n            this is checked after each update\r\n     */\r\n    userChanged = () => {\r\n\r\n        const uid = parseInt(this.props.uid);\r\n\r\n        /*\r\n            is the user self?\r\n         */\r\n        if(this.global.userSelf.uid === uid){\r\n            this.setState({\r\n                error: UserErrorCode.isSelf,\r\n                loaded: true\r\n            });\r\n        }else {\r\n\r\n            const userExists = () => {\r\n\r\n                getUserNormalChat(uid)\r\n                    .then(res => {\r\n                        /*\r\n                            no error\r\n                                checks if existing or tempChat\r\n                         */\r\n                        if (res === UserErrorCode.none) {\r\n                            this.setState({\r\n                                error: res\r\n                            });\r\n                            this.setGlobal({\r\n                                infoHeaderCenter: infoHeaderCenter.normalChat,\r\n                                ihcData: {\r\n                                    name: chatSocket.users.get(uid).username,\r\n                                    uid: uid\r\n                                }\r\n                            }).then();\r\n                            /*\r\n                                normalChat is selected\r\n                             */\r\n                            this.selectNormalChat(uid);\r\n                            /*\r\n                                tempChat\r\n                             */\r\n                        } else if (res === UserErrorCode.tempChat) {\r\n                            this.setState({\r\n                                error: res\r\n                            });\r\n                            this.setGlobal({\r\n                                infoHeaderCenter: infoHeaderCenter.normalChat,\r\n                                ihcData: {\r\n                                    name: chatSocket.temporaryChat.chatNow.chatName,\r\n                                    uid: uid\r\n                                }\r\n                            }).then();\r\n                            /*\r\n                                the temporary chat is selected\r\n                             */\r\n                            this.selectTempChat();\r\n                        }\r\n                        /*\r\n                            some error has occured, state is set\r\n                         */\r\n                        else{\r\n                           this.setState({\r\n                               error: UserErrorCode.error\r\n                           })\r\n                        }\r\n                        this.setState({\r\n                            loaded: true\r\n                        });\r\n\r\n                    })\r\n                    .catch(err => this.setState({\r\n                        error: UserErrorCode.error\r\n                    }));\r\n            };\r\n\r\n            if (chatSocket.finishedLoading) {\r\n                userExists();\r\n            } else {\r\n                chatSocket.event.on('chats loaded', () => {\r\n                    userExists();\r\n                });\r\n            }\r\n\r\n            this.setState({\r\n                uid: parseInt(this.props.uid)\r\n            });\r\n        }\r\n    };\r\n    /*\r\n        the tempChat is selected\r\n     */\r\n    selectTempChat(){\r\n        this.dispatch.showTempChat();\r\n    }\r\n    /*\r\n        a normalCHat is selected\r\n     */\r\n    selectNormalChat(uid){\r\n        /*\r\n            does the user exist?\r\n         */\r\n        if (chatSocket.users.getIndex(uid) === -1) {\r\n\r\n            this.setState({\r\n                error: UserErrorCode.userNotExisting\r\n            });\r\n        }else {\r\n            /*\r\n                chat is pulled from chatSocket\r\n             */\r\n            const id = chatSocket.users.get(uid).normalChat;\r\n            const chat = chatSocket.getChat('normalChat', id);\r\n\r\n            this.dispatch.selectChat(chat);\r\n        }\r\n    }\r\n    /*\r\n        property- display normalChat is removed from global\r\n     */\r\n    componentWillUnmount() {\r\n        this.setGlobal({\r\n            infoHeaderCenter: infoHeaderCenter.none,\r\n            ihcData: null\r\n        }).then();\r\n    }\r\n\r\n}","import React,{Component} from \"react\";\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nimport './modal.scss';\r\n\r\nclass Modal extends Component{\r\n\r\n    render() {\r\n        const clickedOutside = () => {\r\n            this.props.history.goBack();\r\n        };\r\n        return(\r\n            <div\r\n                className=\"modal-outer\"\r\n                onClick={clickedOutside}>\r\n                <div className=\"h-100\" style={{display: \"flex\"}}>\r\n\r\n                        <div\r\n                            className=\"modal-inner\"\r\n                            onClick={event => {event.stopPropagation()}}>\r\n                            <div\r\n                                className=\"btn-close\"\r\n                                onClick={() => {this.props.history.goBack()}}>\r\n                                &times;\r\n                            </div>\r\n                            {this.props.children}\r\n                        </div>\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default withRouter(Modal);\r\n\r\nexport function ModalHeader(props){\r\n    return(\r\n        <div className=\"m-header\">\r\n            {props.children}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function ModalMain(props){\r\n    return(\r\n        <div className=\"m-main\">\r\n            {props.children}\r\n        </div>\r\n    )\r\n}","import React,{Component} from \"react\";\r\n\r\nexport default class UserItem extends Component{\r\n\r\n    clicked = event => {\r\n        if(this.props.isSelected){\r\n            this.props.deselectUser(this.props.index);\r\n        }else\r\n            this.props.selectUser(this.props.index);\r\n    };\r\n\r\n    render() {\r\n        return(\r\n            <li key={this.props.index}\r\n                onClick={this.clicked}\r\n            >\r\n                <div className=\"username\">\r\n                    {this.props.username}\r\n                </div>\r\n                <div className={\"user-select fa-lg\" + (this.props.isSelected ? \" selected\" : \"\")}>\r\n                    <i className=\"fas fa-check\" />\r\n                </div>\r\n            </li>\r\n        );\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport UserItem from \"./UserItem\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\n\r\nconst errorCode={\r\n    none: 0,\r\n    error: 1\r\n};\r\n\r\nexport default class extends Component {\r\n\r\n    scrollParentRef;\r\n    lastRequest = {};\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            /*\r\n                the value of the search input\r\n             */\r\n            searchValue: '',\r\n            /*\r\n                the last search result received from the server\r\n             */\r\n            searchResult: [],\r\n            error: errorCode.none,\r\n            /*\r\n                are there items left?\r\n             */\r\n            hasMore: true\r\n        }\r\n    }\r\n\r\n    searchChanged = event => {\r\n        this.setState({\r\n            searchValue: event.target.value,\r\n            searchResult: [],\r\n            hasMore: true\r\n        });\r\n    };\r\n    /*\r\n        more users are loaded\r\n     */\r\n    loadUsers = async () => {\r\n\r\n        const searchValue = this.state.searchValue;\r\n        const length = this.state.searchResult.length;\r\n\r\n        if(\r\n            this.lastRequest.searchValue !== searchValue\r\n            || this.lastRequest.length !== length\r\n        ) {\r\n\r\n            this.lastRequest = {\r\n                searchValue: searchValue,\r\n                length: length\r\n            };\r\n\r\n            try {\r\n\r\n                const data = await this.props.loadUsers(\r\n                    searchValue,\r\n                    length\r\n                );\r\n\r\n                if (data.length === 0) {\r\n                    this.setState({\r\n                        hasMore: false,\r\n                        error: errorCode.none\r\n                    })\r\n                } else {\r\n                    this.setState(state => ({\r\n                        searchResult: state.searchResult.concat(data),\r\n                        error: errorCode.none\r\n                    }));\r\n                }\r\n\r\n            } catch (error) {\r\n                this.setState({\r\n                    error: errorCode.error\r\n                });\r\n            }\r\n        }\r\n    };\r\n    /*\r\n        is called when an user is selected\r\n     */\r\n    selectUser = index => {\r\n        const user = this.state.searchResult[index];\r\n        this.props.selectUser(user.uid,user.username);\r\n    };\r\n\r\n    deselectUser = index => {\r\n        const user = this.state.searchResult[index];\r\n        this.props.deselectUser(user.uid);\r\n    };\r\n\r\n    render() {\r\n        return(\r\n            <Dummy>\r\n                <form className=\"form-group\" style={{width: '90%',maxWidth: '650px'}}>\r\n                    <input type=\"text\"\r\n                           className=\"form-control p-2 m-2\"\r\n                           placeholder=\"Benutzer suchen\"\r\n                           value={this.state.searchValue}\r\n                           onChange={this.searchChanged}\r\n                    />\r\n                </form>\r\n                <div\r\n                    className=\"selectUsers\"\r\n                    ref={ref => this.scrollParentRef = ref}\r\n                >\r\n                    <InfiniteScroll\r\n                        pageStart={0}\r\n                        loadMore={this.loadUsers}\r\n                        hasMore={this.state.hasMore}\r\n                        loader={\r\n                            <div className=\"loader\" key={-1}>\r\n                                <div\r\n                                    className=\"spinner-border text-secondary\"\r\n                                    role=\"status\"\r\n                                >\r\n                                    <span className=\"sr-only\">\r\n                                        Loading...\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        useWindow={false}\r\n                        getScrollParent={() => this.scrollParentRef}\r\n                    >\r\n                        <ul className=\"selectUsers\">\r\n                            {this.state.searchResult.map((item, index) => (\r\n                                <UserItem\r\n                                    key={index}\r\n                                    index={index}\r\n                                    uid={item.uid}\r\n                                    username={item.username}\r\n                                    selectUser={this.selectUser}\r\n                                    deselectUser={this.deselectUser}\r\n                                    isSelected={this.props.isUserSelected(item.uid)}\r\n                                />\r\n                            ))}\r\n                            {this.state.searchResult.length === 0 ?\r\n                                <div key={-1} className=\"nothingFound\">\r\n                                    Nichts gefunden!\r\n                                </div>\r\n                                :\r\n                                null\r\n                            }\r\n                        </ul>\r\n                    </InfiniteScroll>\r\n                </div>\r\n            </Dummy>\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport UserList from \"./UserList\";\r\nimport UserItem from \"./UserItem\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\n\r\nimport './selectUsers.scss';\r\n\r\nexport default class SelectUsers extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            /*\r\n                the users already selected\r\n             */\r\n            selectedUsers: [],\r\n            showOnlySelected: false\r\n        }\r\n    }\r\n    /*\r\n        gets called when a user gets selected\r\n     */\r\n    selectUser = (uid,username) => {\r\n        this.setState(state => ({\r\n            selectedUsers: state.selectedUsers.concat({uid: uid,username: username})\r\n        }));\r\n    };\r\n\r\n    deselectUser = (uid) => {\r\n        this.setState(state => {\r\n            const arrClone = [...state.selectedUsers];\r\n            const index = arrClone.findIndex(item => {\r\n                return item.uid === uid;\r\n            });\r\n            arrClone.splice(index,1);\r\n            return {\r\n                selectedUsers: arrClone\r\n            }\r\n        });\r\n    };\r\n\r\n    deselectIndex = index => {\r\n        this.deselectUser(this.state.selectedUsers[index].uid);\r\n    };\r\n\r\n    isUserSelected = (uid) => {\r\n        return this.state.selectedUsers.find(item => {\r\n            return item.uid === uid;\r\n        });\r\n    };\r\n    /*\r\n        an Array with the uids of the users gets returned to the parent component\r\n     */\r\n    btnNextClicked = event => {\r\n\r\n        this.props.onNext(this.state.selectedUsers);\r\n    };\r\n\r\n    render() {\r\n\r\n        const renderSelectedUsers = () => {\r\n            if(this.state.selectedUsers.length === 0){\r\n                return (\r\n                    <h4>\r\n                        Noch niemand ausgewählt\r\n                    </h4>);\r\n            }else{\r\n                return(\r\n                    <h4 className=\"w-100\">\r\n                        <span className={\"selected-num\" + (this.state.showOnlySelected ? \" selected\" : \"\")}\r\n                              onClick={event => {\r\n                                  this.setState(state => ({\r\n                                      showOnlySelected: !state.showOnlySelected\r\n                                  }));\r\n                              }}\r\n                        >\r\n                            {this.state.selectedUsers.length}&nbsp;Benutzer\r\n                        </span>\r\n                        &nbsp;ausgewählt\r\n                        <i className=\"fas fa-arrow-right fa-lg float-right btn-next\"\r\n                           onClick={this.btnNextClicked}\r\n                        />\r\n                    </h4>\r\n                )\r\n            }\r\n        };\r\n        /*\r\n            selected users cannot be shown if there is no one selected.\r\n                --> showOnlySelected = false\r\n         */\r\n        if(this.state.selectedUsers.length === 0 && this.state.showOnlySelected)\r\n            this.setState({\r\n                showOnlySelected: false\r\n            });\r\n\r\n        return(\r\n            <Dummy>\r\n                <div className=\"select-users\">\r\n                    {renderSelectedUsers()}\r\n                </div>\r\n                    {!this.state.showOnlySelected ?\r\n                        <UserList selectUser={this.selectUser}\r\n                                  deselectUser={this.deselectUser}\r\n                                  isUserSelected={this.isUserSelected}\r\n                                  loadUsers={this.props.loadUsers}\r\n                        />\r\n                        :\r\n                        <div className=\"selectUsers\">\r\n                            <ul className=\"selectUsers only-selected\">\r\n                                {this.state.selectedUsers.map((item,index) => (\r\n                                    <UserItem\r\n                                        key={index}\r\n                                        index={index}\r\n                                        uid={item.uid}\r\n                                        username={item.username}\r\n                                        selectUser={() => {}}\r\n                                        deselectUser={this.deselectIndex}\r\n                                        isSelected={true}\r\n                                    />\r\n                                ))}\r\n                            </ul>\r\n                        </div>\r\n                    }\r\n            </Dummy>\r\n        )\r\n    }\r\n}","import {makeRequest} from \"../../../global/requests\";\r\n\r\n/*\r\n    the specified members will be added to the chat\r\n        gcid: groupChat -  id\r\n        users: the users\r\n            [\r\n                {uid:(num),username:(str)}\r\n                {uid:(num),username:(str)}\r\n            ]\r\n */\r\nexport const addMembers = async(gcid,users) => {\r\n\r\n    const config = {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            users: users\r\n        })\r\n    };\r\n\r\n    const response =\r\n        await makeRequest(\r\n            '/group/' + gcid + '/members',\r\n            config\r\n        );\r\n    if(response.ok){\r\n        return await response.json();\r\n    }else{\r\n        throw new Error(\"Error adding members\");\r\n    }\r\n}\r\n/*\r\n    all users who are not in the group\r\n        gcid: groupChat -  id\r\n        body: the body of the request\r\n            {\r\n                search: a search can be specified,\r\n                limit: 10,\r\n                start: the number of users who are already loaded\r\n            }\r\n */\r\nexport const fetchUsersNotInGroup = async(gcid,body) => {\r\n\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await makeRequest(\r\n        '/user/notInGroup/' + gcid,\r\n        config\r\n    );\r\n    if(response.ok){\r\n        return await response.json();\r\n    }else{\r\n        throw new Error(\"Error fetching users\");\r\n    }\r\n}\r\n/*\r\n    the user leaves the chat\r\n        gcid: groupChat -  id\r\n    throws error if the user is the only admin\r\n */\r\nexport const leaveChat = async(gcid) => {\r\n\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    const response =\r\n        await makeRequest(\r\n            '/group/' + gcid + '/leave',\r\n            config\r\n        );\r\n    if(response.ok) {\r\n\r\n        const data = await response.json();\r\n\r\n        if(data.error){\r\n            throw new Error(\"Error leaving chat\");\r\n        }\r\n    }else{\r\n        throw new Error(\"Error leaving chat\");\r\n    }\r\n}\r\n/*\r\n    the admin status of the user is removed\r\n        gcid: groupChat -  id\r\n    throws error if the user is the only admin\r\n */\r\nexport const removeSelfAdmin = async(gcid) => {\r\n\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n\r\n    const response =\r\n        await makeRequest(\r\n            '/group/' + gcid + '/removeAdmin',\r\n            config\r\n        );\r\n\r\n    if(response.ok) {\r\n\r\n        const data = await response.json();\r\n\r\n        if(data.error){\r\n            throw new Error(\"Error removing admin\");\r\n        }\r\n    }else{\r\n        throw new Error(\"Error removing admin\");\r\n    }\r\n}","import React from \"react\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport SelectUsers from \"../../selectUsers/SelectUsers\";\r\nimport {ModalHeader, ModalMain} from \"../../../utilComp/Modal\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\nimport {addMembers, fetchUsersNotInGroup} from \"./apiCalls\";\r\n/*\r\n    props:\r\n        gcid: id of the groupChat\r\n */\r\nexport default function AddUsers(props){\r\n\r\n    let history = useHistory();\r\n\r\n    const submitUsers = async (selectedUsers) => {\r\n        /*\r\n            addMembers call returns nothing\r\n         */\r\n        try{\r\n            await addMembers(props.gcid,selectedUsers);\r\n            /*\r\n                if ok, modal is closed\r\n             */\r\n            history.goBack();\r\n        }catch (e){\r\n            //TODO: error message\r\n        }\r\n    };\r\n\r\n    const loadUsers = async (\r\n        searchValue,\r\n        numAlreadyLoaded\r\n    ) => {\r\n\r\n        return await fetchUsersNotInGroup(\r\n            props.gcid,{\r\n                search: searchValue,\r\n                limit: 10,\r\n                start: numAlreadyLoaded\r\n            }\r\n        )\r\n    };\r\n\r\n    return(\r\n        <Dummy>\r\n            <ModalHeader>\r\n                <h2>\r\n                    Benutzer hinzufügen\r\n                </h2>\r\n            </ModalHeader>\r\n            <ModalMain>\r\n                <div className={\"addMembers\"}>\r\n                    <SelectUsers\r\n                        onNext={submitUsers}\r\n                        loadUsers={loadUsers}\r\n                    />\r\n                </div>\r\n            </ModalMain>\r\n        </Dummy>\r\n    )\r\n}","import React,{Component} from \"reactn\";\r\nimport {Link, withRouter} from \"react-router-dom\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\nimport {makeRequest} from \"../../../global/requests\";\r\n\r\nclass UserOptions extends Component {\r\n\r\n    isSelfAdmin = () => {\r\n        return this.props.memberSelf.isAdmin;\r\n    };\r\n\r\n    isMemberSelf(){\r\n        return this.props.member.uid === this.global.userSelf.uid;\r\n    };\r\n\r\n    removeMemberFromChat = async () => {\r\n        if(this.isSelfAdmin()) {\r\n\r\n            const config = {\r\n                method: 'DELETE',\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            };\r\n\r\n            const response =\r\n                await makeRequest(\r\n                    '/group/' + this.props.gcid + '/member/' + this.props.member.uid,\r\n                    config\r\n                );\r\n        }\r\n    };\r\n\r\n    makeMemberAdmin = async () => {\r\n        if(this.isSelfAdmin()) {\r\n\r\n            const config = {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            };\r\n\r\n            const response =\r\n                await makeRequest(\r\n                    '/group/' + this.props.gcid + '/member/' + this.props.member.uid + '/giveAdmin',\r\n                    config\r\n                );\r\n\r\n        }\r\n    };\r\n\r\n    removeMemberAdmin = async () => {\r\n        if(this.isSelfAdmin()) {\r\n\r\n            const config = {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Accept': 'application/json'\r\n                }\r\n            };\r\n\r\n            const response =\r\n                await makeRequest(\r\n                    '/group/' + this.props.gcid + '/member/' + this.props.member.uid + '/removeAdmin',\r\n                    config\r\n                );\r\n        }\r\n    };\r\n\r\n    render(){\r\n\r\n        const {pathname} = this.props.location;\r\n\r\n        return (\r\n            <ul className=\"userOptions\">\r\n                <li key={0}>\r\n                    <Link to={pathname + \"/userInfo/\" + this.props.member.uid}>\r\n                        zeige {this.props.member.username} an\r\n                    </Link>\r\n                </li>\r\n                <li key={1}>\r\n                    <Link to={\"/chat/user/\" + this.props.member.uid}>\r\n                        Nachricht an {this.props.member.username}\r\n                    </Link>\r\n                </li>\r\n                {/*\r\n                    if the member is admin, he has more options\r\n                    */\r\n                    this.isSelfAdmin() && ! this.isMemberSelf() ?\r\n                        <Dummy>\r\n                            <li\r\n                                key={2}\r\n                                className=\"noLink\"\r\n                                onClick={this.removeMemberFromChat}\r\n                            >\r\n                                aus chat entfernen\r\n                            </li>\r\n                            {this.props.member.isAdmin ?\r\n                                <li\r\n                                    key={3}\r\n                                    className=\"noLink\"\r\n                                    onClick={this.removeMemberAdmin}\r\n                                >\r\n                                    admin status entfernen\r\n                                </li>\r\n                                :\r\n                                <li\r\n                                    key={4}\r\n                                    className=\"noLink\"\r\n                                    onClick={this.makeMemberAdmin}\r\n                                >\r\n                                    zu admin machen\r\n                                </li>\r\n                            }\r\n                        </Dummy>\r\n                        : null\r\n                }\r\n            </ul>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withRouter(UserOptions);","import React from \"react\";\r\nimport {Link,useLocation} from \"react-router-dom\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\nimport {leaveChat, removeSelfAdmin} from \"./apiCalls\";\r\n\r\nexport default function ChatOptions(props) {\r\n\r\n    const {pathname} = useLocation();\r\n\r\n    const isSelfAdmin = () => {\r\n        return props.memberSelf.isAdmin;\r\n    };\r\n\r\n    return(\r\n        <ul className=\"chatOptions\">\r\n            {isSelfAdmin() ?\r\n                <Dummy>\r\n                    <li key={0} className=\"addUsers\">\r\n                        <Link to={pathname + \"/addUsers\"}>\r\n                            Benutzer hinzufügen\r\n                        </Link>\r\n                    </li>\r\n                    <li\r\n                        key={1}\r\n                        className=\"removeSelfAdmin noLink\"\r\n                        onClick={() => {\r\n                            removeSelfAdmin(props.gcid)\r\n                                .then(() => {})\r\n                                .catch(err => {console.log(err)})\r\n                        }}\r\n                    >\r\n                        admin status entfernen\r\n                    </li>\r\n                </Dummy>\r\n                : null}\r\n            <li\r\n                key={2}\r\n                className=\"leaveChat noLink\"\r\n                onClick={() => {\r\n                    leaveChat(props.gcid)\r\n                        .then(() => {})\r\n                        .catch(err => {console.log(err)})\r\n                }}\r\n            >\r\n                Chat verlassen\r\n            </li>\r\n        </ul>\r\n    )\r\n}","import React,{Component} from \"react\";\r\nimport InlineEdit from 'react-ions/lib/components/InlineEdit'\r\n\r\nexport default class Edit extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isEditing: false,\r\n            value: this.props.value\r\n        }\r\n    }\r\n\r\n    handleEdit = async event => {\r\n\r\n        const value = event.target.value;\r\n\r\n        this.setState({\r\n            isEditing: false,\r\n            value: value\r\n        });\r\n\r\n        await this.props.onSubmit(value);\r\n    };\r\n\r\n    editPressed = () => {\r\n        this.setState({\r\n            isEditing: true\r\n        });\r\n    };\r\n\r\n    render () {\r\n        return (\r\n            <div className={this.props.class}>\r\n                <InlineEdit\r\n                    name={this.props.name}\r\n                    value={this.state.value}\r\n                    isEditing={this.state.isEditing}\r\n                    changeCallback={this.handleEdit}\r\n                    optClass={\"input\"}\r\n                />\r\n                <i\r\n                    className=\"fas fa-edit edit\"\r\n                    onClick={this.editPressed}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport Edit from \"./inlineEdit\";\r\nimport {makeRequest} from \"../../../../global/requests\";\r\n\r\nexport default class DescriptionEdit extends Component{\r\n\r\n    onSubmit = async value => {\r\n        const config = {\r\n            method: 'PUT',\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                description: value\r\n            })\r\n        };\r\n\r\n        await makeRequest(\r\n            \"/group/\" + this.props.gcid + \"/description\",\r\n            config\r\n        );\r\n    };\r\n\r\n    render () {\r\n        return (\r\n            <Edit\r\n                class={\"description\"}\r\n                name={\"editDescription\"}\r\n                value={this.props.description}\r\n                onSubmit={this.onSubmit}\r\n            />\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport Edit from \"./inlineEdit\";\r\nimport {makeRequest} from \"../../../../global/requests\";\r\n\r\nexport default class ChatNameEdit extends Component{\r\n\r\n    onSubmit = async value => {\r\n        const config = {\r\n            method: 'PUT',\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                chatName: value\r\n            })\r\n        };\r\n\r\n        await makeRequest(\r\n            \"/group/\" + this.props.gcid + \"/chatName\",\r\n            config\r\n        );\r\n    };\r\n\r\n    render () {\r\n        return (\r\n            <Edit\r\n                class={\"chatName\"}\r\n                name={\"editChatName\"}\r\n                value={this.props.chatName}\r\n                onSubmit={this.onSubmit}\r\n            />\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport {withRouter} from 'react-router-dom';\r\nimport chatSocket from \"../../../chatData/chatSocket\";\r\nimport Dropdown from \"rc-dropdown\";\r\nimport UserOptions from \"./UserOptions\";\r\nimport ChatOptions from \"./ChatOptions\";\r\nimport DescriptionEdit from \"./edit/editDescription\";\r\nimport ChatNameEdit from \"./edit/editChatName\";\r\n\r\nimport'./groupChatInfo.scss';\r\n\r\n/*\r\n    TODO groupchatinfo change socket events\r\n */\r\nclass GroupChatInfo extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: false,\r\n            data: null\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        if(this.state.error)\r\n            return(\r\n                <div className=\"alert alert-danger\" role=\"alert\">\r\n                    Ein Fehler ist aufgetreten!\r\n                </div>\r\n            );\r\n        const uidSelf = chatSocket.userSelf.uid;\r\n\r\n        return(\r\n            <div className=\"groupChatInfo\">\r\n                {this.props.data.memberSelf.isAdmin ?\r\n                    <h1>\r\n                        <ChatNameEdit\r\n                            gcid={this.props.gcid}\r\n                            chatName={this.props.data.chatName}\r\n                        />\r\n                    </h1>\r\n                    :\r\n                    <div className=\"chatName\">\r\n                        <h1>\r\n                            {this.props.data.chatName}\r\n                        </h1>\r\n                    </div>\r\n                }\r\n                {this.props.data.memberSelf.isAdmin ?\r\n                    <DescriptionEdit\r\n                        gcid={this.props.gcid}\r\n                        description={this.props.data.description}\r\n                    />\r\n                    :\r\n                    <div className=\"description\">\r\n                        {this.props.data.description}\r\n                    </div>\r\n                }\r\n                <Dropdown\r\n                    trigger={['click']}\r\n                    overlay={\r\n                        <ChatOptions\r\n                            gcid={this.props.gcid}\r\n                            memberSelf={this.props.data.memberSelf}\r\n                        />\r\n                    }\r\n                    >\r\n                    <i\r\n                        className=\"fas fa-ellipsis-v fa-lg chat-options-btn fa-2x\"\r\n                        role=\"button\"\r\n                    />\r\n                </Dropdown>\r\n\r\n                <h4>\r\n                    {this.props.data.members.length}\r\n                    &nbsp;Mitglieder:\r\n                </h4>\r\n                <ul className=\"userList\">\r\n                    {this.props.data.members.map((item,index) => (\r\n                        <li key={index}>\r\n                            <div className=\"userItem\">\r\n                            {uidSelf === item.uid ?\r\n                                <span>Du</span>\r\n                            :\r\n                                item.username\r\n                            }\r\n                            <div className=\"right\">\r\n                                {item.isAdmin ?\r\n                                    <span className=\"user-admin\">\r\n                                        Admin&nbsp;&nbsp;\r\n                                    </span>\r\n                                : null}\r\n                                <Dropdown\r\n                                    trigger={['click']}\r\n                                    overlay={\r\n                                        <UserOptions\r\n                                            gcid={this.props.gcid}\r\n                                            memberSelf={this.props.data.memberSelf}\r\n                                            member={item}\r\n                                        />\r\n                                    }\r\n                                    animation=\"slide-up\"\r\n                                    alignPoint\r\n                                >\r\n                                    <i\r\n                                        className=\"fas fa-ellipsis-v fa-lg\"\r\n                                        role=\"button\"\r\n                                    />\r\n                                </Dropdown>\r\n                            </div>\r\n                            </div>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default withRouter(GroupChatInfo);","import React from \"react\";\r\nimport {Route, Switch, useRouteMatch} from \"react-router-dom\";\r\nimport Modal from \"../../../utilComp/Modal\";\r\nimport AddUsers from \"./AddUsers\";\r\nimport GroupChatInfo from \"./GroupChatInfo\";\r\nimport Responsive from \"../../../responsive/Responsive\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\n\r\nexport default function ModalRouterGroupChatInfo(props){\r\n\r\n    let { path } = useRouteMatch();\r\n\r\n    const groupChatInfo = (\r\n        <GroupChatInfo\r\n            gcid={props.gcid}\r\n            data={props.data}\r\n        />\r\n    );\r\n\r\n    return(\r\n        <Dummy>\r\n            <Responsive displayIn={[\"Mobile\"]}>\r\n                <Switch>\r\n                    <Route path={`${path}/addUsers`}>\r\n                        <AddUsers\r\n                            gcid={props.gcid}\r\n                        />\r\n                    </Route>\r\n                    <Route path={\"*\"}>\r\n                        {groupChatInfo}\r\n                    </Route>\r\n                </Switch>\r\n            </Responsive>\r\n            <Responsive displayIn={[\"Laptop\",\"Tablet\"]}>\r\n                <Switch>\r\n                    <Route path={`${path}/addUsers`}>\r\n                        <Modal>\r\n                                <AddUsers\r\n                                    gcid={props.gcid}\r\n                                />\r\n                        </Modal>\r\n                    </Route>\r\n                </Switch>\r\n                {groupChatInfo}\r\n            </Responsive>\r\n        </Dummy>\r\n    )\r\n}","import React,{Component} from \"reactn\";\r\nimport ChatViewLoader from \"./ChatViewLoader\";\r\nimport ChatContainer from \"./chatContainer/ChatContainer\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\nimport {infoHeaderCenter} from \"../Header/HeaderLeft\";\r\nimport ModalRouterGroupChatInfo from \"./groupChatInfo/ModalRouterGroupChatInfo\";\r\nimport {\r\n    AddressNotValid,\r\n    ChatNotExisting,\r\n    NoAuthorization,\r\n    NoMemberInPublicChat,\r\n    GeneralError\r\n} from \"./chatViewErrorMessages\";\r\nimport {loadGroupChat} from \"./apiCalls\";\r\n\r\nexport const groupChatErrorCode = {\r\n    none: 0,\r\n    nan: 1,\r\n    chatNotExisting: 2,\r\n    notPartOfChat: 3,\r\n    private: 4,\r\n    general: 5\r\n};\r\n\r\nexport const groupChatTabs = {\r\n    chat: 0,\r\n    info: 1\r\n};\r\n\r\nexport default class GroupChatView extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            gcid: 0,\r\n            loaded: false,\r\n            chatData: null,\r\n            error: groupChatErrorCode.none\r\n        }\r\n    }\r\n\r\n    loadGroupChatInfo = async(gcid) => {\r\n\r\n        try {\r\n            const response = await loadGroupChat(this.props.gcid);\r\n\r\n            if(response.status === 403)\r\n                return groupChatErrorCode.private;\r\n\r\n            else if(response.status === 404)\r\n                return groupChatErrorCode.chatNotExisting;\r\n\r\n            else if (response.ok) {\r\n\r\n                let data = await response.json();\r\n\r\n                this.setState({\r\n                    chatData: data\r\n                });\r\n\r\n                if(data.error) {\r\n\r\n                    if (data.error === 'not part of chat')\r\n                        return groupChatErrorCode.notPartOfChat;\r\n\r\n                    else\r\n                        return groupChatErrorCode.general\r\n\r\n                }else if(chatSocket.chats.group.getIndex(gcid) !== -1){\r\n\r\n                    return groupChatErrorCode.none;\r\n                }\r\n            }\r\n            else {\r\n                return groupChatErrorCode.general\r\n            }\r\n        } catch (err) {\r\n            return groupChatErrorCode.general\r\n        }\r\n    };\r\n    /*\r\n        is called after the chatId changed\r\n     */\r\n    chatChanged = () => {\r\n        /*\r\n            is props.gcid a number?\r\n         */\r\n        if(isNaN(this.props.gcid)){\r\n            this.setState({\r\n                error: groupChatErrorCode.nan,\r\n                loaded: true\r\n            });\r\n        }else{\r\n\r\n            const chatExists = () => {\r\n\r\n                const gcid = parseInt(this.props.gcid);\r\n\r\n                this.loadGroupChatInfo(gcid)\r\n                    .then(r => {\r\n                        if (r === groupChatErrorCode.none) {\r\n\r\n                            this.selectGroupChat(gcid);\r\n                            this.setState({\r\n                                loaded: true,\r\n                                error: groupChatErrorCode.none,\r\n                                gcid: gcid\r\n                            });\r\n                            this.setGlobal({\r\n                                infoHeaderCenter: infoHeaderCenter.groupChat,\r\n                                ihcData: {\r\n                                    name: chatSocket.chats.group.get(gcid).chatName,\r\n                                    gcid: gcid\r\n                                }\r\n                            }).then();\r\n                        } else {\r\n                            this.setState({\r\n                                loaded: true,\r\n                                error: r\r\n                            });\r\n                        }\r\n                    })\r\n                    .catch();\r\n            };\r\n\r\n            if (chatSocket.finishedLoading) {\r\n                chatExists();\r\n            } else {\r\n                chatSocket.event.on('chats loaded', () => {\r\n                    chatExists();\r\n                });\r\n            }\r\n        }\r\n    };\r\n    /*\r\n        groupChat is selected\r\n     */\r\n    selectGroupChat(gcid){\r\n        /*\r\n            does the chat exist?\r\n         */\r\n        if (chatSocket.chats.group.getIndex(gcid) === -1) {\r\n\r\n            this.setState({\r\n                error: groupChatErrorCode.chatNotExisting\r\n            })\r\n        } else {\r\n\r\n            const chat = chatSocket.chats.group.get(gcid)\r\n            this.dispatch.selectChat(chat);\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.chatChanged();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            did gcid change?\r\n         */\r\n        if(prevProps.gcid !== this.props.gcid){\r\n            this.chatChanged();\r\n\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.setGlobal({\r\n            infoHeaderCenter: infoHeaderCenter.none,\r\n            ihcData: null\r\n        }).then();\r\n    }\r\n\r\n    render() {\r\n        const renderLoader = () => {\r\n            if(!this.state.loaded){\r\n                return(\r\n                    <ChatViewLoader\r\n                        msg=\"Chat wird geladen\"\r\n                    />\r\n                )\r\n            }\r\n        };\r\n\r\n        const renderChat = () => {\r\n            /*\r\n                es wird überprüft, ob uid number ist\r\n                --> wenn nicht, ungültige Addresse\r\n             */\r\n            if (this.state.error === groupChatErrorCode.nan) {\r\n                return (\r\n                    <AddressNotValid/>\r\n                );\r\n            }\r\n            /*\r\n                chat wird nur gerendert, wenn geladen\r\n             */\r\n            else if (this.state.loaded) {\r\n\r\n                switch(this.state.error){\r\n\r\n                    case groupChatErrorCode.none:\r\n\r\n                        switch(this.props.tab){\r\n                            case(groupChatTabs.chat):\r\n                                return (\r\n                                    <ChatContainer\r\n                                        chatType={this.global.currentChat.type}\r\n                                        chatId={this.global.currentChat.id}\r\n                                    />\r\n                                );\r\n\r\n                            case(groupChatTabs.info):\r\n                                return(\r\n                                    <ModalRouterGroupChatInfo\r\n                                        gcid={this.state.gcid}\r\n                                        data={this.state.chatData}\r\n                                    />\r\n                                );\r\n\r\n                            default:\r\n                                return null;\r\n                        }\r\n\r\n                    case groupChatErrorCode.notPartOfChat:\r\n                        return (\r\n                            <NoMemberInPublicChat/>\r\n                        );\r\n\r\n                    case groupChatErrorCode.private:\r\n                        return (\r\n                            <NoAuthorization/>\r\n                        );\r\n\r\n                    case groupChatErrorCode.chatNotExisting:\r\n                        return (\r\n                            <ChatNotExisting/>\r\n                        );\r\n\r\n                    case groupChatErrorCode.general:\r\n                        return(\r\n                            <GeneralError/>\r\n                        );\r\n\r\n                    default:\r\n                        return null;\r\n                }\r\n            }\r\n        };\r\n\r\n        return (\r\n            <div className=\"h-100\">\r\n                {renderLoader()}\r\n                {renderChat()}\r\n            </div>\r\n        );\r\n    }\r\n}","import React, {Component} from \"react\";\r\nimport {Link,withRouter} from \"react-router-dom\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\n\r\nclass UserItem extends Component{\r\n\r\n    elementClicked = event => {\r\n\r\n        chatSocket.temporaryChat.createNew(this.props.uid,this.props.username);\r\n    };\r\n\r\n    render() {\r\n        return(\r\n            <li>\r\n                <Link to={\"/chat/user/\" + this.props.uid}\r\n                      onClick={this.elementClicked}\r\n                      replace={true}\r\n                >\r\n                {this.props.username}\r\n                </Link>\r\n            </li>\r\n        )\r\n    }\r\n}\r\nexport default withRouter(UserItem);","import React,{Component} from \"react\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\nimport UserItem from \"./UserItem\";\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\n\r\nimport './selectChat.scss';\r\n\r\nconst errorCode={\r\n    none: 0,\r\n    error: 1\r\n};\r\n/*\r\n    props:\r\n        showSearchBar: boolean\r\n            if false: searchValue comes as prop\r\n        searchValue\r\n        loadChats: function(searchValue,numAlreadyLoaded)\r\n */\r\nexport default class SelectChat extends Component{\r\n\r\n    scrollParentRef;\r\n    lastRequest = {};\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: errorCode.none,\r\n            showOptions: false,\r\n            /*\r\n                the value of the search input\r\n             */\r\n            searchValue: '',\r\n            /*\r\n                the last search result received from the server\r\n             */\r\n            searchResult: [],\r\n            /*\r\n                are there items left?\r\n             */\r\n            hasMore: true\r\n        };\r\n    }\r\n    /*\r\n        gets called when the search of the user changed. the new result gets requested\r\n     */\r\n    searchChanged = (searchValue) => {\r\n\r\n        this.setState({\r\n            searchValue: searchValue,\r\n            searchResult: [],\r\n            hasMore: true\r\n        });\r\n    };\r\n    /*\r\n        more chats are loaded\r\n     */\r\n    loadChats = async () => {\r\n\r\n        const searchValue = this.state.searchValue;\r\n        const length = this.state.searchResult.length;\r\n\r\n        if(\r\n            this.lastRequest.searchValue !== searchValue\r\n            || this.lastRequest.length !== length\r\n        ) {\r\n\r\n            this.lastRequest = {\r\n                searchValue: searchValue,\r\n                length: length\r\n            };\r\n\r\n            try {\r\n\r\n                const response = await this.props.loadChats(\r\n                    searchValue,\r\n                    length\r\n                );\r\n\r\n                if (response.ok) {\r\n                    //return json\r\n                    let data = await response.json();\r\n\r\n                    if (data.length === 0) {\r\n                        this.setState({\r\n                            hasMore: false\r\n                        })\r\n                    } else {\r\n                        this.setState(state => ({\r\n                            searchResult: state.searchResult.concat(data)\r\n                        }));\r\n                    }\r\n                    this.setState({\r\n                        error: errorCode.none\r\n                    });\r\n                } else {\r\n                    this.setState({\r\n                        error: errorCode.error\r\n                    });\r\n                }\r\n            } catch (error) {\r\n                this.setState({\r\n                    error: errorCode.error\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            is searchBar is not shown,\r\n                it is checked if searchValue has changed\r\n         */\r\n        if(!this.props.showSearchBar){\r\n            if(this.props.searchValue !== prevProps.searchValue){\r\n                this.searchChanged(this.props.searchValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        if(this.state.error === errorCode.error){\r\n            return(\r\n                <div className=\"alert alert-danger\" role=\"alert\" key={0}>\r\n                    Ein Fehler ist aufgetreten!\r\n                </div>\r\n            )\r\n        }\r\n            return (\r\n                <Dummy>\r\n                    {/*\r\n                        if showSearchBar is true, it gets shown\r\n                         */\r\n                        this.props.showSearchBar ?\r\n                            <div className=\"user-top\">\r\n                                <div className=\"searchUser\">\r\n                                    <input type=\"text\"\r\n                                           name=\"newChat-searchUser\"\r\n                                           className=\"form-control\"\r\n                                           placeholder=\"Benutzer suchen\"\r\n                                           onChange={(event) => {\r\n                                               this.searchChanged()\r\n                                           }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            : null\r\n                    }\r\n                    <div\r\n                        className=\"selectChat\"\r\n                        ref={ref => this.scrollParentRef = ref}\r\n                    >\r\n                        <InfiniteScroll\r\n                            pageStart={0}\r\n                            loadMore={this.loadChats}\r\n                            hasMore={this.state.hasMore}\r\n                            loader={\r\n                                <div className=\"loader\" key={-1}>\r\n                                    <div\r\n                                        className=\"spinner-border text-secondary\"\r\n                                        role=\"status\"\r\n                                    >\r\n                                        <span className=\"sr-only\">\r\n                                            Loading...\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            }\r\n                            useWindow={false}\r\n                            getScrollParent={() => this.scrollParentRef}\r\n                            >\r\n                            <ul\r\n                                className=\"selectChat\">\r\n                                {this.state.searchResult.map((item, index) => (\r\n                                    <UserItem\r\n                                        key={index}\r\n                                        uid={item.uid}\r\n                                        username={item.username}\r\n                                        hide={this.props.hide}\r\n                                    />\r\n                                ))}\r\n                                {this.state.searchResult.length === 0 ?\r\n                                    <div key={-1} className=\"nothingFound\">\r\n                                        Nichts gefunden!\r\n                                    </div>\r\n                                    :\r\n                                    null\r\n                                }\r\n                            </ul>\r\n                        </InfiniteScroll>\r\n                    </div>\r\n                </Dummy>\r\n            );\r\n    }\r\n}","import {makeRequest} from \"../../global/requests\";\r\n\r\nexport async function requestUsersNoChat(body){\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    /*\r\n        response is returned\r\n     */\r\n    return await makeRequest('/user/noChat', config);\r\n}\r\nexport async function createGroupChat(body){\r\n    const config = {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    return await makeRequest('/group/', config);\r\n}\r\nexport async function fetchUsers(body){\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await makeRequest('/user/', config);\r\n\r\n    if(response.ok){\r\n        return await response.json();\r\n    }else{\r\n        throw new Error(\"Error fetching users\");\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport {tabs} from \"../NewChat\";\r\nimport Dummy from \"../../../utilComp/Dummy\";\r\nimport SelectChat from \"../../selectChat/SelectChat\";\r\nimport Dropdown from 'rc-dropdown';\r\n\r\nimport 'rc-dropdown/assets/index.css';\r\n\r\nimport './chooseUser.scss';\r\nimport {requestUsersNoChat} from \"../apiCalls\";\r\n\r\nconst errorCode={\r\n    none: 0,\r\n    error: 1\r\n};\r\n\r\nexport default class ChooseUser extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: errorCode.none,\r\n            /*\r\n                the value of the search input\r\n             */\r\n            searchValue: ''\r\n        };\r\n    }\r\n    /*\r\n        when new group gets clicked\r\n     */\r\n    newGroupClick = event => {\r\n        event.stopPropagation();\r\n        this.props.setCurrentTab(tabs.newGroup);\r\n    };\r\n    /*\r\n        when join group is clicked\r\n     */\r\n    joinGroupClick = event => {\r\n        event.stopPropagation();\r\n        this.props.setCurrentTab(tabs.chooseGroup);\r\n    };\r\n    /*\r\n        gets called when the search of the user changed. the new result gets requested\r\n     */\r\n    searchChanged = event => {\r\n        const searchValue = event.target.value;\r\n\r\n        const searchValid = true;\r\n\r\n        this.setState({\r\n            searchValue: searchValue,\r\n            searchValid: searchValid\r\n        });\r\n    };\r\n\r\n    loadChats = async (\r\n        searchValue,\r\n        numAlreadyLoaded\r\n    ) => {\r\n\r\n        /*\r\n            response is returned\r\n         */\r\n        return await requestUsersNoChat({\r\n            search: searchValue,\r\n            limit: 10,\r\n            start: numAlreadyLoaded\r\n        });\r\n    };\r\n\r\n    render() {\r\n\r\n        const options = (\r\n            <div className=\"options\">\r\n                <ul>\r\n                    <li onClick={this.newGroupClick}>\r\n                        neue Gruppe\r\n                    </li>\r\n                    <li onClick={this.joinGroupClick}>\r\n                        einer Gruppe beitreten\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        );\r\n\r\n        return(\r\n            <Dummy>\r\n                <div className=\"user-top\">\r\n                    <div className=\"searchUser\">\r\n                        <input type=\"text\"\r\n                               name=\"newChat-searchUser\"\r\n                               className=\"form-control\"\r\n                               placeholder=\"Benutzer suchen\"\r\n                               onChange={this.searchChanged}\r\n                        />\r\n                    </div>\r\n                    <div className=\"user-more\">\r\n                        <Dropdown\r\n                            trigger={['click']}\r\n                            overlay={options}\r\n                            animation=\"slide-up\"\r\n                            alignPoint\r\n                        >\r\n                            <i className=\"fas fa-ellipsis-h fa-2x\"\r\n                               role=\"button\"\r\n                            />\r\n                        </Dropdown>\r\n                    </div>\r\n                </div>\r\n                <SelectChat\r\n                    showSearchBar={false}\r\n                    searchValue={this.state.searchValue}\r\n                    loadChats={this.loadChats}\r\n                />\r\n            </Dummy>\r\n        );\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/placeholder.3c40b139.png\";","import React,{Component} from \"react\";\r\n\r\nimport './groupInfoForm.scss';\r\nimport placeholder from '../../../img/placeholder.png';\r\n\r\nexport default class GroupInfoForm extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state={\r\n            groupName: '',\r\n            description: '',\r\n            isPublic: false\r\n        }\r\n    }\r\n\r\n    groupNameChanged = event => {\r\n        this.setState({\r\n            groupName: event.target.value\r\n        })\r\n    };\r\n\r\n    descriptionChanged = event => {\r\n        this.setState({\r\n            description: event.target.value\r\n        })\r\n    };\r\n\r\n    isPublicChanged = () => {\r\n        this.setState(state => ({\r\n           isPublic: !state.isPublic\r\n        }));\r\n    };\r\n\r\n    formSubmitted = event => {\r\n\r\n        event.preventDefault();\r\n\r\n        if(this.state.groupName !== '')\r\n            this.props.submitGroup({\r\n                name: this.state.groupName,\r\n                description: this.state.description,\r\n                isPublic: this.state.isPublic\r\n            });\r\n    };\r\n\r\n    render() {\r\n\r\n        return(\r\n            <div className=\"groupInfoForm\">\r\n                <form onSubmit={this.formSubmitted}>\r\n                    <img\r\n                        style={{\r\n                            display: 'none'\r\n                        }}\r\n                        id=\"groupImgInput1\"\r\n                        src={placeholder}\r\n                        alt=\"Placeholder\"\r\n                    />\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"exampleFormControlInput1\">\r\n                            Gruppenname\r\n                        </label>\r\n                        <input type=\"text\"\r\n                               name=\"groupName\"\r\n                               className=\"form-control\"\r\n                               id=\"input-groupName\"\r\n                               placeholder=\"Gruppenname\"\r\n                               value={this.state.name}\r\n                               onChange={this.groupNameChanged}\r\n                               minLength={1}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label\r\n                            htmlFor=\"description1\"\r\n                        >\r\n                            Beschreibung\r\n                        </label>\r\n                        <textarea\r\n                            className=\"form-control\"\r\n                            id=\"description1\"\r\n                            rows=\"3\"\r\n                            value={this.state.description}\r\n                            onChange={this.descriptionChanged}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"check-container\">\r\n                            öffentlicher chat\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={this.state.isPublic}\r\n                                onChange={this.isPublicChanged}\r\n                            />\r\n                            <span className=\"checkmark\">\r\n                                <i className=\"fas fa-check\" />\r\n                            </span>\r\n                        </label>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"float-right btn btn-primary m-3\"\r\n                        >\r\n                            Gruppe erstellen\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport {withRouter} from \"react-router-dom\";\r\nimport SelectUsers from \"../../selectUsers/SelectUsers\";\r\nimport GroupInfoForm from \"./GroupInfoForm\";\r\nimport {createGroupChat, fetchUsers} from \"../apiCalls\";\r\n\r\nconst tabs = {\r\n    selectUsers: 0,\r\n    enterChatInfo: 1\r\n};\r\n\r\nclass NewGroup extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            currentTab: tabs.selectUsers,\r\n            selectedUsers: []\r\n        }\r\n    }\r\n\r\n    showEnterChatInfo = selectedUsers => {\r\n\r\n        this.setState({\r\n            currentTab: tabs.enterChatInfo,\r\n            selectedUsers: selectedUsers\r\n        });\r\n    };\r\n\r\n    submitGroup = data => {\r\n\r\n        const users = new Array(this.state.selectedUsers.length);\r\n        for(let i=0;i<this.state.selectedUsers.length;i++){\r\n            users[i] = {\r\n                uid: this.state.selectedUsers[i].uid,\r\n                username: this.state.selectedUsers[i].username,\r\n                isAdmin: false\r\n            };\r\n        }\r\n\r\n        this.createGroupChat(data,users).then(r => {});\r\n    };\r\n\r\n    createGroupChat = async (data,users) => {\r\n        try {\r\n            const response = await createGroupChat({\r\n                data: data,\r\n                users: users\r\n            });\r\n            /*\r\n                if ok, modal is closed\r\n             */\r\n            if(response.ok)\r\n                this.props.history.goBack();\r\n\r\n        }catch(error){\r\n\r\n        }\r\n    };\r\n\r\n    loadUsers = async (\r\n        searchValue,\r\n        numAlreadyLoaded\r\n    ) => {\r\n        /*\r\n            response is returned\r\n         */\r\n        return await fetchUsers({\r\n            search: searchValue,\r\n            limit: 10,\r\n            start: numAlreadyLoaded\r\n        })\r\n    };\r\n\r\n    render() {\r\n\r\n        switch(this.state.currentTab){\r\n\r\n            case tabs.selectUsers:\r\n                return (\r\n                    <SelectUsers\r\n                        onNext={this.showEnterChatInfo}\r\n                        loadUsers={this.loadUsers}\r\n                    />\r\n                );\r\n\r\n            case tabs.enterChatInfo:\r\n                return(\r\n                    <GroupInfoForm\r\n                        submitGroup={this.submitGroup}\r\n                    />\r\n                );\r\n\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\nexport default withRouter(NewGroup);","import React,{Component} from \"react\";\r\nimport ChooseUser from \"./chooseUser/ChooseUser\";\r\nimport NewGroup from \"./newGroup/NewGroup\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\nimport {ModalHeader,ModalMain} from \"../../utilComp/Modal\";\r\n\r\nimport './newChat.scss';\r\n\r\nexport const tabs = {\r\n    chooseUser: 0,\r\n    newGroup: 1,\r\n    chooseGroup: 2\r\n};\r\n\r\nexport default class NewChat extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            currentTab: tabs.chooseUser\r\n        }\r\n    }\r\n\r\n    setCurrentTab = newTab => {\r\n        this.setState({\r\n            currentTab: newTab\r\n        });\r\n    };\r\n\r\n    render() {\r\n\r\n        const router = () => {\r\n\r\n            switch (this.state.currentTab) {\r\n\r\n                case tabs.chooseUser:{\r\n                    return(\r\n                        <ChooseUser\r\n                            setCurrentTab={this.setCurrentTab}\r\n                            hide={this.props.hide}\r\n                        />\r\n                    );\r\n\r\n                }\r\n\r\n                case tabs.newGroup:{\r\n                    return(\r\n                        <NewGroup />\r\n                    );\r\n                }\r\n\r\n                case tabs.chooseGroup:{\r\n                    return(\r\n                        <div>\r\n                            <h4>chooseGroup</h4>\r\n                        </div>\r\n                    );\r\n                }\r\n\r\n\r\n                default: {\r\n                    return(\r\n                        <ChooseUser\r\n                            setCurrentTab={this.setCurrentTab}\r\n                            hide={this.props.hide}\r\n                        />\r\n                    );\r\n                }\r\n            }\r\n        };\r\n\r\n        const getHeader = () => {\r\n\r\n            switch(this.state.currentTab){\r\n\r\n                case tabs.chooseUser:\r\n                    return 'Neuer Chat';\r\n\r\n                case tabs.newGroup:\r\n                    return 'Neue Gruppe';\r\n\r\n                case tabs.chooseGroup:\r\n                    return 'Gruppe auswählen';\r\n\r\n                default:\r\n                    return 'Neuer Chat';\r\n\r\n            }\r\n        };\r\n\r\n        return(\r\n            <Dummy>\r\n                <ModalHeader>\r\n                    <h1>{getHeader()}</h1>\r\n                </ModalHeader>\r\n                <ModalMain>\r\n                    <div className=\"newChat\">\r\n                        {router()}\r\n                    </div>\r\n                </ModalMain>\r\n            </Dummy>\r\n        )\r\n    }\r\n}","import {makeRequest} from \"../../global/requests\";\r\n\r\nexport const fetchUserInfo = async (uid) => {\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    const response = await makeRequest('/user/' + uid, config);\r\n\r\n    if(response.ok){\r\n        return await response.json();\r\n    }else{\r\n        throw new Error(\"Error fetching UserInfo\");\r\n    }\r\n}","import React, {Component} from \"react\";\r\nimport {Link} from 'react-router-dom';\r\nimport {ModalHeader, ModalMain} from \"../../utilComp/Modal\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\nimport {fetchUserInfo} from \"./userInfoApiCalls\";\r\n\r\nexport const errorCode = {\r\n    none: 0,\r\n    isSelf: 1,\r\n    //not a number\r\n    nan: 2,\r\n    notExisting: 3,\r\n    blocked: 4,\r\n    defaultError: 5\r\n};\r\n\r\nexport default class UserInfo extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            uid: 0,\r\n            loaded: false,\r\n            error: errorCode.none,\r\n            userInfo: null\r\n        }\r\n    }\r\n\r\n    render() {\r\n        /*\r\n            if not already loaded, show nothing\r\n         */\r\n        if(!this.state.loaded){\r\n            return null;\r\n        }\r\n        /*\r\n            if the user self is requested\r\n         */\r\n        else if(this.state.error === errorCode.isSelf){\r\n            return(\r\n                <Dummy>\r\n                    <ModalHeader>\r\n                        <h1>\r\n                            Du\r\n                        </h1>\r\n                    </ModalHeader>\r\n                    <ModalMain>\r\n                        xx\r\n                    </ModalMain>\r\n                </Dummy>\r\n            )\r\n        /*\r\n            if there is a error, show a generic error message\r\n         */\r\n        }else if(this.state.error !== errorCode.none){\r\n            return(\r\n                <div>Error!</div>\r\n            )\r\n        /*\r\n            no error, show the userInfo\r\n         */\r\n        }else{\r\n            return(\r\n                <Dummy>\r\n                    <ModalHeader>\r\n                        <h1>\r\n                            {this.state.userInfo.username}\r\n                            &nbsp;\r\n                            <Link to={\"/chat/user/\" + this.state.uid}>\r\n                                <i className=\"far fa-comment-alt\" />\r\n                            </Link>\r\n                        </h1>\r\n                    </ModalHeader>\r\n                    <ModalMain>\r\n                        <h2>Gruppen</h2>\r\n                    </ModalMain>\r\n                </Dummy>\r\n            )\r\n        }\r\n    }\r\n\r\n    setUser = async() => {\r\n\r\n        if(isNaN(this.props.uid)){\r\n            this.setState({\r\n                error: errorCode.nan\r\n            });\r\n        }else{\r\n            const uid = parseInt(this.props.uid);\r\n            this.setState({\r\n                uid: uid,\r\n                error: errorCode.none,\r\n                loaded: false\r\n            });\r\n            try {\r\n                const data = await fetchUserInfo(uid)\r\n\r\n                if (data.uidSelf === uid) {\r\n                    this.setState({\r\n                        error: errorCode.isSelf,\r\n                        loaded: true\r\n                    });\r\n                }else if(!data.userExists){\r\n                    this.setState({\r\n                        error: errorCode.notExisting,\r\n                        loaded: true\r\n                    });\r\n                }else if(data.blocked){\r\n                    this.setState({\r\n                        error: errorCode.blocked,\r\n                        loaded: true\r\n                    });\r\n                }else {\r\n                    this.setState({\r\n                        userInfo: data,\r\n                        loaded: true\r\n                    });\r\n                }\r\n            }catch(err){\r\n                this.setState({\r\n                    error: errorCode.defaultError,\r\n                    loaded: true\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    async componentDidMount() {\r\n        try {\r\n            await this.setUser();\r\n        }catch(err){\r\n            this.setState({\r\n                error: 4,\r\n                loaded: true\r\n            });\r\n        }\r\n    }\r\n\r\n    async componentDidUpdate(prevProps, prevState, snapshot) {\r\n        try{\r\n            /*\r\n                check if uid changed\r\n             */\r\n            if(prevProps.uid !== this.props.uid){\r\n                await this.setUser();\r\n            }\r\n        }catch(err){\r\n            this.setState({\r\n                error: 4,\r\n                loaded: true\r\n            });\r\n        }\r\n    }\r\n}","import {makeRequest} from \"../../global/requests\";\r\n\r\nexport const getUserSelf = async () => {\r\n\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n        }\r\n    };\r\n\r\n    const response =\r\n        await makeRequest(\r\n            '/user/self',\r\n            config\r\n        );\r\n    if(response.ok){\r\n        return await response.json();\r\n    }else{\r\n        throw new Error(\"Error requesting user info!\");\r\n    }\r\n}\r\n\r\nexport const setEmail = async (body) => {\r\n\r\n    const config = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body)\r\n    };\r\n\r\n    const response =  await makeRequest(\r\n        '/user/setEmail',\r\n        config\r\n    );\r\n    return response;\r\n}","import React,{Component} from \"react\";\r\nimport \"./EditableLabel.scss\";\r\n\r\nexport default class EditableLabel extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isEditing: false,\r\n            value: this.props.value\r\n        }\r\n    }\r\n\r\n    startEdit = () => {\r\n        this.setState({\r\n            isEditing: true\r\n        });\r\n    }\r\n\r\n    cancelEdit = () => {\r\n        this.setState({\r\n            isEditing: false,\r\n            value: this.props.value\r\n        });\r\n    }\r\n\r\n    submitEdit = event => {\r\n        event.preventDefault();\r\n        this.setState({\r\n            isEditing: false\r\n        });\r\n        if(typeof this.props.onChange === \"function\")\r\n            this.props.onChange(this.state.value)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <span className={\"label-edit \" + this.props.className}>\r\n                {this.state.isEditing ?\r\n                    <form\r\n                        onSubmit={this.submitEdit}\r\n                    >\r\n                        <input\r\n                            type=\"text\"\r\n                            value={this.state.value}\r\n                            style={{width: this.state.value.length + \"ch\"}}\r\n                            onChange={(event) => {\r\n                                this.setState({\r\n                                    value: event.target.value\r\n                                })\r\n                            }}\r\n                        />\r\n                        &nbsp;\r\n                        <i\r\n                            className=\"fas fa-check fa-lg\"\r\n                            onClick={this.submitEdit}\r\n                        />\r\n                        &nbsp;\r\n                        <i\r\n                            className=\"fas fa-times fa-lg\"\r\n                            onClick={this.cancelEdit}\r\n                        />\r\n                    </form>\r\n                    :\r\n\r\n                    <span\r\n                        onDoubleClick={this.startEdit}\r\n                    >\r\n                        {this.props.children}\r\n                        &nbsp;\r\n                        <i\r\n                            className=\"fas fa-pen\"\r\n                            onClick={this.startEdit}\r\n                        />\r\n                    </span>\r\n                }\r\n            </span>\r\n        )\r\n    }\r\n}","import React,{Component} from \"react\";\r\nimport {ModalHeader, ModalMain} from \"../../utilComp/Modal\";\r\nimport Dummy from \"../../utilComp/Dummy\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nimport \"./Settings.scss\";\r\nimport {getUserSelf, setEmail} from \"./apiCalls\";\r\nimport EditableLabel from \"../../util/EditableLabel\";\r\n\r\n//TODO: tests\r\nexport default class Settings extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state  = {\r\n            userDataSelf: null,\r\n            loaded: false,\r\n            error: false,\r\n            isEditing: false,\r\n            emailChangeRequested: false,\r\n            setEmailError: false,\r\n            setEmailErrorMessage: ''\r\n        }\r\n    }\r\n\r\n    changeEmail = value => {\r\n        //did the mail address change?\r\n        if(this.state.userDataSelf.email !== value)\r\n            setEmail({\r\n                email: value\r\n            }).then(async response => {\r\n                if(response.status === 200) {\r\n                    const data = await response.json();\r\n                    // check email taken\r\n                    if(data.emailTaken){\r\n                        console.log('email taken')\r\n                        this.setState({\r\n                            emailChangeRequested: false,\r\n                            setEmailError: true,\r\n                            setEmailErrorMessage: 'E-Mail wird bereits verwendet!'\r\n                        });\r\n                    }else{\r\n                        this.setState({\r\n                            setEmailError: false,\r\n                            emailChangeRequested: true\r\n                        });\r\n                    }\r\n                }else {\r\n                    this.setState({\r\n                        setEmailError: true,\r\n                        setEmailErrorMessage: 'Fehler beim Versenden der E-Mail!',\r\n                        emailChangeRequested: false\r\n                    })\r\n                }\r\n            }).catch(err => {\r\n                console.log(err);\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <Dummy>\r\n                <ModalHeader>\r\n                    <h1>Einstellungen</h1>\r\n                </ModalHeader>\r\n                <ModalMain>\r\n                    {this.state.loaded ?\r\n                        <div className={\"settings\"}>\r\n                            <span className=\"settings-header\">\r\n                                E-Mail Addresse: <br/>\r\n                            </span>\r\n                            <EditableLabel\r\n                                className = \"email\"\r\n                                value = {this.state.userDataSelf.email}\r\n                                onChange = {this.changeEmail}\r\n                            >\r\n                                {this.state.userDataSelf.email === '' ?\r\n                                    <Dummy>\r\n                                        Noch keine E-Mail Addresse!\r\n                                    </Dummy>\r\n                                    :\r\n                                    <Dummy>\r\n                                        {this.state.userDataSelf.email}\r\n                                    </Dummy>\r\n                                }\r\n                            </EditableLabel>\r\n                            {this.state.emailChangeRequested ?\r\n                                <Dummy>\r\n                                    &nbsp;\r\n                                    <span className=\"emailChanged\">Mail mit Verifizierungslink wurde versendet!</span>\r\n                                </Dummy>\r\n                                :\r\n                                null\r\n                            }\r\n                            {this.state.setEmailError ?\r\n                                <Dummy>\r\n                                    &nbsp;\r\n                                    <span className=\"set-email-error\">\r\n                                        {this.state.setEmailErrorMessage}\r\n                                    </span>\r\n                                </Dummy>\r\n                                :\r\n                                null\r\n                            }\r\n                            <div className={\"settings-about\"}>\r\n                                <Link to={\"/about\"}>über diese Seite</Link>\r\n                            </div>\r\n                        </div>\r\n                    : (!this.state.error ?\r\n                        <span>\r\n                            laden...\r\n                        </span>\r\n                    : <span>\r\n                            ein Fehler ist aufgetreten!\r\n                    </span>)}\r\n                </ModalMain>\r\n            </Dummy>\r\n        )\r\n    }\r\n\r\n    async componentDidMount() {\r\n        try {\r\n            const userDataSelf = await getUserSelf();\r\n            this.setState({\r\n                loaded: true,\r\n                userDataSelf: userDataSelf\r\n            })\r\n        }catch (e) {\r\n            this.setState({error: true})\r\n        }\r\n    }\r\n}","import React from \"react\";\r\nimport {\r\n    Switch,\r\n    Route,\r\n    useRouteMatch\r\n} from \"react-router-dom\";\r\nimport Modal from \"../utilComp/Modal\";\r\nimport NewChat from \"./newChat/NewChat\";\r\nimport Dummy from \"../utilComp/Dummy\";\r\nimport UserInfo from \"./userInfo/UserInfo\";\r\nimport Settings from \"./settings/Settings\";\r\n/*\r\n    modals are always at the end of the url\r\n */\r\nexport default function ModalRouterBigScreens(props){\r\n\r\n    let { path } = useRouteMatch();\r\n\r\n    return(\r\n        <Switch>\r\n            <Route path={`${path}/newChat`}>\r\n                {props.children}\r\n                <Modal>\r\n                    <NewChat />\r\n                </Modal>\r\n            </Route>\r\n            <Route path={`${path}/userInfo/:uidInfo`} render={\r\n                routeProps => (\r\n                    <Dummy>\r\n                        {props.children}\r\n                        <Modal>\r\n                            <UserInfo uid={routeProps.match.params.uidInfo} />\r\n                        </Modal>\r\n                    </Dummy>\r\n                )\r\n            } />\r\n            <Route path={`${path}/settings`}>\r\n                {props.children}\r\n                <Modal>\r\n                    <Settings/>\r\n                </Modal>\r\n            </Route>\r\n            <Route path=\"*\">\r\n                {props.children}\r\n            </Route>\r\n        </Switch>\r\n    )\r\n}","import React from \"react\";\r\nimport {\r\n    Switch,\r\n    Route,\r\n    useRouteMatch\r\n} from \"react-router-dom\";\r\nimport ChatList from \"./allChats/ChatList\";\r\nimport NormalChatView from \"./chatView/NormalChatView\";\r\nimport GroupChatView,{groupChatTabs} from \"./chatView/GroupChatView\";\r\nimport ModalRouterBigScreens from \"./ModalRouterBigScreens\";\r\n\r\nexport default function GridBigScreens(props){\r\n\r\n    const { path } = useRouteMatch();\r\n\r\n    return(\r\n        <div className=\"main-container\">\r\n            <div className=\"mc-left\">\r\n\r\n                <ChatList />\r\n            </div>\r\n            <div className=\"mc-right\">\r\n\r\n                <Switch>\r\n                    <Route path={`${path}/user/:uid`} render={\r\n                        routeProps => (\r\n                            <ModalRouterBigScreens>\r\n                                <NormalChatView\r\n                                    uid={routeProps.match.params.uid}\r\n                                />\r\n                            </ModalRouterBigScreens>\r\n                        )\r\n                    } />\r\n                    <Route path={`${path}/group/:gcid`} render={\r\n                        routeProps => (\r\n                            <ModalRouterBigScreens>\r\n                                <GroupChatView\r\n                                    gcid={routeProps.match.params.gcid}\r\n                                    tab={groupChatTabs.chat}\r\n                                />\r\n                            </ModalRouterBigScreens>\r\n                        )\r\n                    } />\r\n                    <Route path={`${path}/groupInfo/:gcid`} render={\r\n                        routeProps => (\r\n                            <ModalRouterBigScreens>\r\n                                <GroupChatView\r\n                                    gcid={routeProps.match.params.gcid}\r\n                                    tab={groupChatTabs.info}\r\n                                />\r\n                            </ModalRouterBigScreens>\r\n                        )\r\n                    } />\r\n                    <Route path={path}>\r\n                        <ModalRouterBigScreens>\r\n                            <h1>noch kein chat ausgewählt</h1>\r\n                        </ModalRouterBigScreens>\r\n                    </Route>\r\n                </Switch>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React,{Component} from \"react\";\r\nimport chatSocket from \"../../chatData/chatSocket\";\r\n\r\nimport './typeMessageContainer.scss';\r\n\r\nexport default class TypeMsgContainer extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            usersTyping: []\r\n        };\r\n    }\r\n    typeStateChanged = () => {\r\n\r\n        const chat = chatSocket.getChat(this.props.chatType,this.props.chatId);\r\n        this.setState({\r\n            usersTyping: chat.getUsersTyping()\r\n        });\r\n    };\r\n\r\n    render() {\r\n\r\n        return(\r\n            <div className=\"typeMsg-container\">\r\n                {this.state.usersTyping.map((user,index) => (\r\n                    <div key={index} className=\"typeMsg\">\r\n                        {user.username + \" schreibt...\"}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        const chat = chatSocket.getChat(this.props.chatType,this.props.chatId);\r\n        chat.event.on(\"typeState changed\",this.typeStateChanged);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        /*\r\n            es wird überprüft, ob sich der chat geändert hat\r\n            wenn ja, werden events neu initialisiert\r\n         */\r\n        if(prevProps.chatType !== this.props.chatType || prevProps.chatId !== this.props.chatId) {\r\n\r\n            const prevChat = chatSocket.getChat(prevProps.chatType,prevProps.chatId);\r\n            prevChat.event.rm(\"typeState changed\",this.typeStateChanged);\r\n\r\n            const newChat = chatSocket.getChat(this.props.chatType,this.props.chatId);\r\n            newChat.event.on(\"typeState changed\",this.typeStateChanged);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n\r\n        const chat = chatSocket.getChat(this.props.chatType,this.props.chatId);\r\n        chat.event.rm(\"typeState changed\",this.typeStateChanged);\r\n    }\r\n}","import React from \"react\";\r\nimport {\r\n    Switch,\r\n    Route,\r\n    useRouteMatch\r\n} from \"react-router-dom\";\r\nimport NewChat from \"./newChat/NewChat\";\r\nimport UserInfo from \"./userInfo/UserInfo\";\r\nimport Settings from \"./settings/Settings\";\r\n/*\r\n    modals are always at the end of the url\r\n */\r\nexport default function ModalRouterSmallScreens(props){\r\n\r\n    let { path } = useRouteMatch();\r\n\r\n    return(\r\n        <Switch>\r\n            <Route path={`${path}/newChat`}>\r\n                <NewChat />\r\n            </Route>\r\n            <Route path={`${path}/userInfo/:uidInfo`} render={\r\n                routeProps => (\r\n                    <UserInfo uid={routeProps.match.params.uidInfo} />\r\n                )\r\n            } />\r\n            <Route path={`${path}/settings`}>\r\n                <Settings/>\r\n            </Route>\r\n            <Route path=\"*\">\r\n                {props.children}\r\n            </Route>\r\n        </Switch>\r\n    )\r\n}","import React,{useGlobal} from \"reactn\";\r\nimport {\r\n    Switch,\r\n    Route,\r\n    useRouteMatch\r\n} from \"react-router-dom\";\r\nimport ChatList from \"./allChats/ChatList\";\r\nimport NormalChatView from \"./chatView/NormalChatView\";\r\nimport GroupChatView,{groupChatTabs} from \"./chatView/GroupChatView\";\r\nimport TypeMsgContainer from \"./chatView/TypeMsgContainer\";\r\nimport ModalRouterSmallScreens from \"./ModalRouterSmallScreens\";\r\n\r\nexport default function RouterSmallScreens(props){\r\n\r\n    let { path } = useRouteMatch();\r\n    const [global,setGlobal] = useGlobal();\r\n\r\n    const renderTypeMsgContainer = () => {\r\n        if(global.currentChat.type !== '' && global.currentChat.id !== 0){\r\n            return(\r\n                <TypeMsgContainer\r\n                    chatType={global.currentChat.type}\r\n                    chatId={global.currentChat.id}\r\n                />\r\n            )\r\n        }\r\n        return null;\r\n    };\r\n\r\n    return(\r\n            <Switch>\r\n                <Route path={`${path}/user/:uid`} render={\r\n                    routeProps => (\r\n                        <ModalRouterSmallScreens>\r\n                            <div className=\"main-container\">\r\n                                <NormalChatView\r\n                                    uid={routeProps.match.params.uid}\r\n                                />\r\n                            </div>\r\n                            {renderTypeMsgContainer()}\r\n                        </ModalRouterSmallScreens>\r\n                    )\r\n                }>\r\n                </Route>\r\n                <Route path={`${path}/group/:gcid`} render={\r\n                    routeProps => (\r\n                        <ModalRouterSmallScreens>\r\n                            <div className=\"main-container\">\r\n                                <GroupChatView\r\n                                    gcid={routeProps.match.params.gcid}\r\n                                    tab={groupChatTabs.chat}\r\n                                />\r\n                            </div>\r\n                            {renderTypeMsgContainer()}\r\n                        </ModalRouterSmallScreens>\r\n                    )\r\n                } />\r\n                <Route path={`${path}/groupInfo/:gcid`} render={\r\n                    routeProps => (\r\n                        <ModalRouterSmallScreens>\r\n                            <GroupChatView\r\n                                gcid={routeProps.match.params.gcid}\r\n                                tab={groupChatTabs.info}\r\n                            />\r\n                        </ModalRouterSmallScreens>\r\n                    )\r\n                } />\r\n                <Route path={path}>\r\n                    <ModalRouterSmallScreens>\r\n                        <div className=\"chat-list-outer-small\">\r\n                            <ChatList/>\r\n                        </div>\r\n                    </ModalRouterSmallScreens>\r\n                </Route>\r\n                <Route path = \"*\">\r\n                    <h3>Not found!</h3>\r\n                </Route>\r\n            </Switch>\r\n    )\r\n\r\n}","import React,{Component} from \"react\";\r\nimport Header from \"./Header/Header\";\r\nimport Responsive from \"../responsive/Responsive\";\r\nimport GridBigScreens from \"./GridBigScreens\";\r\nimport RouterSmallScreens from \"./RouterSmallScreens\";\r\nimport chatSocket from \"../chatData/chatSocket\";\r\n\r\nimport './Grid.scss';\r\n\r\nexport default class Chat extends Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            /*\r\n                which modal is currently open\r\n                    0: none\r\n             */\r\n            modal: 0,\r\n            /*\r\n                info about the currently open modal\r\n             */\r\n            modalInfo: null,\r\n            /*\r\n                is shown at the user-icon\r\n             */\r\n            notifications: 0\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        /*\r\n            if chatsocket is undefined, it gets initialized\r\n         */\r\n        if (!chatSocket.initCalled) {\r\n            chatSocket.init().then(r => {});\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div className=\"h-100\">\r\n\r\n                <Header/>\r\n\r\n                <Responsive displayIn={[\"Mobile\"]}>\r\n\r\n                    <RouterSmallScreens />\r\n                </Responsive>\r\n\r\n                <Responsive displayIn={[\"Laptop\",\"Tablet\"]}>\r\n\r\n                    <GridBigScreens/>\r\n                </Responsive>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\n\r\nimport \"./About.scss\";\r\n\r\nexport default function About(){\r\n    return(\r\n        <div className={\"about\"}>\r\n            <h2>Über diese Seite</h2>\r\n            <h4>Erstellt von:</h4>\r\n            Stefan Schlaghuber<br/>\r\n            2002 Großmugl<br/>\r\n            stefan.schlaghuber@gmail.com<br/>\r\n        </div>\r\n    )\r\n}","import {makeRequest} from \"./requests\";\r\n\r\nexport async function reqUserSelf(tokens){\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    };\r\n    return await makeRequest(\r\n        '/user/self',\r\n        config,\r\n        tokens\r\n    );\r\n}","import {addReducer} from 'reactn';\r\nimport {fetchData} from \"./globalData\";\r\nimport {resetChatSocket} from \"../chatData/chatSocket\";\r\nimport {reqUserSelf} from \"./apiCalls\";\r\n\r\nexport function authTokens(){\r\n\r\n    addReducer('deleteAuthTokens',(global,dispatch) => {\r\n\r\n        localStorage.removeItem(\"authTokens\");\r\n        /*\r\n            TODO: without reload\r\n         */\r\n        // eslint-disable-next-line no-restricted-globals\r\n        location.reload();\r\n        dispatch.deleteUserSelf();\r\n        dispatch.resetGlobal();\r\n        resetChatSocket();\r\n\r\n        return {\r\n            loaded: true,\r\n            authTokens: undefined\r\n        };\r\n    });\r\n\r\n    addReducer('initAuthTokens',async(global,dispatch,existingTokens) => {\r\n\r\n        try {\r\n            /*\r\n                util data is fetched from the server\r\n             */\r\n            await fetchData();\r\n\r\n            const response = await reqUserSelf(existingTokens);\r\n            /*\r\n                not authenticated\r\n                    --> token is deleted\r\n                    --> login page\r\n             */\r\n            if (response.status === 403) {\r\n                localStorage.removeItem(\"authTokens\");\r\n                return {\r\n                    loaded: true,\r\n                    authTokens: undefined\r\n                };\r\n            }\r\n            /*\r\n                userSelf is updated\r\n             */\r\n            else {\r\n                const data = await response.json();\r\n\r\n                const {uid, username} = data;\r\n                dispatch.setUserSelf(uid, username);\r\n\r\n                return ({\r\n                    loaded: true,\r\n                    authTokens: existingTokens\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n            return({\r\n                loaded: false\r\n            })\r\n        }\r\n    });\r\n\r\n    addReducer('setAuthTokens',(global,dispatch,tokens) => {\r\n\r\n        localStorage.setItem(\"authTokens\", JSON.stringify(tokens));\r\n\r\n        return({\r\n            loaded: true,\r\n            authTokens: tokens\r\n        });\r\n    });\r\n}","import React,{Component} from \"reactn\";\r\nimport validate from \"validate.js\";\r\nimport {isVerificationCodeValid, setPassword} from \"./apiCalls\";\r\nimport {ErrorMsg, SuccessMsg} from \"./MsgBox\";\r\nimport TogglePassword from \"./TogglePassword\";\r\nimport BackToLogin from \"./BackToLogin\";\r\n\r\nexport default class ResetPassword extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            linkValid: true,\r\n            error: false,\r\n            errorMessage: '',\r\n            password: '',\r\n            passwordRepeat: '',\r\n            passwordResetSuccess: false\r\n        };\r\n    }\r\n    changeHandler = event => {\r\n        let nam = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[nam]: val});\r\n    };\r\n    submitHandler = event => {\r\n        event.preventDefault();\r\n        /*\r\n            constraints für validation\r\n         */\r\n        const valConstraints = {\r\n            password: {\r\n                presence: true,\r\n                length: {\r\n                    minimum: 8,\r\n                    tooShort: 'Passwort muss mindestens 8 Zeichen lang sein',\r\n                    maximum: 50,\r\n                    tooLong: 'Passwort darf höchstens 50 Zeichen lang sein'\r\n                }\r\n            },\r\n            passwordRepeat: {\r\n                presence: true,\r\n                equality: \"password\",\r\n                length: {\r\n                    minimum: 8,\r\n                    tooShort: 'Passwort muss mindestens 8 Zeichen lang sein',\r\n                    maximum: 50,\r\n                    tooLong: 'Passwort darf höchstens 50 Zeichen lang sein'\r\n                }\r\n            }\r\n        };\r\n        /*\r\n            validate\r\n         */\r\n        const valResult = validate({\r\n            password: this.state.password,\r\n            passwordRepeat: this.state.passwordRepeat\r\n        },valConstraints);\r\n\r\n        if(typeof(valResult) != \"undefined\") {\r\n\r\n            let errorMessage;\r\n\r\n            if (typeof (valResult.password) != \"undefined\")\r\n                errorMessage = valResult.password[0];\r\n            else if (typeof (valResult.passwordRepeat) != \"undefined\")\r\n                errorMessage = \"Passwörter stimmen nicht überein!\"\r\n            errorMessage = errorMessage.replace(\"Username \",\"\").replace(\"Password \",\"\");\r\n\r\n            this.setState({\r\n                error: true,\r\n                errorMessage: errorMessage\r\n            });\r\n        }else {\r\n\r\n            const {password} = this.state;\r\n\r\n            setPassword(this.props.verificationCode, password)\r\n                .then(response => {\r\n                    if (response.status === 200)\r\n                        this.setState({\r\n                            error: false,\r\n                            passwordResetSuccess: true\r\n                        });\r\n                    else if(response.status === 403)\r\n                        this.setState({\r\n                            error: true,\r\n                            errorMessage: 'Fehler: Dieser Link ist ungültig!'\r\n                        })\r\n                    else\r\n                        this.setState({\r\n                            error: true,\r\n                            errorMessage: 'ein Fehler ist aufgetreten'\r\n                        });\r\n                })\r\n                .catch(err => {\r\n                    this.setState({\r\n                        error: true,\r\n                        errorMessage: 'ein Fehler ist aufgetreten'\r\n                    });\r\n                });\r\n        }\r\n    }\r\n    errorMessage = () => {\r\n        if(this.state.error)\r\n            return (\r\n                <ErrorMsg>\r\n                    {this.state.errorMessage}\r\n                </ErrorMsg>\r\n            )\r\n    };\r\n    successMessage = () => {\r\n        if(this.state.passwordResetSuccess)\r\n            return (\r\n                <SuccessMsg>\r\n                    Passwort erfolgreich zurückgesetzt!\r\n                </SuccessMsg>\r\n            )\r\n    }\r\n    componentDidMount = () => {\r\n        isVerificationCodeValid(this.props.verificationCode)\r\n            .then(response => {\r\n                if(response.status !== 200)\r\n                    this.setState({\r\n                        linkValid: false\r\n                    })\r\n            })\r\n            .catch(err => {\r\n                this.setState({\r\n                    linkValid: false\r\n                })\r\n            });\r\n    }\r\n    render() {\r\n        if(this.state.linkValid)\r\n            return (\r\n                <div className=\"h-100\" style={{display: \"flex\"}}>\r\n                    <div className=\"col-sm-12 my-auto\">\r\n                        <div className=\"container border rounded p-3\" style={{maxWidth: \"800px\"}}>\r\n                            <BackToLogin/>\r\n                            <h1>neues Passwort eingeben</h1>\r\n                            {this.errorMessage()}\r\n                            <form onSubmit={this.submitHandler}>\r\n                                <div className=\"form-group\">\r\n                                    <label htmlFor=\"password\">Passwort:</label>\r\n                                    <TogglePassword\r\n                                        name=\"password\"\r\n                                        className=\"form-control\"\r\n                                        placeholder=\"Passwort eingeben\"\r\n                                        onChange={this.changeHandler}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label htmlFor=\"passwordRepeat\">Passwort wiederholen:</label>\r\n                                    <TogglePassword\r\n                                        name=\"passwordRepeat\"\r\n                                        className=\"form-control\"\r\n                                        placeholder=\"Passwort eingeben\"\r\n                                        onChange={this.changeHandler}\r\n                                    />\r\n                                </div>\r\n                                {this.successMessage()}\r\n                                <input\r\n                                    type=\"submit\"\r\n                                    className=\"btn btn-primary\"\r\n                                    value=\"Passwort zurücksetzen\"\r\n                                />\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        else\r\n            return (\r\n                <ErrorMsg>\r\n                    Ungültiger Link!\r\n                </ErrorMsg>\r\n            )\r\n    }\r\n}","import React, {useDispatch,useEffect} from \"reactn\";\r\nimport {\r\n    BrowserRouter as Router,\r\n    Switch,\r\n    Route,\r\n    Redirect,\r\n    useLocation\r\n} from \"react-router-dom\";\r\nimport Login from \"./Auth/Login\";\r\nimport Register from \"./Auth/Register\";\r\nimport VerifyEmail from \"./Auth/VerifyEmail\";\r\nimport ForgotPassword from \"./Auth/ForgotPassword\";\r\nimport PrivateRoute from \"./utilComp/PrivateRoute\";\r\nimport Chat from \"./Home/Home\";\r\nimport About from \"./About/About\";\r\n\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './App.css';\r\n\r\nimport {initGlobal} from \"./global/global\";\r\nimport ResetPassword from \"./Auth/ResetPassword\";\r\n\r\ninitGlobal();\r\n\r\nexport default function App() {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        const existingTokens = JSON.parse(localStorage.getItem(\"authTokens\"));\r\n        dispatch.initAuthTokens(existingTokens);\r\n    },[]);\r\n\r\n    return (\r\n        <Router>\r\n            <Switch>\r\n                <PrivateRoute path=\"/chat\" component={Chat}/>\r\n                <Route exact path=\"/login\" component={Login}/>\r\n                <Route exact path=\"/register\" component={Register}/>\r\n                <Route path={\"/verifyEmail/:code\"} render={\r\n                    routeProps => (\r\n                        <VerifyEmail verificationCode={routeProps.match.params.code}/>\r\n                    )\r\n                } />\r\n                <Route exact path=\"/forgotPassword\" component={ForgotPassword}/>\r\n                <Route path={\"/resetPassword/:code\"} render={\r\n                    routeProps => (\r\n                        <ResetPassword verificationCode={routeProps.match.params.code}/>\r\n                    )\r\n                } />\r\n                <Route path={\"/about\"}>\r\n                    <About/>\r\n                </Route>\r\n                <Route exact path=\"/\">\r\n                    <Redirect to={\"/chat\"}/>\r\n                </Route>\r\n                <Route path=\"*\">\r\n                    <NoMatch/>\r\n                </Route>\r\n            </Switch>\r\n        </Router>\r\n    );\r\n}\r\n\r\nfunction NoMatch() {\r\n  let location = useLocation();\r\n\r\n  return (\r\n      <div>\r\n        <h3>\r\n          No match for <code>{location.pathname}</code>\r\n        </h3>\r\n      </div>\r\n  );\r\n}\r\n","import {addReducer, setGlobal} from 'reactn';\r\nimport {infoHeaderCenter} from \"../Home/Header/HeaderLeft\";\r\nimport {initChats} from \"./initChats\";\r\nimport {initChatReducers} from \"./chats\";\r\nimport {authTokens} from \"./authTokens\";\r\n\r\nexport function initGlobal(){\r\n\r\n    setGlobal({\r\n        /*\r\n            is the page ready to be shown?\r\n         */\r\n        loaded: false,\r\n        /*\r\n            the authentication token\r\n         */\r\n        authTokens: undefined,\r\n        /*\r\n            info about the user self\r\n         */\r\n        userSelf: {},\r\n        /*\r\n            what info should be shown at the left center of the header?\r\n         */\r\n        infoHeaderCenter: infoHeaderCenter.none,\r\n        ihcData: null,\r\n        /*\r\n            the chat that is currently selected\r\n         */\r\n        currentChat: {\r\n            type: '',\r\n            id: 0,\r\n            /*\r\n                unread messages inside the currentChat\r\n             */\r\n            newMessages: 0,\r\n            /*\r\n                the messages in the currentChat, displayed in chatContainer\r\n             */\r\n            messages: []\r\n        },\r\n        /*\r\n            the shown tempChat\r\n         */\r\n        tempChat: null,\r\n        /*\r\n            all chats of the user are stored here\r\n         */\r\n        chats: [],\r\n        /*\r\n            number of chats with new messages\r\n         */\r\n        newMessages: 0\r\n        /*\r\n            TODO: notifications\r\n         */\r\n    });\r\n\r\n    initChats();\r\n\r\n    /*\r\n        the userSelf gets set\r\n     */\r\n    addReducer('setUserSelf',(global,dispatch,uid,username) => {\r\n\r\n        return {\r\n            userSelf: {\r\n                uid: uid,\r\n                username: username\r\n            }\r\n        }\r\n    });\r\n    /*\r\n        userSelf is deleted\r\n     */\r\n    addReducer('deleteUserSelf',(global,dispatch) => {\r\n\r\n       return {\r\n           userSelf: {}\r\n       }\r\n    });\r\n    /*\r\n        // eslint-disable-next-line no-unused-vars\r\n        global gets reseted\r\n     */\r\n    addReducer('resetGlobal',(global,dispatch) => ({\r\n        infoHeaderCenter: infoHeaderCenter.none,\r\n        ihcData: null,\r\n        currentChat: {\r\n            type: '',\r\n            id: 0,\r\n            newMessages: 0,\r\n            messages: []\r\n        },\r\n        tempChat: null,\r\n        chats: [],\r\n        newMessages: 0\r\n    }));\r\n    /*\r\n        chat reducers are initialized\r\n     */\r\n    initChatReducers();\r\n    /*\r\n        authTokens reducers are initialized\r\n     */\r\n    authTokens();\r\n}","import chatSocket from \"../chatData/chatSocket\";\r\nimport {setGlobal} from \"reactn\";\r\n\r\nexport function initChats(){\r\n\r\n    function chatsLoaded(chats){\r\n        setGlobal({\r\n            chats: chats\r\n        });\r\n    }\r\n    /*\r\n       chats get initialized\r\n       is loading of chats already finished?\r\n           --> chatArray gets requested immediately\r\n    */\r\n    if(chatSocket.finishedLoading){\r\n        chatsLoaded(chatSocket.getChatArraySortedByDate());\r\n        /*\r\n            otherwise --> event handler that gets triggered when loading finished\r\n         */\r\n    }else{\r\n        chatSocket.event.on('chats loaded',chatsLoaded);\r\n    }\r\n}","import {addReducer} from \"reactn\";\r\nimport chatSocket from \"../chatData/chatSocket\";\r\n\r\nexport function initChatReducers(){\r\n\r\n    /*\r\n        is the chat the current chat?\r\n     */\r\n    function isSelected(global,chat){\r\n\r\n        const currentChat = global.currentChat;\r\n        return currentChat.type === chat.type\r\n            && currentChat.id === chat.id;\r\n    }\r\n    /*\r\n        index of the chat is searched\r\n     */\r\n    function findIndex(global,chat){\r\n\r\n        return global.chats.findIndex(\r\n            element => (\r\n                element.id === chat.id\r\n                && element.type === chat.type)\r\n        );\r\n    }\r\n    /*\r\n        is called when there is a new message\r\n     */\r\n    addReducer('newMsg',(global,dispatch,chat,unreadMessages,message) => {\r\n\r\n        const index = findIndex(global,chat);\r\n        /*\r\n            if the index is -1, the chat does not exist\r\n         */\r\n        if(index !== -1){\r\n            /*\r\n                is the chat selected?\r\n             */\r\n            if(isSelected(global,chat)) {\r\n                /*\r\n                    chat is selected\r\n                        latestMessageObject is updated\r\n                        newMessage counter is set to 0\r\n                 */\r\n                const chatsClone = global.chats.splice(0);\r\n                const chatObject = chatsClone[index];\r\n                chatObject.latestMessage = chat.getLatestMessageObject();\r\n                chatObject.unreadMessages = 0;\r\n                /*\r\n                    item is deleted from array\r\n                 */\r\n                chatsClone.splice(index,1);\r\n                /*\r\n                    item is added to start of the array\r\n                 */\r\n                chatsClone.unshift(chatObject);\r\n                /*\r\n                    message is added to messages in currentChat\r\n                 */\r\n                const currentChat = {\r\n                    ...global.currentChat,\r\n                    messages: global.currentChat.messages.concat(message),\r\n                    newMessages: global.currentChat.newMessages + 1\r\n                };\r\n                return {\r\n                    chats: chatsClone,\r\n                    currentChat: currentChat\r\n                };\r\n            }else{\r\n                /*\r\n                    chat is not selected\r\n                        latestMessageObject is updated\r\n                        newMessage counter gets incremented\r\n                 */\r\n                const chatsClone = global.chats.splice(0);\r\n                const chatObject = chatsClone[index];\r\n                chatObject.latestMessage = chat.getLatestMessageObject();\r\n                /*\r\n                    if the unread messages of the chat have been 0 until now, newMessages is incremented\r\n                 */\r\n                let newMessages = global.newMessages;\r\n                if(chatObject.unreadMessages === 0){\r\n                    newMessages++;\r\n                }\r\n\r\n                chatObject.unreadMessages = unreadMessages + 1;\r\n                /*\r\n                    item is deleted from array\r\n                 */\r\n                chatsClone.splice(index,1);\r\n                /*\r\n                    item is added to start of the array\r\n                 */\r\n                chatsClone.unshift(chatObject);\r\n\r\n                return {\r\n                    chats: chatsClone,\r\n                    newMessages: newMessages\r\n                };\r\n            }\r\n        }\r\n    });\r\n    /*\r\n        gets called out of changeCurrentChat in chatSocket\r\n     */\r\n    addReducer('selectChat',(global,dispatch,chat) => {\r\n\r\n        const index = findIndex(global,chat);\r\n        /*\r\n            if the index is -1, the chat does not exist\r\n         */\r\n        if(index !== -1) {\r\n            /*\r\n                chats is cloned\r\n             */\r\n            const chatsClone = global.chats.splice(0);\r\n            const item = chatsClone[index];\r\n            /*\r\n                if there where unread messages, newMessages counter is decremented by 1\r\n             */\r\n            let newMessages = global.newMessages;\r\n            if(item.unreadMessages > 0){\r\n                newMessages--;\r\n            }\r\n            /*\r\n                unreadMessages is set to 0\r\n             */\r\n            item.unreadMessages = 0;\r\n            chatsClone[index] = item;\r\n            /*\r\n                change is emitted to server\r\n             */\r\n            chatSocket.socket.emit('change chat', {\r\n                type: chat.type,\r\n                id: chat.id\r\n            });\r\n\r\n            return {\r\n                currentChat: {\r\n                    type: chat.type,\r\n                    id: chat.id,\r\n                    messages: chat.getMessages(),\r\n                    newMessages: 0\r\n                },\r\n                chats: chatsClone,\r\n                tempChat: null,\r\n                newMessages: newMessages\r\n            }\r\n        }\r\n    });\r\n    /*\r\n        is called when no chat should be selected\r\n     */\r\n    addReducer('selectNoChat',(global,dispatch) => {\r\n        /*\r\n            change is emitted to server\r\n         */\r\n        chatSocket.socket.emit('change chat', null);\r\n\r\n        return {\r\n            currentChat: {\r\n                type: '',\r\n                id: 0,\r\n                messages: []\r\n            },\r\n        }\r\n    });\r\n    /*\r\n        loaded messages are added\r\n     */\r\n    addReducer('addLoadedMessages',(global,dispatch,messages) => {\r\n\r\n        return {\r\n            currentChat: {\r\n                ...global.currentChat,\r\n                messages: messages ?\r\n                    messages.concat(global.currentChat.messages)\r\n                    : global.currentChat.messages\r\n            }\r\n        };\r\n    });\r\n    /*\r\n        new chat is added\r\n     */\r\n    addReducer('addChat',(global,dispatch,chat) => {\r\n\r\n        function isDateBefore(chat1,chat2){\r\n            /*\r\n                do latestMessages exist?\r\n             */\r\n            if(!chat1.latestMessage)\r\n                return true;\r\n            else if(!chat2.latestMessage)\r\n                return false;\r\n            else\r\n                return chat1.latestMessage.date.getTime() < chat2.latestMessage.date.getTime();\r\n        }\r\n        /*\r\n            place the chat at the right position\r\n            chats is cloned\r\n         */\r\n        const chatsClone = global.chats.splice(0);\r\n        const chatObject = chat.getChatObject();\r\n\r\n        if(chatsClone.length === 0)\r\n            return {\r\n                chats: [chatObject]\r\n            };\r\n\r\n        for (let i = 0; i < chatsClone.length; i++) {\r\n            if (isDateBefore(chatsClone[i], chatObject)) {\r\n                chatsClone.splice(i, 0, chatObject);\r\n                break;\r\n            }\r\n        }\r\n\r\n        return {\r\n            chats: chatsClone\r\n        }\r\n\r\n    });\r\n    /*\r\n        chat is removed\r\n     */\r\n    addReducer('removeChat',(global,dispatch,chat) => {\r\n\r\n        const index = findIndex(global,chat);\r\n        /*\r\n            chats is cloned\r\n         */\r\n        const chatsClone = this.state.chats.splice(0);\r\n        /*\r\n            item is deleted from array\r\n         */\r\n        chatsClone.splice(index,1);\r\n\r\n        return {\r\n            chats: chatsClone\r\n        }\r\n    });\r\n    /*\r\n        tempChat is shown\r\n     */\r\n    addReducer('showTempChat',(global,dispatch) => {\r\n\r\n        const chat = chatSocket.temporaryChat.chatNow;\r\n        /*\r\n            change is emitted to server\r\n         */\r\n        chatSocket.socket.emit('change chat', null);\r\n\r\n        return {\r\n            tempChat: chat.getChatObject(),\r\n            currentChat: {\r\n                type: 'tempChat',\r\n                id: 0,\r\n                messages: []\r\n            }\r\n        }\r\n    });\r\n    /*\r\n        tempChat is updated\r\n     */\r\n    addReducer('updateTempChat',(global,dispatch,chat) => ({\r\n        tempChat: chat.getChatObject(),\r\n        currentChat: {\r\n            type: 'tempChat',\r\n            id: 0,\r\n            messages: []\r\n        }\r\n    }));\r\n    /*\r\n        tempChat is hidden\r\n     */\r\n    addReducer('hideTempChat',(global,dispatch) => ({\r\n        tempChat: null\r\n    }));\r\n}","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}