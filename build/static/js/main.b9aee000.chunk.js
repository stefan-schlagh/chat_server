(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{133:function(e,t,s){},138:function(e,t,s){},140:function(e,t,s){},141:function(e,t,s){},167:function(e,t){},170:function(e,t,s){},171:function(e,t,s){},172:function(e,t,s){},175:function(e,t,s){},176:function(e,t,s){},177:function(e,t,s){},179:function(e,t,s){},204:function(e,t,s){},205:function(e,t,s){},207:function(e,t,s){},208:function(e,t,s){},209:function(e,t,s){},210:function(e,t,s){},211:function(e,t,s){},212:function(e,t,s){},213:function(e,t,s){},215:function(e,t,s){},216:function(e,t,s){"use strict";s.r(t);var n=s(0),a=s(1),r=s.n(a),c=s(12),i=s.n(c),o=s(8),u=s(10),h=s(15),l=s(7),d=s.n(l),p=s(9),j=s(35),b=s(3),m=s(4),f=s(5),g=s(6),O=s(52),v=s.n(O),x=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("small",{className:"alert alert-danger p-1 message d-block",children:this.props.children})}}]),s}(a.Component),y=s(19),k=(s(133),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).state={showPassword:!1},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"psw-group",children:[Object(n.jsx)("i",{className:(this.state.showPassword?"fa-eye-slash":"fa-eye")+" fas psw-toggle-icon",onClick:function(){return e.setState((function(e){return{showPassword:!e.showPassword}}))}}),Object(n.jsx)("input",Object(y.a)({type:this.state.showPassword?"text":"password"},this.props))]})}}]),s}(a.Component)),C=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var a;return Object(b.a)(this,s),(a=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;a.setState(Object(j.a)({},t,s))},a.submitHandler=function(e){e.preventDefault();var t,s,n={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},r=v()({username:a.state.username,password:a.state.password},n);"undefined"!=typeof r?(t="undefined"!=typeof r.username?r.username[0]:"",s="undefined"!=typeof r.password?r.password[0]:"",a.setState({valid:!1,uNameErr:t,pwErr:s})):(a.setState({valid:!0,uNameErr:"",pwErr:""}),a.login(a.state.username,a.state.password).then((function(e){e.success||(void 0!==e.username&&a.setState({valid:!1,uNameErr:e.username}),void 0!==e.password&&a.setState({valid:!1,pwErr:e.password}))})))},a.uNameErr=function(){if(""!==a.state.uNameErr)return Object(n.jsx)(x,{children:a.state.uNameErr})},a.pwErr=function(){if(""!==a.state.pwErr)return Object(n.jsx)(x,{children:a.state.pwErr})},a.login=function(){var e=Object(p.a)(d.a.mark((function e(t,s){var n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})},e.next=4,fetch("/auth/login",n);case 4:if(!(r=e.sent).ok){e.next=13;break}return e.next=8,r.json();case 8:return(c=e.sent).success&&(a.dispatch.setUserSelf(c.uid,t),a.dispatch.setAuthTokens(c.tokens),a.props.history.push("/chat")),e.abrupt("return",c);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,s){return e.apply(this,arguments)}}(),a.state={uNameErr:"",username:"",pwErr:"",password:"",valid:!1,redirect:!1},a}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(n.jsx)("div",{className:"col-sm-12 my-auto",children:Object(n.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(n.jsx)("h1",{children:"Login"}),Object(n.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"username",children:"Benutzername:"}),this.uNameErr(),Object(n.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"password",children:"Passwort:"}),this.pwErr(),Object(n.jsx)(k,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(n.jsxs)("div",{className:"form-group",children:["haben Sie noch keinen Account? ",Object(n.jsx)(u.b,{to:"/register",children:"Jetzt registrieren"})]}),Object(n.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Login"})]})]})})})}}]),s}(o.Component),w=Object(h.j)(C),N=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var a;return Object(b.a)(this,s),(a=t.call(this,e)).changeHandler=function(e){var t=e.target.name,s=e.target.value;a.setState(Object(j.a)({},t,s))},a.submitHandler=function(e){e.preventDefault();var t,s,n,r={username:{presence:!0,length:{minimum:3,tooShort:"has to be at least 3 characters long",maximum:30,tooLong:"can only be 30 characters long"},format:{pattern:new RegExp(/^\w\w*$/),message:"not valid"}},password:{presence:!0,length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}},passwordRepeat:{presence:!0,equality:"password",length:{minimum:8,tooShort:"has to be at least 8 characters long",maximum:30,tooLong:"can only be 30 characters long"}}},c=v()({username:a.state.username,password:a.state.password,passwordRepeat:a.state.pwRepeat},r);"undefined"!=typeof c?(t="undefined"!=typeof c.username?c.username[0]:"",s="undefined"!=typeof c.password?c.password[0]:"",n="undefined"!=typeof c.passwordRepeat?c.passwordRepeat[0]:"",a.setState({valid:!1,uNameErr:t,pwErr:s,pwRepeatErr:n})):(a.setState({valid:!0,uNameErr:"",pwErr:"",pwRepeatErr:""}),a.register(a.state.username,a.state.password).then((function(e){e.success||void 0!==e.username&&a.setState({valid:!1,uNameErr:e.username})})))},a.uNameErr=function(){if(""!==a.state.uNameErr)return Object(n.jsx)(x,{children:a.state.uNameErr})},a.pwErr=function(){if(""!==a.state.pwErr)return Object(n.jsx)(x,{children:a.state.pwErr})},a.pwRepeatErr=function(){if(""!==a.state.pwRepeatErr)return Object(n.jsx)(x,{children:a.state.pwRepeatErr})},a.register=function(){var e=Object(p.a)(d.a.mark((function e(t,s){var n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})},e.next=4,fetch("/auth/register",n);case 4:if(!(r=e.sent).ok){e.next=13;break}return e.next=8,r.json();case 8:return(c=e.sent).success&&(a.dispatch.setUserSelf(c.uid,t),a.dispatch.setAuthTokens(c.tokens),a.props.history.push("/chat")),e.abrupt("return",c);case 13:return e.abrupt("return",null);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",null);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,s){return e.apply(this,arguments)}}(),a.state={uNameErr:"",username:"",pwErr:"",password:"",pwRepeatErr:"",pwRepeat:"",valid:!1,redirect:!1},a}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(n.jsx)("div",{className:"col-sm-12 my-auto",children:Object(n.jsxs)("div",{className:"container border rounded p-3",style:{maxWidth:"800px"},children:[Object(n.jsx)("h1",{children:"Registrieren"}),Object(n.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"username",children:"Benutzername:"}),this.uNameErr(),Object(n.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Benutzernamen eingeben",onChange:this.changeHandler})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"password",children:"Passwort:"}),this.pwErr(),Object(n.jsx)(k,{name:"password",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"password",children:"Passwort wiederholen:"}),this.pwRepeatErr(),Object(n.jsx)(k,{name:"pwRepeat",className:"form-control",placeholder:"Passwort eingeben",onChange:this.changeHandler})]}),Object(n.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Registrieren"})]})]})})})}}]),s}(o.Component),S=Object(h.j)(N),T=s(56),M=s(113);var U=function(e){var t=e.component,s=Object(M.a)(e,["component"]),a=Object(o.useGlobal)(),r=Object(T.a)(a,2),c=r[0];return r[1],Object(n.jsx)(h.b,Object(y.a)(Object(y.a)({},s),{},{render:function(e){return c.loaded?c.authTokens?Object(n.jsx)(t,Object(y.a)({},e)):Object(n.jsx)(h.a,{to:{pathname:"/login",state:{referer:e.location}}}):null}}))},D=992,E=768,_=991,I=767,A=320,R=425,G=function(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},L=G(),B={width:L.width,height:L.height},P=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state=B,e.render=function(){var t=e.props,s=t.children,a=t.displayIn,c=e.state,i=c.width,o=c.height,u=e.shouldRender(a,i,o);return Object(n.jsx)(r.a.Fragment,{children:u?s:null})},e.handleResize=function(){var t=G(),s=t.width,n=t.height;e.setState({width:s,height:n})},e.shouldRender=function(e,t,s){return-1!==e.indexOf("Laptop")&&t>=D||(-1!==e.indexOf("Tablet")&&t<=_&&t>=E||(-1!==e.indexOf("Mobile")&&t<=I||(-1!==e.indexOf("MobilePortrait")&&t<=I&&s>=R||!!(-1!==e.indexOf("MobileLandScape")&&t<=I&&s<=A))))},e}return Object(m.a)(s,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize,!1)}}]),s}(r.a.PureComponent),F=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"componentDidMount",value:function(){"function"===typeof this.props.didMount&&this.props.didMount()}},{key:"componentDidUpdate",value:function(e,t,s){"function"===typeof this.props.didUpdate&&this.props.didUpdate()}},{key:"render",value:function(){return this.props.children?this.props.children:null}}]),s}(a.Component),z=(s(138),0),H=1,V=2,W=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){var e=this,t=this.props.location.pathname;return Object(n.jsxs)(F,{children:[Object(n.jsx)(P,{displayIn:["Mobile"],children:Object(n.jsxs)("div",{className:"float-left left",children:[Object(n.jsx)("i",{id:"btnBackToChatList",className:"fas fa-arrow-left fa-2x d-block d-md-none",onClick:function(){e.props.history.goBack()}}),e.global.newMessages>0?Object(n.jsx)("div",{className:"btnBack-number",children:e.global.newMessages}):null]})}),function(){switch(e.global.infoHeaderCenter){case H:return Object(n.jsxs)(Y,{children:[Object(n.jsx)("h3",{id:"chat-info-name",children:e.global.ihcData.name}),Object(n.jsx)(u.b,{to:t+"/userInfo/"+e.global.ihcData.uid,children:Object(n.jsx)("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})})]});case V:return Object(n.jsxs)(Y,{children:[Object(n.jsx)("h3",{id:"chat-info-name",children:e.global.ihcData.name}),Object(n.jsx)(u.b,{to:"/chat/groupInfo/"+e.global.ihcData.gcid,children:Object(n.jsx)("i",{className:"fas fa-info-circle fa-2x","data-toggle":"tooltip",title:"chat info"})})]});default:return Object(n.jsx)(P,{displayIn:["Laptop","Tablet"],children:Object(n.jsx)("h3",{className:"pt-2 pl-2",children:"chat"})})}}()]})}}]),s}(o.Component),J=Object(h.j)(W);function Y(e){return Object(n.jsx)("div",{id:"chat-info",className:"center pt-2",children:e.children})}var q=s(109),$=(s(139),s(140),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).clickCheckBox=function(e){n.state.checkBoxClicked?e.stopPropagation():setTimeout((function(){n.setState((function(e){return{checkBoxClicked:!0}}))}),20)},n.clickDocument=function(e){n.state.checkBoxClicked&&n.changeChecked(e)},n.changeChecked=function(e){n.setState((function(e){return{checkBoxClicked:!e.checkBoxClicked}}))},n.logout=function(){n.dispatch.deleteAuthTokens()},n.state={checkBoxClicked:!1},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this.props.location.pathname;return Object(n.jsxs)("div",{className:"c-header",children:[Object(n.jsx)(J,{}),Object(n.jsxs)("div",{id:"top-right",className:"right",onClick:this.clickCheckBox,children:[Object(n.jsx)("div",{className:"right-l"}),Object(n.jsx)("input",{type:"checkbox",id:"btnControlTopRight",className:"btnControl",checked:this.state.checkBoxClicked,onChange:this.changeChecked}),Object(n.jsx)("label",{htmlFor:"btnControlTopRight",children:Object(n.jsxs)("div",{className:"right-c",children:[Object(n.jsx)("div",{className:"d-only-when-small",children:Object(n.jsx)("i",{id:"user-info",className:"fas fa-user fa-2x user-icon","data-toggle":"tooltip",title:"Benutzer-Info"})}),Object(n.jsxs)("div",{className:"d-only-when-big top-2right",children:[Object(n.jsx)(u.b,{to:e+"/userInfo/"+this.global.userSelf.uid,children:Object(n.jsx)(K,{text:"Benutzer-Info",children:Object(n.jsx)("h4",{id:"username",className:"p-2 username",children:this.global.userSelf.username})})}),Object(n.jsxs)("div",{className:"float-right",children:[Object(n.jsx)(u.b,{to:e+"/settings",children:Object(n.jsx)(K,{text:"Einstellungen",children:Object(n.jsx)("i",{className:"fas fa-user-cog fa-2x"})})}),"\xa0",Object(n.jsx)(K,{text:"logout",children:Object(n.jsx)("i",{id:"user-logout",className:"fas fa-sign-out-alt fa-2x logout",onClick:this.logout})})]})]})]})})]})]})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.clickDocument,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.clickDocument,!1)}}]),s}(o.Component));function K(e){return Object(n.jsx)(q.a,{placement:"bottom",trigger:["hover"],overlay:Object(n.jsx)("span",{children:e.text}),children:e.children})}var Q=Object(h.j)($),X=(s(141),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).searchChanged=function(t){e.props.onSearch(t.target.value)},e}return Object(m.a)(s,[{key:"render",value:function(){var e=this.props.location.pathname;return Object(n.jsx)("div",{className:"chatSearchBox",children:Object(n.jsxs)("div",{className:"chat-select-form",children:[Object(n.jsx)("input",{type:"text",name:"chat-search",className:"chat-search",placeholder:"Chat suchen",onChange:this.searchChanged}),Object(n.jsx)(u.b,{to:e+"/newChat",children:Object(n.jsx)("button",{id:"btn-newChat",className:"btn-newChat",children:Object(n.jsx)("i",{className:"fas fa-plus fa-lg"})})})]})})}}]),s}(a.Component)),Z=Object(h.j)(X),ee=s(104),te=s.n(ee),se={names:{aqua:"#00ffff",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0"},random:function(){var e,t=0;for(var s in this.names)Math.random()<1/++t&&(e=s);return e}},ne=se,ae=s(112),re=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"getIndex",value:function(e){for(var t=0,s=this.length-1;t<=s;){var n=Math.floor((t+s)/2);if(this[n].key===e)return n;this[n].key<e?t=n+1:s=n-1}return-1}},{key:"getNearestKey",value:function(e){var t;for(++e;-1===(t=this.getIndex(--e));)if(0===e)return-1;return t}},{key:"get",value:function(e){var t=this.getIndex(e);if(-1!==t)return this[t].value}},{key:"add",value:function(e,t){-1===this.getIndex(e)&&this.splice(this.getNearestKey(e)+1,0,{key:e,value:t})}},{key:"remove",value:function(e){var t=this.getIndex(e);-1!==t&&this.splice(t,1)}}]),s}(Object(ae.a)(Array));function ce(e,t,s){return ie.apply(this,arguments)}function ie(){return(ie=Object(p.a)(d.a.mark((function e(t,s,n){var a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n||Object(o.getGlobal)().authTokens,r=Object(y.a)(Object(y.a)({},s),{},{method:s.method,headers:Object(y.a)(Object(y.a)({},s.headers),{},{Authorization:a})}),e.next=4,fetch(t,r);case 4:if(401!==(c=e.sent).status){e.next=8;break}throw Object(o.getDispatch)().deleteAuthTokens(),new Error("jwt expired");case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=0,ue=1,he=2,le=3,de=4,pe=5,je=6;function be(){return(be=Object(p.a)(d.a.mark((function e(t){var s,n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===Ge.users.getIndex(t)){e.next=10;break}if(0===Ge.users.get(t).normalChat){e.next=5;break}return e.abrupt("return",oe);case 5:return s=Ge.users.get(t),Ge.temporaryChat.createNew(t,s.username),e.abrupt("return",he);case 8:e.next=41;break;case 10:if(!Ge.temporaryChat.doesExist(t)){e.next=14;break}return e.abrupt("return",he);case 14:return e.prev=14,n={method:"GET",headers:{Accept:"application/json"}},e.next=18,ce("/user/"+t,n);case 18:if(!(a=e.sent).ok){e.next=35;break}return e.next=22,a.json();case 22:if(!(r=e.sent).userExists||r.blocked){e.next=28;break}return Ge.temporaryChat.createNew(t,r.username),e.abrupt("return",he);case 28:if(r.userExists){e.next=32;break}return e.abrupt("return",le);case 32:return e.abrupt("return",de);case 33:e.next=36;break;case 35:return e.abrupt("return",je);case 36:e.next=41;break;case 38:return e.prev=38,e.t0=e.catch(14),e.abrupt("return",je);case 41:case"end":return e.stop()}}),e,null,[[14,38]])})))).apply(this,arguments)}var me=function(){function e(t,s){Object(b.a)(this,e),this._normalChat=0,this._groupChats=new re,this.uid=t,this.username=s,this.color=ne.random()}return Object(m.a)(e,[{key:"addGroupChat",value:function(e){this.groupChats.add(e,e)}},{key:"removeGroupChat",value:function(e){this.groupChats.remove(e)}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"normalChat",get:function(){return this._normalChat},set:function(e){this._normalChat=e}},{key:"groupChats",get:function(){return this._groupChats},set:function(e){this._groupChats=e}}]),e}(),fe={};function ge(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(p.a)(d.a.mark((function e(){var t,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,fetch("/data.json",t);case 3:if(!(s=e.sent).ok){e.next=10;break}return e.next=7,s.json();case 7:fe=e.sent,e.next=11;break;case 10:throw new Error;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){var t=e.msg;return Object(n.jsxs)("div",{className:(t.bySelf?"self ":"other ")+"msg-container",children:[t.userTop?Object(n.jsx)("div",{className:"w-100",children:Object(n.jsx)("strong",{className:"header",children:Object(n.jsx)(Ce,{user:t.userTop})})}):null,Object(n.jsx)("div",{className:"content",children:Object(n.jsx)("p",{children:t.content.text})}),Object(n.jsx)("div",{className:"date-outer",children:Object(n.jsx)("div",{className:"date",children:t.mDateString})})]})}function xe(e){var t=e.msg;return Object(n.jsxs)("div",{className:(t.bySelf?"self ":"other ")+"msg-container",children:[Object(n.jsx)(ye,{msg:t}),Object(n.jsx)("div",{className:"date-outer",children:Object(n.jsx)("div",{className:"date",children:t.mDateString})})]})}function ye(e){var t=e.msg;return Object(n.jsx)(F,{children:Te(t,!0)})}s(170);function ke(e){var t=e.msg;switch(t.type){case fe.messageTypes.normalMessage:return Object(n.jsx)(ve,{msg:t});case fe.messageTypes.statusMessage:return Object(n.jsx)(xe,{msg:t});default:return Object(n.jsx)("span",{})}}function Ce(e){return Object(n.jsx)("span",{style:{color:ne.names[e.user.color]},children:e.user.username})}var we=0,Ne=1,Se=["den chat erstellt","hinzugef\xfcgt","entfernt","dem chat beigetreten","den chat verlassen","zum Admin gemacht","nicht mehr Admin"];function Te(e,t){return function(){var t=e.userTop,n=e.content.passiveUsers;switch(e.content.type){case fe.statusMessageTypes.chatCreated:return s(t,we,n,fe.statusMessageTypes.chatCreated);case fe.statusMessageTypes.usersAdded:return s(t,we,n,fe.statusMessageTypes.usersAdded);case fe.statusMessageTypes.usersRemoved:return s(t,we,n,fe.statusMessageTypes.usersRemoved);case fe.statusMessageTypes.usersJoined:return s(t,Ne,[],fe.statusMessageTypes.usersJoined);case fe.statusMessageTypes.usersLeft:return s(t,we,[],fe.statusMessageTypes.usersLeft);case fe.statusMessageTypes.usersMadeAdmin:return s(t,we,n,fe.statusMessageTypes.usersMadeAdmin);case fe.statusMessageTypes.usersRemovedAdmin:return s(t,Ne,[],fe.statusMessageTypes.usersRemovedAdmin)}}();function s(s,a,r,c){function i(){switch(a){case we:return e.bySelf?" hast ":" hat ";case Ne:return" ist"}}function o(){if(r.length<1)return"";if(1===r.length){var e=Ge.users.get(r[0]);return e?t?Object(n.jsx)(Ce,{user:e}):e.username:"1 Benutzer"}return r.length+" Benutzer"}function u(){return" "+Se[c]}return t?Object(n.jsxs)("span",{children:[Object(n.jsx)(Ce,{user:e.userTop}),i(),o(),u()]}):e.userTop.username+i()+o()+u()}}var Me=function(){function e(t,s,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date(Date.now()),r=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;Object(b.a)(this,e),this.mid=t,this.uid=s,this.date=a,this.chat=n,this.type=r,this.content=c}return Object(m.a)(e,[{key:"getMessageObject",value:function(e){var t={mDateString:this.getMessageViewDateString(),dateString:this.getDateString(),date:this.date,bySelf:this.uid===Ge.userSelf.uid,type:this.type,content:this.content};return e&&(t.userTop=this.getUserTop()),t}},{key:"getUserTop",value:function(){if(this.isBySelf())return{uid:this.uid,username:"Du",color:Ge.userSelf.color};var e=Ge.users.get(this.uid);return{uid:this.uid,username:e.username,color:e.color}}},{key:"isBySelf",value:function(){return this.uid===Ge.userSelf.uid}},{key:"getChatViewDateString",value:function(){return this.isDateToday()?"heute "+this.getTimeString():this.isDateYesterday()?"gestern":this.getDateString()}},{key:"getChatViewMsgString",value:function(){switch(this.type){case fe.messageTypes.normalMessage:var e=this.content.text;return e.length>18&&(e=e.substr(0,18)+"..."),this.uid===Ge.userSelf.uid?"Du: ".concat(e):"normalchat"===this.chat.type?this.content.text:"".concat(Ge.users.get(this.uid).username,": ").concat(e);case fe.messageTypes.statusMessage:return Te(this.getMessageObject(!0),!1)}}},{key:"getMessageViewDateString",value:function(){return this.isDateToday()?this.getTimeString():this.isDateYesterday()?"gestern "+this.getTimeString():this.getDateString()+" "+this.getTimeString()}},{key:"isDateToday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"isDateYesterday",value:function(){var e=new Date(Date.now());return this.date.getDate()===e.getDate()-1&&this.date.getMonth()===e.getMonth()&&this.date.getFullYear()===e.getFullYear()}},{key:"getDateString",value:function(){var e,t=this.date.getDate();e=t<10?"0"+t:t;var s,n=this.date.getMonth();s=n+1<10?"0"+(n+1):n+1;var a=this.date.getFullYear();return"".concat(e,".").concat(s,".").concat(a)}},{key:"getTimeString",value:function(){var e,t=this.date.getHours();e=t<10?"0"+t:t;var s,n=this.date.getMinutes();return s=n<10?"0"+n:n,"".concat(e,":").concat(s)}},{key:"isDifferentDay",value:function(e){return this.date.getDay()!==e.getDay()||this.date.getMonth()!==e.getMonth()||this.date.getFullYear()!==e.getFullYear()}},{key:"mid",get:function(){return this._mid},set:function(e){this._mid=e}},{key:"uid",get:function(){return this._uid},set:function(e){this._uid=e}},{key:"date",get:function(){return this._date},set:function(e){this._date=e}},{key:"chat",get:function(){return this._chat},set:function(e){this._chat=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"content",get:function(){return this._content},set:function(e){this._content=e}}]),e}(),Ue=function(){function e(){Object(b.a)(this,e),this.events=new Map}return Object(m.a)(e,[{key:"on",value:function(e,t){this.events.has(e)?this.events.get(e).push(t):this.events.set(e,[t])}},{key:"rm",value:function(e,t){if(this.events.has(e))for(var s=this.events.get(e),n=0;n<s.length;n++)s[n]===t&&s.splice(n,1)}},{key:"trigger",value:function(e){if(this.events.has(e)){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];for(var a=0;a<this.events.get(e).length;a++){var r;(r=this.events.get(e))[a].apply(r,s)}}}},{key:"events",get:function(){return this._events},set:function(e){this._events=e}}]),e}(),De=function(){function e(t,s,n){Object(b.a)(this,e),this._messages=new re,this._event=new Ue,this._unreadMessages=0,this._reachedTopMessages=!1,this.type=t,this.id=s,this.chatName=n}return Object(m.a)(e,[{key:"initFirstMessage",value:function(e){e.empty||this.messages.add(e.mid,new Me(e.mid,e.uid,this,new Date(e.date),e.type,e.content))}},{key:"loadMessages",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var s,n,a,r,c,i,o,u,h,l,p=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reachedTopMessages){e.next=17;break}return s=function(){var e=p.getLastMessage();return null!==e?e.mid:-1},n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatType:this.type,chatId:this.id,lastMsgId:s(),num:t})},e.next=5,ce("/message/load",n);case 5:if(!(a=e.sent).ok){e.next=16;break}return e.next=9,a.json();case 9:for(r=e.sent,this.reachedTopMessages="reached top"===r.status,c=r.messages,i=new Array(c.length),o=this.showUserInfoMessage(),u=c.length-1;u>=0;u--)h=c[u],l=new Me(h.mid,h.uid,this,new Date(h.date),h.type,h.content),this.messages.add(h.mid,l),i[u]=l.getMessageObject(o);return e.abrupt("return",i);case 16:throw new Error;case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLastMessage",value:function(){return 0!==this.messages.length?this.messages[0].value:null}},{key:"getFirstMessage",value:function(){return 0!==this.messages.length?this.messages[this.messages.length-1].value:null}},{key:"getMessages",value:function(){for(var e=this.showUserInfoMessage(),t=new Array(this.messages.length),s=0;s<this.messages.length;s++){var n=this.messages[s].value;t[s]=n.getMessageObject(e)}return t}},{key:"addMessage",value:function(e,t,s,n){var a=new Me(t,e,this,new Date(Date.now()),s,n);this.messages.add(t,a),Object(o.getDispatch)().newMsg(this,this.unreadMessages,a.getMessageObject(this.showUserInfoMessage()))}},{key:"showUserInfoMessage",value:function(){return"groupChat"===this.type}},{key:"getChatObject",value:function(){return{type:this.type,id:this.id,chatName:this.chatName,latestMessage:this.getLatestMessageObject(),unreadMessages:this.unreadMessages}}},{key:"getLatestMessageObject",value:function(){if(0===this.messages.length)return null;var e=this.getFirstMessage();return{msgString:e.getChatViewMsgString(),dateString:e.getChatViewDateString(),date:e.date}}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"chatName",get:function(){return this._chatName},set:function(e){this._chatName=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"unreadMessages",get:function(){return this._unreadMessages},set:function(e){this._unreadMessages=e}},{key:"reachedTopMessages",get:function(){return this._reachedTopMessages},set:function(e){this._reachedTopMessages=e}}]),e}(),Ee=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e,n,a){var r,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(b.a)(this,s),(r=t.call(this,"normalChat",e,n))._isTyping=!1,r.otherUser=a,r.unreadMessages=c,r}return Object(m.a)(s,[{key:"getUsersTyping",value:function(){if(this.isTyping){var e=Ge.users.get(this.otherUser);return[{uid:e.uid,username:e.username}]}return[]}},{key:"getLatestUserTyping",value:function(){if(this.isTyping){var e=Ge.users.get(this.otherUser);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!0,this.event.trigger("typeState changed"))}},{key:"stoppedTyping",value:function(e){e===this.otherUser&&(this.isTyping=!1,this.event.trigger("typeState changed"))}},{key:"otherUser",get:function(){return this._otherUser},set:function(e){this._otherUser=e}},{key:"isTyping",get:function(){return this._isTyping},set:function(e){this._isTyping=e}}]),s}(De),_e=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e,n,a){var r,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(b.a)(this,s),(r=t.call(this,"groupChat",e,n))._users=[],r._usersTyping=[],r.users=a,r.unreadMessages=c,r}return Object(m.a)(s,[{key:"getUsersTyping",value:function(){if(this.usersTyping.length>0){for(var e=[],t=0;t<this.usersTyping.length;t++){var s=Ge.users.get(this.usersTyping[t]);e.push({uid:s.uid,username:s.username})}return e}return[]}},{key:"getLatestUserTyping",value:function(){if(this.usersTyping.length>0){var e=Ge.users.get(this.usersTyping[this.usersTyping.length-1]);return{uid:e.uid,username:e.username}}return null}},{key:"startedTyping",value:function(e){this.isMember(e)&&(this.isTyping(e)||(this.usersTyping.push(e),this.event.trigger("typeState changed")))}},{key:"stoppedTyping",value:function(e){this.isMember(e)&&this.isTyping(e)&&(this.usersTyping.splice(this.getIndexOfTyping(e),1),this.event.trigger("typeState changed"))}},{key:"isMember",value:function(e){return e!==Ge.userSelf.uid&&this.users.find((function(t){return t===e}))}},{key:"isTyping",value:function(e){return this.usersTyping.find((function(t){return t===e}))}},{key:"getIndexOfTyping",value:function(e){return this.usersTyping.findIndex((function(t){return t===e}))}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"usersTyping",get:function(){return this._usersTyping},set:function(e){this._usersTyping=e}}]),s}(De),Ie=function(){function e(){Object(b.a)(this,e),this._isShown=!1}return Object(m.a)(e,[{key:"createNew",value:function(e,t){this.chatNow=new Ee(0,t,e)}},{key:"doesExist",value:function(e){return void 0!==this.chatNow&&this.chatNow.otherUser===e}},{key:"show",value:function(){this.isShown=!0,Object(o.getDispatch)().showTempChat(this.chatNow)}},{key:"update",value:function(){Object(o.getDispatch)().updateTempChat(this.chatNow)}},{key:"hide",value:function(){this.isShown=!1,Object(o.getDispatch)().hideTempChat()}},{key:"createNewNormalChat",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var s,n,a,r,c,i,u,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.chatNow.otherUser,n=this.chatNow.chatName,a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({uid:s,username:n,message:{type:fe.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}}})},e.next=5,ce("/user/chat",a);case 5:if(!(r=e.sent).ok){e.next=21;break}return e.next=9,r.json();case 9:return c=e.sent,-1===Ge.users.getIndex(s)&&Ge.users.add(s,new me(s,n)),i=Ge.users.get(s),u=new Ee(c.ncid,n,s),i.normalChat=u.id,Ge.chats.normal.add(c.ncid,u),h=new Me(c.mid,Ge.userSelf.uid,u,new Date(Date.now()),fe.messageTypes.normalMessage,{text:t,mentions:[],media:[]}),u.messages.add(h.mid,h),Object(o.getDispatch)().addChat(u),Object(o.getDispatch)().selectChat(u),this.hide(),e.abrupt("return",!0);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isShown",get:function(){return this._isShown},set:function(e){this._isShown=e}},{key:"chatNow",get:function(){return this._chatNow},set:function(e){this._chatNow=e}}]),e}(),Ae=function(){function e(){Object(b.a)(this,e),this._userSelf={uid:0,username:""},this._users=new re,this._chats={normal:new re,group:new re},this._event=new Ue,this._finishedLoading=!1,this._temporaryChat=new Ie,this._initCalled=!1}return Object(m.a)(e,[{key:"destruct",value:function(){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect()),this.initCalled=!1}},{key:"init",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,s,n,a=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(o.getGlobal)().userSelf,s=t.uid,n=t.username,this.userSelf=new me(s,n),this.userInfo={uid:s,username:n},this.initCalled=!0,this.userSelf=new me(s,n),this.userInfo={uid:s,username:n},this.socket=te.a.connect("/",{secure:!0}),this.socket.emit("auth",Object(o.getGlobal)().authTokens),this.socket.on("initialized",(function(){a.initChats()})),this.socket.on("chat message",(function(e){var t=a.getChat(e.chat.type,e.chat.id);if(null!==t){var s=a.isCurrentChat(t.type,t.id);t.addMessage(e.uid,e.mid,e.type,e.content),t.hasNewMsg=!s,t.unreadMessages++,a.event.trigger("new message",e.chat.type,e.chat.id)}})),this.socket.on("started typing",(function(e){a.getChat(e.chat.type,e.chat.id).startedTyping(e.uid)})),this.socket.on("stopped typing",(function(e){a.getChat(e.chat.type,e.chat.id).stoppedTyping(e.uid)})),this.socket.on("users-noChat",(function(e){Re.event.trigger("users-noChat",e)})),this.socket.on("new chat",(function(e){a.addNewChat(e)})),this.socket.on("disconnect",(function(){setTimeout((function(){alert("Verbindung verloren! Seite wird neu geladen"),location.reload()}),1e3)}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initChats",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,s,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{Accept:"application/json"}},e.next=3,ce("/chats",t);case 3:if(200!==(s=e.sent).status){e.next=9;break}return e.next=7,s.json();case 7:for(n=e.sent,a=0;a<n.length;a++)"normalChat"===n[a].type?this.addNewNormalChat(n[a]):"groupChat"===n[a].type&&this.addNewGroupChat(n[a]);case 9:this.finishedLoading=!0,this.event.trigger("chats loaded",this.getChatArraySortedByDate());case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChatArraySortedByDate",value:function(){function e(e){var t=e.latestMessage;return null!==t?t.date.getTime():new Date(0).getTime()}function t(t,s){for(var n=s,a=s+1;a<t.length;a++)e(t[n])<e(t[a])&&(n=a);return n}function s(e,t,s){var n=e[t];e[t]=e[s],e[s]=n}function n(e){for(var n=function(e){for(var t=new Array(e.length),s=0;s<e.length;s++){var n=e[s].value;t[s]=n.getChatObject()}return t}(e),a=0;a<n.length-1;a++){s(n,a,t(n,a))}return n}return function(t,s){for(var n=new Array(t.length+s.length),a=0,r=0,c=0;c<n.length;c++)r<s.length?a<t.length&&e(t[a])>e(s[r])?(n[c]=t[a],a++):(n[c]=s[r],r++):(n[c]=t[a],a++);return n}(n(this.chats.normal),n(this.chats.group))}},{key:"isCurrentChat",value:function(e,t){var s=Object(o.getGlobal)().currentChat;return s.type===e&&s.id===t}},{key:"getChat",value:function(e,t){return"normalChat"===e?this.chats.normal.get(t):"tempChat"===e?this.temporaryChat.chatNow:"groupChat"===e?this.chats.group.get(t):void 0}},{key:"addNewChat",value:function(e){var t;"normalChat"===e.type?t=this.addNewNormalChat(e):"groupChat"===e.type&&(t=this.addNewGroupChat(e)),t.unreadMessages=1,Object(o.getDispatch)().addChat(t)}},{key:"addNewNormalChat",value:function(e){var t;-1===this.users.getIndex(e.members[0].uid)?(t=new me(e.members[0].uid,e.members[0].username),this.users.add(t.uid,t)):t=this.users.get(e.members[0].uid);var s=new Ee(e.id,e.chatName,t.uid,e.unreadMessages);return t.normalChat=s.id,s.initFirstMessage(e.firstMessage),this.chats.normal.add(e.id,s),s}},{key:"addNewGroupChat",value:function(e){for(var t=[],s=0;s<e.members.length;s++){var n=e.members[s],a=void 0;-1===this.users.getIndex(n.uid)?(a=new me(n.uid,n.username),this.users.add(a.uid,a)):a=this.users.get(n.uid),t.push(a.uid),a.addGroupChat(e.id)}var r=new _e(e.id,e.chatName,t,e.unreadMessages);return r.initFirstMessage(e.firstMessage),this.chats.group.add(e.id,r),r}},{key:"socket",get:function(){return this._socket},set:function(e){this._socket=e}},{key:"userSelf",get:function(){return this._userSelf},set:function(e){this._userSelf=e}},{key:"users",get:function(){return this._users},set:function(e){this._users=e}},{key:"chats",get:function(){return this._chats},set:function(e){this._chats=e}},{key:"event",get:function(){return this._event},set:function(e){this._event=e}},{key:"finishedLoading",get:function(){return this._finishedLoading},set:function(e){this._finishedLoading=e}},{key:"temporaryChat",get:function(){return this._temporaryChat},set:function(e){this._temporaryChat=e}},{key:"initCalled",get:function(){return this._initCalled},set:function(e){this._initCalled=e}}]),e}(),Re=new Ae;var Ge=Re,Le=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).isSelected=function(){return n.props.id===n.global.currentChat.id&&n.props.type===n.global.currentChat.type},n.typeStateChanged=function(){var e="",t=Ge.getChat(n.props.type,n.props.id).getLatestUserTyping();null!==t&&(e=t.username+" schreibt..."),n.setState({typeMsg:e})},n.state={lastMsg:void 0,typeMsg:""},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this,t=function(){return e.props.latestMessage?Object(n.jsx)("span",{children:e.props.latestMessage.msgString}):Object(n.jsx)("span",{children:"Noch keine Nachrichten vorhanden"})},s=function(){return e.props.latestMessage?Object(n.jsx)("div",{className:"lastMsg-date",children:e.props.latestMessage.dateString}):null};return Object(n.jsx)("li",{className:this.isSelected()?"selected ":"",children:Object(n.jsxs)(u.b,{to:"normalChat"===e.props.type?"/chat/user/"+Ge.getChat("normalChat",e.props.id).otherUser:"groupChat"===e.props.type?"/chat/group/"+e.props.id:"tempChat"===e.props.type?"/chat/user/"+Ge.temporaryChat.chatNow.otherUser:void 0,children:[Object(n.jsxs)("div",{className:"w-100",children:[Object(n.jsx)("strong",{children:this.props.name}),0===e.props.unreadMessages?null:Object(n.jsx)("div",{className:"newMsg-number",children:e.props.unreadMessages})]}),""===e.state.typeMsg?Object(n.jsxs)("div",{className:"w-100 lastMsg",children:[t(),s()]}):Object(n.jsx)("div",{className:"w-100 typeMsg",children:e.state.typeMsg})]})})}},{key:"componentDidMount",value:function(){Ge.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,s){e.type===this.props.type&&e.id===this.props.id||(Ge.getChat(e.type,e.id).event.rm("typeState changed",this.typeStateChanged),Ge.getChat(this.props.type,this.props.id).event.on("typeState changed",this.typeStateChanged),this.setState({typeMsg:""}))}},{key:"componentWillUnmount",value:function(){Ge.getChat(this.props.type,this.props.id).event.rm("typeState changed",this.typeStateChanged)}}]),s}(o.Component),Be=(s(171),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).state={searchValue:""},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this,t=0;return Object(n.jsxs)(F,{children:[Object(n.jsx)(Z,{onSearch:function(t){e.setState({searchValue:t})}}),Object(n.jsxs)("ul",{className:"chat-list",children:[e.global.tempChat?Object(n.jsx)(Le,{id:0,type:"tempChat",name:e.global.tempChat.chatName,unreadMessages:0,latestMessage:null},-1):null,this.global.chats.map((function(s,a){return s.chatName.includes(e.state.searchValue)?(t++,Object(n.jsx)(Le,{id:s.id,type:s.type,name:s.chatName,unreadMessages:s.unreadMessages,latestMessage:s.latestMessage},a)):null}))]}),0===t?Object(n.jsx)("span",{children:"Nichts gefunden"}):null]})}}]),s}(o.Component));s(172);function Pe(e){return Object(n.jsx)("div",{className:"loader-init",children:Object(n.jsx)("div",{className:"col-sm-12 my-auto",children:Object(n.jsxs)("div",{className:"init-container border rounded",children:[Object(n.jsx)("div",{className:"spinner-border text-secondary",style:{width:"15rem",height:"15rem",borderWidth:"0.5rem"},role:"status",children:Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(n.jsx)("div",{className:"loader-text",children:e.msg})]})})})}var Fe=s(51),ze=(s(173),s(110)),He=(s(175),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e))._userTyping=!1,n._typeEventEmitted=!1,n.onTyping=function(e){n.setState({message:e.target.value}),n.handleTypeMessage()},n.handleTypeMessage=function(){n.isTempChat||(n.userTyping&&clearTimeout(n.typeTimeout),n.userTyping=!0,n.typeEventEmitted||(n.typeEventEmitted=!0,Ge.socket.emit("started typing")),n.typeTimeout=setTimeout((function(){n.userTyping=!1,n.typeEventEmitted&&(n.typeEventEmitted=!1,Ge.socket.emit("stopped typing"))}),1e3))},n.onSubmit=function(e){if(e.preventDefault(),""!==n.state.message){var t=n.state.message;if(n.setState({message:""}),n.isTempChat){var s=n.props.location.pathname;Ge.temporaryChat.createNewNormalChat(t).then((function(e){e&&(n.props.history.replace("/chat"),n.props.history.replace(s))}))}else n.sendMessage(t).then((function(e){Ge.getChat(n.props.chatType,n.props.chatId).addMessage(Ge.userSelf.uid,e,fe.messageTypes.normalMessage,{text:t,mentions:[],media:[]})})).catch((function(e){}))}},n.sendMessage=function(){var e=Object(p.a)(d.a.mark((function e(t){var s,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({type:fe.messageTypes.normalMessage,content:{text:t,mentions:[],media:[]}})},e.next=3,ce("/message",s);case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return a=e.sent,e.abrupt("return",a.mid);case 9:return e.abrupt("return",new Error);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onEmojiInput=function(e){n.setState({message:n.state.message+e.native}),n.handleTypeMessage()},n.toggleEmoji=function(e){n.setState((function(e){return{showEmoji:!e.showEmoji}}))},n.state={message:"",showEmoji:!1},n}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsxs)(F,{children:[Object(n.jsxs)("form",{onSubmit:this.onSubmit,className:"msg-form",children:[Object(n.jsxs)("div",{className:"message-input",children:[Object(n.jsx)("input",{autoComplete:"off",placeholder:"Nachricht:",value:this.state.message,onChange:this.onTyping}),Object(n.jsx)("i",{className:"far fa-smile fa-2x emoji-toggle",onClick:this.toggleEmoji})]}),Object(n.jsx)("button",{className:"btn-submit",type:"submit",children:Object(n.jsx)("i",{className:"far fa-paper-plane fa-2x","data-toggle":"tooltip",title:"send message"})})]}),this.state.showEmoji?Object(n.jsx)("div",{style:{position:"absolute",bottom:"60px",right:"50px",width:"350px",height:"425px"},children:Object(n.jsx)(ze.a,{onSelect:this.onEmojiInput})}):null]})}},{key:"componentDidMount",value:function(){this.isTempChat="tempChat"===this.props.chatType}},{key:"componentDidUpdate",value:function(e,t,s){this.isTempChat="tempChat"===this.props.chatType}},{key:"userTyping",get:function(){return this._userTyping},set:function(e){this._userTyping=e}},{key:"typeEventEmitted",get:function(){return this._typeEventEmitted},set:function(e){this._typeEventEmitted=e}},{key:"typeTimeout",get:function(){return this._typeTimeout},set:function(e){this._typeTimeout=e}},{key:"isTempChat",get:function(){return this._isTempChat},set:function(e){this._isTempChat=e}}]),s}(a.Component)),Ve=Object(h.j)(He),We=(s(176),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e))._isMounted=!1,n.scrollHandler=function(e){n.setState({scrollToBottom:n.getScrollToBottom()}),0===n.messagesNode.scrollTop&&n.loadMessages()},n.setScrollToBottom=function(e){n.messagesNode.scrollTop=n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-e},n.getScrollToBottom=function(){return n.messagesNode.scrollHeight-n.messagesNode.offsetHeight-n.messagesNode.scrollTop},n.assignMessagesRef=function(e){n.messages=e},n.loadMessages=function(){var e=Ge.getChat(n.global.currentChat.type,n.global.currentChat.id);e.reachedTopMessages||n.setState({msgLoading:!0}),e.loadMessages(10).then((function(e){n.dispatch.addLoadedMessages(e),n.setState((function(e){return{msgLoading:!1}})),n.setScrollToBottom(n.state.scrollToBottom)})).catch((function(e){return n.setState({msgLoading:!1})}))},n.chatChanged=function(){0===n.messagesNode.scrollTop&&n.loadMessages()},n.assignMessagesRef=n.assignMessagesRef.bind(Object(Fe.a)(n)),n.state={msgLoading:!1,scrollToBottom:0,messages:[],typeMessages:[]},n}return Object(m.a)(s,[{key:"componentDidMount",value:function(){this.messagesNode=i.a.findDOMNode(this.messages),this.chatChanged(),this.isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,s){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(this.setScrollToBottom(0),this.chatChanged()),0===this.state.scrollToBottom&&(this.setScrollToBottom(0),this.global.currentChat.newMessages>0&&this.setGlobal((function(e){return{currentChat:Object(y.a)(Object(y.a)({},e.currentChat),{},{newMessages:0})}})))}},{key:"render",value:function(){var e=this,t=new Date(0),s=function(e){return s=e.date,a=t,s.getDay()!==a.getDay()||s.getMonth()!==a.getMonth()||s.getFullYear()!==a.getFullYear()?(t=e.date,Object(n.jsx)("div",{className:"date-container",children:Object(n.jsx)("div",{children:e.dateString})})):(t=e.date,null);var s,a};return Object(n.jsxs)("div",{className:"chat-container",children:[Object(n.jsxs)("div",{className:"messages",onScroll:this.scrollHandler,ref:this.assignMessagesRef,children:[e.state.msgLoading?Object(n.jsx)("div",{className:"messageLoader-top",children:Object(n.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})})}):null,this.global.currentChat.messages.map((function(e,t){return Object(n.jsxs)("div",{children:[s(e),Object(n.jsx)(ke,{msg:e})]},t)})),0===e.global.currentChat.messages.length?Object(n.jsx)("div",{className:"alert alert-primary",role:"alert",children:"Noch keine Nachrichten vorhanden"}):null,e.isMounted&&e.getScrollToBottom()>10?Object(n.jsxs)("div",{id:"messages-bottom",className:"messages-bottom",onClick:function(){e.setState({scrollToBottom:0})},children:[Object(n.jsx)("div",{id:"btnToBottom",className:"chevron-down",children:Object(n.jsx)("i",{className:"fas fa-chevron-down fa-2x"})}),e.global.currentChat.newMessages>0?Object(n.jsx)("div",{id:"scroll-down-number",className:"number",children:e.global.currentChat.newMessages}):null]}):null]}),Object(n.jsx)(Ve,{chatType:this.props.chatType,chatId:this.props.chatId})]})}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"isMounted",get:function(){return this._isMounted},set:function(e){this._isMounted=e}},{key:"messages",get:function(){return this._messages},set:function(e){this._messages=e}},{key:"messagesNode",get:function(){return this._messagesNode},set:function(e){this._messagesNode=e}}]),s}(o.Component)),Je=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"chat-container",children:[Object(n.jsx)("div",{className:"messages",children:Object(n.jsx)("div",{className:"alert alert-primary",role:"alert",children:"Noch keine Nachrichten vorhanden"})}),Object(n.jsx)(Ve,{chatType:"tempChat",chatId:0})]})}},{key:"componentDidMount",value:function(){Ge.temporaryChat.show()}},{key:"componentDidUpdate",value:function(e,t,s){e.uid!==this.props.uid&&Ge.temporaryChat.update()}},{key:"componentWillUnmount",value:function(){Ge.temporaryChat.hide()}}]),s}(a.Component);function Ye(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"ung\xfcltige Addresse"})})}function qe(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Du kannst dir selbst nicht schreiben"})})}function $e(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Dieser User hat dich blockiert"})})}function Ke(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Dieser User existiert nicht"})})}function Qe(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Du bist nicht Mitglied in diesem chat jetzt beitreten"})})}function Xe(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Du bist nicht dazu berechtigt diesen chat anzusehen"})})}function Ze(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Dieser Chat existiert nicht"})})}function et(){return Object(n.jsx)("div",{children:Object(n.jsx)("h2",{children:"Fehler"})})}var tt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).userChanged=function(){var e=parseInt(n.props.uid);if(n.global.userSelf.uid===e)n.setState({error:pe,loaded:!0});else{var t=function(){(function(e){return be.apply(this,arguments)})(e).then((function(t){t===oe?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:H,ihcData:{name:Ge.users.get(e).username,uid:e}}).then(),n.selectNormalChat(e)):t===he?(n.setState({error:t}),n.setGlobal({infoHeaderCenter:H,ihcData:{name:Ge.temporaryChat.chatNow.chatName,uid:e}}).then(),n.selectTempChat()):n.setState({error:je}),n.setState({loaded:!0})})).catch((function(e){return n.setState({error:je})}))};Ge.finishedLoading?t():Ge.event.on("chats loaded",(function(){t()})),n.setState({uid:parseInt(n.props.uid)})}},n.state={uid:0,loaded:!1,error:oe},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"h-100",children:[function(){if(!e.state.loaded)return Object(n.jsx)(Pe,{msg:"Chat wird geladen"})}(),e.state.error===ue?Object(n.jsx)(Ye,{}):e.state.error===pe?Object(n.jsx)(qe,{}):e.state.loaded?e.state.error===oe?Object(n.jsx)(We,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id}):e.state.error===he?Object(n.jsx)(Je,{uid:e.state.uid}):e.state.error===de?Object(n.jsx)($e,{}):Object(n.jsx)(Ke,{}):void 0]})}},{key:"componentDidMount",value:function(){this.userChanged()}},{key:"componentDidUpdate",value:function(e,t,s){e.uid!==this.props.uid&&(isNaN(this.props.uid)?this.setState({error:ue}):this.userChanged())}},{key:"selectTempChat",value:function(){this.dispatch.showTempChat()}},{key:"selectNormalChat",value:function(e){if(-1===Ge.users.getIndex(e))this.setState({error:le});else{var t=Ge.users.get(e).normalChat,s=Ge.getChat("normalChat",t);this.dispatch.selectChat(s)}}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:z,ihcData:null}).then()}}]),s}(o.Component),st=(s(177),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"modal-outer",onClick:function(){e.props.history.goBack()},children:Object(n.jsx)("div",{className:"h-100",style:{display:"flex"},children:Object(n.jsxs)("div",{className:"modal-inner",onClick:function(e){e.stopPropagation()},children:[Object(n.jsx)("div",{className:"btn-close",onClick:function(){e.props.history.goBack()},children:"\xd7"}),this.props.children]})})})}}]),s}(a.Component)),nt=Object(h.j)(st);function at(e){return Object(n.jsx)("div",{className:"m-header",children:e.children})}function rt(e){return Object(n.jsx)("div",{className:"m-main",children:e.children})}var ct=s(111),it=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).clicked=function(t){e.props.isSelected?e.props.deselectUser(e.props.index):e.props.selectUser(e.props.index)},e}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsxs)("li",{onClick:this.clicked,children:[Object(n.jsx)("div",{className:"username",children:this.props.username}),Object(n.jsx)("div",{className:"user-select fa-lg"+(this.props.isSelected?" selected":""),children:Object(n.jsx)("i",{className:"fas fa-check"})})]},this.props.index)}}]),s}(a.Component),ot=s(54),ut=s.n(ot),ht=0,lt=1,dt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e.target.value,searchResult:[],hasMore:!0})},n.loadUsers=Object(p.a)(d.a.mark((function e(){var t,s,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,s=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===s){e.next=22;break}return n.lastRequest={searchValue:t,length:s},e.prev=4,e.next=7,n.props.loadUsers(t,s);case 7:if(!(a=e.sent).ok){e.next=16;break}return e.next=11,a.json();case 11:0===(r=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(r)}})),n.setState({error:ht}),e.next=17;break;case 16:n.setState({error:lt});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:lt});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.selectUser=function(e){var t=n.state.searchResult[e];n.props.selectUser(t.uid,t.username)},n.deselectUser=function(e){var t=n.state.searchResult[e];n.props.deselectUser(t.uid)},n.state={searchValue:"",searchResult:[],error:ht,hasMore:!0},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsxs)(F,{children:[Object(n.jsx)("form",{className:"form-group",style:{width:"90%",maxWidth:"650px"},children:Object(n.jsx)("input",{type:"text",className:"form-control p-2 m-2",placeholder:"Benutzer suchen",value:this.state.searchValue,onChange:this.searchChanged})}),Object(n.jsx)("div",{className:"selectUsers",ref:function(t){return e.scrollParentRef=t},children:Object(n.jsx)(ut.a,{pageStart:0,loadMore:this.loadUsers,hasMore:this.state.hasMore,loader:Object(n.jsx)("div",{className:"loader",children:Object(n.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})})},-1),useWindow:!1,getScrollParent:function(){return e.scrollParentRef},children:Object(n.jsxs)("ul",{className:"selectUsers",children:[this.state.searchResult.map((function(t,s){return Object(n.jsx)(it,{index:s,uid:t.uid,username:t.username,selectUser:e.selectUser,deselectUser:e.deselectUser,isSelected:e.props.isUserSelected(t.uid)},s)})),0===this.state.searchResult.length?Object(n.jsx)("div",{className:"nothingFound",children:"Nichts gefunden!"},-1):null]})})})]})}}]),s}(a.Component),pt=(s(179),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).selectUser=function(e,t){n.setState((function(s){return{selectedUsers:s.selectedUsers.concat({uid:e,username:t})}}))},n.deselectUser=function(e){n.setState((function(t){var s=Object(ct.a)(t.selectedUsers),n=s.findIndex((function(t){return t.uid===e}));return s.splice(n,1),{selectedUsers:s}}))},n.deselectIndex=function(e){n.deselectUser(n.state.selectedUsers[e].uid)},n.isUserSelected=function(e){return n.state.selectedUsers.find((function(t){return t.uid===e}))},n.btnNextClicked=function(e){n.props.onNext(n.state.selectedUsers)},n.state={selectedUsers:[],showOnlySelected:!1},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return 0===this.state.selectedUsers.length&&this.state.showOnlySelected&&this.setState({showOnlySelected:!1}),Object(n.jsxs)(F,{children:[Object(n.jsx)("div",{className:"select-users",children:0===e.state.selectedUsers.length?Object(n.jsx)("h4",{children:"Noch niemand ausgew\xe4hlt"}):Object(n.jsxs)("h4",{className:"w-100",children:[Object(n.jsxs)("span",{className:"selected-num"+(e.state.showOnlySelected?" selected":""),onClick:function(t){e.setState((function(e){return{showOnlySelected:!e.showOnlySelected}}))},children:[e.state.selectedUsers.length,"\xa0Benutzer"]}),"\xa0ausgew\xe4hlt",Object(n.jsx)("i",{className:"fas fa-arrow-right fa-lg float-right btn-next",onClick:e.btnNextClicked})]})}),this.state.showOnlySelected?Object(n.jsx)("div",{className:"selectUsers",children:Object(n.jsx)("ul",{className:"selectUsers only-selected",children:this.state.selectedUsers.map((function(t,s){return Object(n.jsx)(it,{index:s,uid:t.uid,username:t.username,selectUser:function(){},deselectUser:e.deselectIndex,isSelected:!0},s)}))})}):Object(n.jsx)(dt,{selectUser:this.selectUser,deselectUser:this.deselectUser,isUserSelected:this.isUserSelected,loadUsers:this.props.loadUsers})]})}}]),s}(a.Component));function jt(e){var t=Object(h.g)(),s=function(){var s=Object(p.a)(d.a.mark((function s(n){var a;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:n})},s.next=3,ce("/group/"+e.gcid+"/members",a);case 3:s.sent.ok&&t.goBack();case 5:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}(),a=function(){var t=Object(p.a)(d.a.mark((function t(s,n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:s,limit:10,start:n})},t.next=3,ce("/user/notInGroup/"+e.gcid,a);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}();return Object(n.jsxs)(F,{children:[Object(n.jsx)(at,{children:Object(n.jsx)("h2",{children:"Benutzer hinzuf\xfcgen"})}),Object(n.jsx)(rt,{children:Object(n.jsx)(pt,{onNext:s,loadUsers:a})})]})}var bt=s(42),mt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.removeMemberFromChat=Object(p.a)(d.a.mark((function t(){var s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"DELETE",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid,s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.makeMemberAdmin=Object(p.a)(d.a.mark((function t(){var s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"POST",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/giveAdmin",s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e.removeMemberAdmin=Object(p.a)(d.a.mark((function t(){var s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSelfAdmin()){t.next=5;break}return s={method:"POST",headers:{Accept:"application/json"}},t.next=4,ce("/group/"+e.props.gcid+"/member/"+e.props.member.uid+"/removeAdmin",s);case 4:t.sent;case 5:case"end":return t.stop()}}),t)}))),e}return Object(m.a)(s,[{key:"isMemberSelf",value:function(){return this.props.member.uid===this.global.userSelf.uid}},{key:"render",value:function(){var e=this.props.location.pathname;return Object(n.jsxs)("ul",{className:"userOptions",children:[Object(n.jsx)("li",{children:Object(n.jsxs)(u.b,{to:e+"/userInfo/"+this.props.member.uid,children:["zeige ",this.props.member.username," an"]})},0),Object(n.jsx)("li",{children:Object(n.jsxs)(u.b,{to:"/chat/user/"+this.props.member.uid,children:["Nachricht an ",this.props.member.username]})},1),this.isSelfAdmin()&&!this.isMemberSelf()?Object(n.jsxs)(F,{children:[Object(n.jsx)("li",{className:"noLink",onClick:this.removeMemberFromChat,children:"aus chat entfernen"},2),this.props.member.isAdmin?Object(n.jsx)("li",{className:"noLink",onClick:this.removeMemberAdmin,children:"admin status entfernen"},3):Object(n.jsx)("li",{className:"noLink",onClick:this.makeMemberAdmin,children:"zu admin machen"},4)]}):null]})}}]),s}(o.Component),ft=Object(h.j)(mt),gt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).isSelfAdmin=function(){return e.props.memberSelf.isAdmin},e.leaveChat=Object(p.a)(d.a.mark((function t(){var s,n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={method:"POST",headers:{Accept:"application/json"}},t.next=3,ce("/group/"+e.props.gcid+"/leave",s);case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:(a=t.sent).error&&console.log(a.error);case 9:case"end":return t.stop()}}),t)}))),e.removeSelfAdmin=Object(p.a)(d.a.mark((function t(){var s,n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={method:"POST",headers:{Accept:"application/json"}},t.next=3,ce("/group/"+e.props.gcid+"/removeAdmin",s);case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:(a=t.sent).error&&console.log(a.error);case 9:case"end":return t.stop()}}),t)}))),e}return Object(m.a)(s,[{key:"render",value:function(){var e=this.props.location.pathname;return Object(n.jsxs)("ul",{className:"chatOptions",children:[this.isSelfAdmin()?Object(n.jsxs)(F,{children:[Object(n.jsx)("li",{children:Object(n.jsx)(u.b,{to:e+"/addUsers",children:"Benutzer hinzuf\xfcgen"})},0),Object(n.jsx)("li",{className:"noLink",onClick:this.removeSelfAdmin,children:"admin status entfernen"},1)]}):null,Object(n.jsx)("li",{className:"noLink",onClick:this.leaveChat,children:"Chat verlassen"},2)]})}}]),s}(a.Component),Ot=Object(h.j)(gt),vt=s(105),xt=s.n(vt),yt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).handleEdit=function(){var e=Object(p.a)(d.a.mark((function e(t){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.target.value,n.setState({isEditing:!1,value:s}),e.next=4,n.props.onSubmit(s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.editPressed=function(){n.setState({isEditing:!0})},n.state={isEditing:!1,value:n.props.value},n}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:this.props.class,children:[Object(n.jsx)(xt.a,{name:this.props.name,value:this.state.value,isEditing:this.state.isEditing,changeCallback:this.handleEdit,optClass:"input"}),Object(n.jsx)("i",{className:"fas fa-edit edit",onClick:this.editPressed})]})}}]),s}(a.Component),kt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onSubmit=function(){var t=Object(p.a)(d.a.mark((function t(s){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({description:s})},t.next=3,ce("/group/"+e.props.gcid+"/description",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)(yt,{class:"description",name:"editDescription",value:this.props.description,onSubmit:this.onSubmit})}}]),s}(a.Component),Ct=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onSubmit=function(){var t=Object(p.a)(d.a.mark((function t(s){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({chatName:s})},t.next=3,ce("/group/"+e.props.gcid+"/chatName",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)(yt,{class:"chatName",name:"editChatName",value:this.props.chatName,onSubmit:this.onSubmit})}}]),s}(a.Component),wt=(s(204),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).state={error:!1,data:null},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;if(this.state.error)return Object(n.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Ein Fehler ist aufgetreten!"});var t=Ge.userSelf.uid;return Object(n.jsxs)("div",{className:"groupChatInfo",children:[this.props.data.memberSelf.isAdmin?Object(n.jsx)("h1",{children:Object(n.jsx)(Ct,{gcid:this.props.gcid,chatName:this.props.data.chatName})}):Object(n.jsx)("div",{className:"chatName",children:Object(n.jsx)("h1",{children:this.props.data.chatName})}),this.props.data.memberSelf.isAdmin?Object(n.jsx)(kt,{gcid:this.props.gcid,description:this.props.data.description}):Object(n.jsx)("div",{className:"description",children:this.props.data.description}),Object(n.jsx)(bt.a,{trigger:["click"],overlay:Object(n.jsx)(Ot,{gcid:this.props.gcid,memberSelf:this.props.data.memberSelf}),children:Object(n.jsx)("i",{className:"fas fa-ellipsis-v fa-lg chat-options-btn fa-2x",role:"button"})}),Object(n.jsxs)("h4",{children:[this.props.data.members.length,"\xa0Mitglieder:"]}),Object(n.jsx)("ul",{className:"userList",children:this.props.data.members.map((function(s,a){return Object(n.jsx)("li",{children:Object(n.jsxs)("div",{className:"userItem",children:[t===s.uid?Object(n.jsx)("span",{children:"Du"}):s.username,Object(n.jsxs)("div",{className:"right",children:[s.isAdmin?Object(n.jsx)("span",{className:"user-admin",children:"Admin\xa0\xa0"}):null,Object(n.jsx)(bt.a,{trigger:["click"],overlay:Object(n.jsx)(ft,{gcid:e.props.gcid,memberSelf:e.props.data.memberSelf,member:s}),animation:"slide-up",alignPoint:!0,children:Object(n.jsx)("i",{className:"fas fa-ellipsis-v fa-lg",role:"button"})})]})]})},a)}))})]})}}]),s}(a.Component)),Nt=Object(h.j)(wt);function St(e){var t=Object(h.i)().path,s=Object(n.jsx)(Nt,{gcid:e.gcid,data:e.data});return Object(n.jsxs)(F,{children:[Object(n.jsx)(P,{displayIn:["Mobile"],children:Object(n.jsxs)(h.d,{children:[Object(n.jsx)(h.b,{path:"".concat(t,"/addUsers"),children:Object(n.jsx)(jt,{gcid:e.gcid})}),Object(n.jsx)(h.b,{path:"*",children:s})]})}),Object(n.jsxs)(P,{displayIn:["Laptop","Tablet"],children:[Object(n.jsx)(h.d,{children:Object(n.jsx)(h.b,{path:"".concat(t,"/addUsers"),children:Object(n.jsx)(nt,{children:Object(n.jsx)(jt,{gcid:e.gcid})})})}),s]})]})}var Tt=0,Mt=1,Ut=2,Dt=3,Et=4,_t=5,It=0,At=1,Rt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).loadGroupChatInfo=function(){var e=Object(p.a)(d.a.mark((function e(t){var s,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={method:"GET",headers:{Accept:"application/json"}},e.next=4,ce("/group/"+n.props.gcid+"/",s);case 4:if(403!==(a=e.sent).status){e.next=9;break}return e.abrupt("return",Et);case 9:if(404!==a.status){e.next=13;break}return e.abrupt("return",Ut);case 13:if(!a.ok){e.next=30;break}return e.next=16,a.json();case 16:if(r=e.sent,n.setState({chatData:r}),!r.error){e.next=26;break}if("not part of chat"!==r.error){e.next=23;break}return e.abrupt("return",Dt);case 23:return e.abrupt("return",_t);case 24:e.next=28;break;case 26:if(-1===Ge.chats.group.getIndex(t)){e.next=28;break}return e.abrupt("return",Tt);case 28:e.next=31;break;case 30:return e.abrupt("return",_t);case 31:e.next=36;break;case 33:return e.prev=33,e.t0=e.catch(0),e.abrupt("return",_t);case 36:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t){return e.apply(this,arguments)}}(),n.chatChanged=function(){if(isNaN(n.props.gcid))n.setState({error:Mt,loaded:!0});else{var e=function(){var e=parseInt(n.props.gcid);n.loadGroupChatInfo(e).then((function(t){t===Tt?(n.selectGroupChat(e),n.setState({loaded:!0,error:Tt,gcid:e}),n.setGlobal({infoHeaderCenter:V,ihcData:{name:Ge.chats.group.get(e).chatName,gcid:e}}).then()):n.setState({loaded:!0,error:t})})).catch()};Ge.finishedLoading?e():Ge.event.on("chats loaded",(function(){e()}))}},n.state={gcid:0,loaded:!1,chatData:null,error:Tt},n}return Object(m.a)(s,[{key:"selectGroupChat",value:function(e){if(-1===Ge.chats.group.getIndex(e))this.setState({error:Ut});else{var t=Ge.chats.group.get(e);this.dispatch.selectChat(t)}}},{key:"componentDidMount",value:function(){this.chatChanged()}},{key:"componentDidUpdate",value:function(e,t,s){e.gcid!==this.props.gcid&&this.chatChanged()}},{key:"componentWillUnmount",value:function(){this.setGlobal({infoHeaderCenter:z,ihcData:null}).then()}},{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"h-100",children:[function(){if(!e.state.loaded)return Object(n.jsx)(Pe,{msg:"Chat wird geladen"})}(),function(){if(e.state.error===Mt)return Object(n.jsx)(Ye,{});if(e.state.loaded)switch(e.state.error){case Tt:switch(e.props.tab){case It:return Object(n.jsx)(We,{chatType:e.global.currentChat.type,chatId:e.global.currentChat.id});case At:return Object(n.jsx)(St,{gcid:e.state.gcid,data:e.state.chatData});default:return null}case Dt:return Object(n.jsx)(Qe,{});case Et:return Object(n.jsx)(Xe,{});case Ut:return Object(n.jsx)(Ze,{});case _t:return Object(n.jsx)(et,{});default:return null}}()]})}}]),s}(o.Component),Gt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){var e;Object(b.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).elementClicked=function(t){Ge.temporaryChat.createNew(e.props.uid,e.props.username)},e}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("li",{children:Object(n.jsx)(u.b,{to:"/chat/user/"+this.props.uid,onClick:this.elementClicked,replace:!0,children:this.props.username})})}}]),s}(a.Component),Lt=Object(h.j)(Gt),Bt=(s(205),0),Pt=1,Ft=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).lastRequest={},n.searchChanged=function(e){n.setState({searchValue:e,searchResult:[],hasMore:!0})},n.loadChats=Object(p.a)(d.a.mark((function e(){var t,s,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.searchValue,s=n.state.searchResult.length,n.lastRequest.searchValue===t&&n.lastRequest.length===s){e.next=22;break}return n.lastRequest={searchValue:t,length:s},e.prev=4,e.next=7,n.props.loadChats(t,s);case 7:if(!(a=e.sent).ok){e.next=16;break}return e.next=11,a.json();case 11:0===(r=e.sent).length?n.setState({hasMore:!1}):n.setState((function(e){return{searchResult:e.searchResult.concat(r)}})),n.setState({error:Bt}),e.next=17;break;case 16:n.setState({error:Pt});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),n.setState({error:Pt});case 22:case"end":return e.stop()}}),e,null,[[4,19]])}))),n.state={error:Bt,showOptions:!1,searchValue:"",searchResult:[],hasMore:!0},n}return Object(m.a)(s,[{key:"componentDidUpdate",value:function(e,t,s){this.props.showSearchBar||this.props.searchValue!==e.searchValue&&this.searchChanged(this.props.searchValue)}},{key:"render",value:function(){var e=this;return this.state.error===Pt?Object(n.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Ein Fehler ist aufgetreten!"},0):Object(n.jsxs)(F,{children:[this.props.showSearchBar?Object(n.jsx)("div",{className:"user-top",children:Object(n.jsx)("div",{className:"searchUser",children:Object(n.jsx)("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:function(t){e.searchChanged()}})})}):null,Object(n.jsx)("div",{className:"selectChat",ref:function(t){return e.scrollParentRef=t},children:Object(n.jsx)(ut.a,{pageStart:0,loadMore:this.loadChats,hasMore:this.state.hasMore,loader:Object(n.jsx)("div",{className:"loader",children:Object(n.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:Object(n.jsx)("span",{className:"sr-only",children:"Loading..."})})},-1),useWindow:!1,getScrollParent:function(){return e.scrollParentRef},children:Object(n.jsxs)("ul",{className:"selectChat",children:[this.state.searchResult.map((function(t,s){return Object(n.jsx)(Lt,{uid:t.uid,username:t.username,hide:e.props.hide},s)})),0===this.state.searchResult.length?Object(n.jsx)("div",{className:"nothingFound",children:"Nichts gefunden!"},-1):null]})})})]})}}]),s}(a.Component),zt=(s(206),s(207),0),Ht=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).newGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Kt.newGroup)},n.joinGroupClick=function(e){e.stopPropagation(),n.props.setCurrentTab(Kt.chooseGroup)},n.searchChanged=function(e){var t=e.target.value;n.setState({searchValue:t,searchValid:!0})},n.loadChats=function(){var e=Object(p.a)(d.a.mark((function e(t,s){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:t,limit:10,start:s})},e.next=3,ce("/user/noChat",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),n.state={error:zt,searchValue:""},n}return Object(m.a)(s,[{key:"render",value:function(){var e=Object(n.jsx)("div",{className:"options",children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:this.newGroupClick,children:"neue Gruppe"}),Object(n.jsx)("li",{onClick:this.joinGroupClick,children:"einer Gruppe beitreten"})]})});return Object(n.jsxs)(F,{children:[Object(n.jsxs)("div",{className:"user-top",children:[Object(n.jsx)("div",{className:"searchUser",children:Object(n.jsx)("input",{type:"text",name:"newChat-searchUser",className:"form-control",placeholder:"Benutzer suchen",onChange:this.searchChanged})}),Object(n.jsx)("div",{className:"user-more",children:Object(n.jsx)(bt.a,{trigger:["click"],overlay:e,animation:"slide-up",alignPoint:!0,children:Object(n.jsx)("i",{className:"fas fa-ellipsis-h fa-2x",role:"button"})})})]}),Object(n.jsx)(Ft,{showSearchBar:!1,searchValue:this.state.searchValue,loadChats:this.loadChats})]})}}]),s}(a.Component),Vt=(s(208),s.p+"static/media/placeholder.3c40b139.png"),Wt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).groupNameChanged=function(e){n.setState({groupName:e.target.value})},n.descriptionChanged=function(e){n.setState({description:e.target.value})},n.isPublicChanged=function(){n.setState((function(e){return{isPublic:!e.isPublic}}))},n.formSubmitted=function(e){e.preventDefault(),""!==n.state.groupName&&n.props.submitGroup({name:n.state.groupName,description:n.state.description,isPublic:n.state.isPublic})},n.state={groupName:"",description:"",isPublic:!1},n}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"groupInfoForm",children:Object(n.jsxs)("form",{onSubmit:this.formSubmitted,children:[Object(n.jsx)("img",{style:{display:"none"},id:"groupImgInput1",src:Vt,alt:"Placeholder"}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"exampleFormControlInput1",children:"Gruppenname"}),Object(n.jsx)("input",{type:"text",name:"groupName",className:"form-control",id:"input-groupName",placeholder:"Gruppenname",value:this.state.name,onChange:this.groupNameChanged,minLength:1})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"description1",children:"Beschreibung"}),Object(n.jsx)("textarea",{className:"form-control",id:"description1",rows:"3",value:this.state.description,onChange:this.descriptionChanged})]}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsxs)("label",{className:"check-container",children:["\xf6ffentlicher chat",Object(n.jsx)("input",{type:"checkbox",checked:this.state.isPublic,onChange:this.isPublicChanged}),Object(n.jsx)("span",{className:"checkmark",children:Object(n.jsx)("i",{className:"fas fa-check"})})]})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("button",{type:"submit",className:"float-right btn btn-primary m-3",children:"Gruppe erstellen"})})]})})}}]),s}(a.Component),Jt=0,Yt=1,qt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).showEnterChatInfo=function(e){n.setState({currentTab:Yt,selectedUsers:e})},n.submitGroup=function(e){for(var t=new Array(n.state.selectedUsers.length),s=0;s<n.state.selectedUsers.length;s++)t[s]={uid:n.state.selectedUsers[s].uid,username:n.state.selectedUsers[s].username,isAdmin:!1};n.createGroupChat(e,t).then((function(e){}))},n.createGroupChat=function(){var e=Object(p.a)(d.a.mark((function e(t,s){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:t,users:s})},e.next=4,ce("/group/",a);case 4:e.sent.ok&&n.props.history.goBack(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,s){return e.apply(this,arguments)}}(),n.loadUsers=function(){var e=Object(p.a)(d.a.mark((function e(t,s){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({search:t,limit:10,start:s})},e.next=3,ce("/user/",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),n.state={currentTab:Jt,selectedUsers:[]},n}return Object(m.a)(s,[{key:"render",value:function(){switch(this.state.currentTab){case Jt:return Object(n.jsx)(pt,{onNext:this.showEnterChatInfo,loadUsers:this.loadUsers});case Yt:return Object(n.jsx)(Wt,{submitGroup:this.submitGroup});default:return null}}}]),s}(a.Component),$t=Object(h.j)(qt),Kt=(s(209),{chooseUser:0,newGroup:1,chooseGroup:2}),Qt=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).setCurrentTab=function(e){n.setState({currentTab:e})},n.state={currentTab:Kt.chooseUser},n}return Object(m.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsxs)(F,{children:[Object(n.jsx)(at,{children:Object(n.jsx)("h1",{children:function(){switch(e.state.currentTab){case Kt.chooseUser:return"Neuer Chat";case Kt.newGroup:return"Neue Gruppe";case Kt.chooseGroup:return"Gruppe ausw\xe4hlen";default:return"Neuer Chat"}}()})}),Object(n.jsx)(rt,{children:Object(n.jsx)("div",{className:"newChat",children:function(){switch(e.state.currentTab){case Kt.chooseUser:return Object(n.jsx)(Ht,{setCurrentTab:e.setCurrentTab,hide:e.props.hide});case Kt.newGroup:return Object(n.jsx)($t,{});case Kt.chooseGroup:return Object(n.jsx)("div",{children:Object(n.jsx)("h4",{children:"chooseGroup"})});default:return Object(n.jsx)(Ht,{setCurrentTab:e.setCurrentTab,hide:e.props.hide})}}()})})]})}}]),s}(a.Component),Xt=0,Zt=1,es=2,ts=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).setUser=function(){if(isNaN(n.props.uid))n.setState({error:es});else if(Ge.userSelf.uid===parseInt(n.props.uid))n.setState({error:Zt,loaded:!0});else{var e=parseInt(n.props.uid);n.setState({uid:e,error:Xt,loaded:!1}),n.fetchUser(e).then().catch()}},n.state={uid:0,loaded:!1,error:Xt,userInfo:null},n}return Object(m.a)(s,[{key:"render",value:function(){return this.state.loaded?this.state.error===Zt?Object(n.jsxs)(F,{children:[Object(n.jsx)(at,{children:Object(n.jsx)("h1",{children:"Du"})}),Object(n.jsx)(rt,{children:"xx"})]}):Object(n.jsxs)(F,{children:[Object(n.jsx)(at,{children:Object(n.jsxs)("h1",{children:[this.state.userInfo.username,"\xa0",Object(n.jsx)(u.b,{to:"/chat/user/"+this.state.uid,children:Object(n.jsx)("i",{className:"far fa-comment-alt"})})]})}),Object(n.jsx)(rt,{children:Object(n.jsx)("h2",{children:"Gruppen"})})]}):null}},{key:"fetchUser",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var s,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={method:"GET",headers:{Accept:"application/json"}},e.next=3,ce("/user/"+t,s);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:return a=e.sent,this.setState({userInfo:a,loaded:!0}),e.abrupt("return",a);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.setUser()}},{key:"componentDidUpdate",value:function(e,t,s){e.uid!==this.props.uid&&this.setUser()}},{key:"componentWillUnmount",value:function(){}}]),s}(a.Component),ss=(s(210),function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsxs)(F,{children:[Object(n.jsx)(at,{children:Object(n.jsx)("h1",{children:"Einstellungen"})}),Object(n.jsx)(rt,{children:Object(n.jsxs)("div",{className:"settings",children:["to be implemented",Object(n.jsx)("div",{className:"about",children:Object(n.jsx)(u.b,{to:"/about",children:"\xfcber diese Seite"})})]})})]})}}]),s}(a.Component));function ns(e){var t=Object(h.i)().path;return Object(n.jsxs)(h.d,{children:[Object(n.jsxs)(h.b,{path:"".concat(t,"/newChat"),children:[e.children,Object(n.jsx)(nt,{children:Object(n.jsx)(Qt,{})})]}),Object(n.jsx)(h.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(t){return Object(n.jsxs)(F,{children:[e.children,Object(n.jsx)(nt,{children:Object(n.jsx)(ts,{uid:t.match.params.uidInfo})})]})}}),Object(n.jsxs)(h.b,{path:"".concat(t,"/settings"),children:[e.children,Object(n.jsx)(nt,{children:Object(n.jsx)(ss,{})})]}),Object(n.jsx)(h.b,{path:"*",children:e.children})]})}function as(e){var t=Object(h.i)().path;return Object(n.jsxs)("div",{className:"main-container",children:[Object(n.jsx)("div",{className:"mc-left",children:Object(n.jsx)(Be,{})}),Object(n.jsx)("div",{className:"mc-right",children:Object(n.jsxs)(h.d,{children:[Object(n.jsx)(h.b,{path:"".concat(t,"/user/:uid"),render:function(e){return Object(n.jsx)(ns,{children:Object(n.jsx)(tt,{uid:e.match.params.uid})})}}),Object(n.jsx)(h.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return Object(n.jsx)(ns,{children:Object(n.jsx)(Rt,{gcid:e.match.params.gcid,tab:It})})}}),Object(n.jsx)(h.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return Object(n.jsx)(ns,{children:Object(n.jsx)(Rt,{gcid:e.match.params.gcid,tab:At})})}}),Object(n.jsx)(h.b,{path:t,children:Object(n.jsx)(ns,{children:Object(n.jsx)("h1",{children:"noch kein chat ausgew\xe4hlt"})})})]})})]})}s(211);var rs=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).typeStateChanged=function(){var e=Ge.getChat(n.props.chatType,n.props.chatId);n.setState({usersTyping:e.getUsersTyping()})},n.state={usersTyping:[]},n}return Object(m.a)(s,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"typeMsg-container",children:this.state.usersTyping.map((function(e,t){return Object(n.jsx)("div",{className:"typeMsg",children:e.username+" schreibt..."},t)}))})}},{key:"componentDidMount",value:function(){Ge.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged)}},{key:"componentDidUpdate",value:function(e,t,s){e.chatType===this.props.chatType&&e.chatId===this.props.chatId||(Ge.getChat(e.chatType,e.chatId).event.rm("typeState changed",this.typeStateChanged),Ge.getChat(this.props.chatType,this.props.chatId).event.on("typeState changed",this.typeStateChanged))}},{key:"componentWillUnmount",value:function(){Ge.getChat(this.props.chatType,this.props.chatId).event.rm("typeState changed",this.typeStateChanged)}}]),s}(a.Component);function cs(e){var t=Object(h.i)().path;return Object(n.jsxs)(h.d,{children:[Object(n.jsx)(h.b,{path:"".concat(t,"/newChat"),children:Object(n.jsx)(Qt,{})}),Object(n.jsx)(h.b,{path:"".concat(t,"/userInfo/:uidInfo"),render:function(e){return Object(n.jsx)(ts,{uid:e.match.params.uidInfo})}}),Object(n.jsx)(h.b,{path:"".concat(t,"/settings"),children:Object(n.jsx)(ss,{})}),Object(n.jsx)(h.b,{path:"*",children:e.children})]})}function is(e){var t=Object(h.i)().path,s=Object(o.useGlobal)(),a=Object(T.a)(s,2),r=a[0],c=(a[1],function(){return""!==r.currentChat.type&&0!==r.currentChat.id?Object(n.jsx)(rs,{chatType:r.currentChat.type,chatId:r.currentChat.id}):null});return Object(n.jsx)("div",{className:"main-container",children:Object(n.jsxs)(h.d,{children:[Object(n.jsx)(h.b,{path:"".concat(t,"/user/:uid"),render:function(e){return Object(n.jsxs)(cs,{children:[Object(n.jsx)(tt,{uid:e.match.params.uid}),c()]})}}),Object(n.jsx)(h.b,{path:"".concat(t,"/group/:gcid"),render:function(e){return Object(n.jsxs)(cs,{children:[Object(n.jsx)(Rt,{gcid:e.match.params.gcid,tab:It}),c()]})}}),Object(n.jsx)(h.b,{path:"".concat(t,"/groupInfo/:gcid"),render:function(e){return Object(n.jsx)(cs,{children:Object(n.jsx)(Rt,{gcid:e.match.params.gcid,tab:At})})}}),Object(n.jsx)(h.b,{path:t,children:Object(n.jsx)(cs,{children:Object(n.jsx)("div",{className:"chat-list-outer-small",children:Object(n.jsx)(Be,{})})})}),Object(n.jsx)(h.b,{path:"*",children:Object(n.jsx)("h3",{children:"Not found!"})})]})})}s(212);var os=function(e){Object(f.a)(s,e);var t=Object(g.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this,e)).state={modal:0,modalInfo:null,notifications:0},n}return Object(m.a)(s,[{key:"componentDidMount",value:function(){Ge.initCalled||Ge.init().then((function(e){}))}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"h-100",children:[Object(n.jsx)(Q,{}),Object(n.jsx)(P,{displayIn:["Mobile"],children:Object(n.jsx)(is,{})}),Object(n.jsx)(P,{displayIn:["Laptop","Tablet"],children:Object(n.jsx)(as,{})})]})}}]),s}(a.Component);s(213);function us(){return Object(n.jsxs)("div",{className:"about",children:[Object(n.jsx)("h2",{children:"\xdcber diese Seite"}),Object(n.jsx)("h4",{children:"Erstellt von:"}),"Stefan Schlaghuber",Object(n.jsx)("br",{}),"2002 Gro\xdfmugl",Object(n.jsx)("br",{}),"stefan.schlaghuber@gmail.com",Object(n.jsx)("br",{})]})}s(214),s(215);function hs(){Object(o.addReducer)("deleteAuthTokens",(function(e,t){return localStorage.removeItem("authTokens"),location.reload(),t.deleteUserSelf(),t.resetGlobal(),Re.destruct(),Re=new Ae,{loaded:!0,authTokens:void 0}})),Object(o.addReducer)("initAuthTokens",function(){var e=Object(p.a)(d.a.mark((function e(t,s,n){var a,r,c,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ge();case 3:return a={method:"GET",headers:{Accept:"application/json"}},e.next=6,ce("/user/self",a,n);case 6:if(403!==(r=e.sent).status){e.next=12;break}return localStorage.removeItem("authTokens"),e.abrupt("return",{loaded:!0,authTokens:void 0});case 12:return e.next=14,r.json();case 14:return c=e.sent,i=c.uid,o=c.username,s.setUserSelf(i,o),e.abrupt("return",{loaded:!0,authTokens:n});case 18:e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{loaded:!1});case 24:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,s,n){return e.apply(this,arguments)}}()),Object(o.addReducer)("setAuthTokens",(function(e,t,s){return localStorage.setItem("authTokens",JSON.stringify(s)),{loaded:!0,authTokens:s}}))}function ls(){var e=Object(o.useDispatch)();return Object(o.useEffect)((function(){var t=JSON.parse(localStorage.getItem("authTokens"));e.initAuthTokens(t)}),[]),Object(n.jsx)(u.a,{children:Object(n.jsxs)(h.d,{children:[Object(n.jsx)(U,{path:"/chat",component:os}),Object(n.jsx)(h.b,{exact:!0,path:"/login",component:w}),Object(n.jsx)(h.b,{exact:!0,path:"/register",component:S}),Object(n.jsx)(h.b,{path:"/about",children:Object(n.jsx)(us,{})}),Object(n.jsx)(h.b,{exact:!0,path:"/",children:Object(n.jsx)(h.a,{to:"/chat"})}),Object(n.jsx)(h.b,{path:"*",children:Object(n.jsx)(ds,{})})]})})}function ds(){var e=Object(h.h)();return Object(n.jsx)("div",{children:Object(n.jsxs)("h3",{children:["No match for ",Object(n.jsx)("code",{children:e.pathname})]})})}Object(o.setGlobal)({loaded:!1,authTokens:void 0,userSelf:{},infoHeaderCenter:z,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}),function(){function e(e){Object(o.setGlobal)({chats:e})}Ge.finishedLoading?e(Ge.getChatArraySortedByDate()):Ge.event.on("chats loaded",e)}(),Object(o.addReducer)("setUserSelf",(function(e,t,s,n){return{userSelf:{uid:s,username:n}}})),Object(o.addReducer)("deleteUserSelf",(function(e,t){return{userSelf:{}}})),Object(o.addReducer)("resetGlobal",(function(e,t){return{infoHeaderCenter:z,ihcData:null,currentChat:{type:"",id:0,newMessages:0,messages:[]},tempChat:null,chats:[],newMessages:0}})),function(){var e=this;function t(e,t){return e.chats.findIndex((function(e){return e.id===t.id&&e.type===t.type}))}Object(o.addReducer)("newMsg",(function(e,s,n,a,r){var c=t(e,n);if(-1!==c){if(function(e,t){var s=e.currentChat;return s.type===t.type&&s.id===t.id}(e,n)){var i=e.chats.splice(0),o=i[c];return o.latestMessage=n.getLatestMessageObject(),o.unreadMessages=0,i.splice(c,1),i.unshift(o),{chats:i,currentChat:Object(y.a)(Object(y.a)({},e.currentChat),{},{messages:e.currentChat.messages.concat(r),newMessages:e.currentChat.newMessages+1})}}var u=e.chats.splice(0),h=u[c];h.latestMessage=n.getLatestMessageObject();var l=e.newMessages;return 0===h.unreadMessages&&l++,h.unreadMessages=a+1,u.splice(c,1),u.unshift(h),{chats:u,newMessages:l}}})),Object(o.addReducer)("selectChat",(function(e,s,n){var a=t(e,n);if(-1!==a){var r=e.chats.splice(0),c=r[a],i=e.newMessages;return c.unreadMessages>0&&i--,c.unreadMessages=0,r[a]=c,Ge.socket.emit("change chat",{type:n.type,id:n.id}),{currentChat:{type:n.type,id:n.id,messages:n.getMessages(),newMessages:0},chats:r,tempChat:null,newMessages:i}}})),Object(o.addReducer)("selectNoChat",(function(e,t){return Ge.socket.emit("change chat",null),{currentChat:{type:"",id:0,messages:[]}}})),Object(o.addReducer)("addLoadedMessages",(function(e,t,s){return{currentChat:Object(y.a)(Object(y.a)({},e.currentChat),{},{messages:s?s.concat(e.currentChat.messages):e.currentChat.messages})}})),Object(o.addReducer)("addChat",(function(e,t,s){var n,a,r=e.chats.splice(0),c=s.getChatObject();if(0===r.length)return{chats:[c]};for(var i=0;i<r.length;i++)if(a=c,!(n=r[i]).latestMessage||a.latestMessage&&n.latestMessage.date.getTime()<a.latestMessage.date.getTime()){r.splice(i,0,c);break}return{chats:r}})),Object(o.addReducer)("removeChat",(function(s,n,a){var r=t(s,a),c=e.state.chats.splice(0);return c.splice(r,1),{chats:c}})),Object(o.addReducer)("showTempChat",(function(e,t){var s=Ge.temporaryChat.chatNow;return Ge.socket.emit("change chat",null),{tempChat:s.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(o.addReducer)("updateTempChat",(function(e,t,s){return{tempChat:s.getChatObject(),currentChat:{type:"tempChat",id:0,messages:[]}}})),Object(o.addReducer)("hideTempChat",(function(e,t){return{tempChat:null}}))}(),hs();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(ls,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[216,1,2]]]);
//# sourceMappingURL=main.b9aee000.chunk.js.map